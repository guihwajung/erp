<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.0">
  <Form id="DRB_DLGTRANSFER" width="620" height="530" maxwidth="650" maxheight="590" titletext="명의변경" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="divData" taborder="0" left="0" top="0" right="0" cssclass="div_DATA_Bg" text="" height="490">
          <Layouts>
            <Layout>
              <Static id="staTITLE" taborder="0" left="0" top="13" width="97.42%" height="20" cssclass="sta_TITLE_Bg" textAlign="left" onclick="divData_staTITLE_onclick" text="전매"/>
              <Static id="staTY_CUSTOMER" taborder="22" text="기존고객검색" left="0" top="40" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staDT_TRANSFER" taborder="23" text="변경일자" left="0" top="69" width="127" height="30" textAlign="right" cssclass="sta_WF_tablelabelE"/>
              <Static id="staNO_JUMIN" taborder="30" text="주민등록번호" left="0" top="98" width="127" height="30" textAlign="right" cssclass="sta_WF_tablelabelE"/>
              <Static id="staNO_TEL" taborder="24" text="☎(자택)" left="0" top="127" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staDS_REMARK" taborder="25" text="특이사항" left="0" top="388" width="127" height="70" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg1" taborder="26" left="staTY_CUSTOMER:-1" top="40" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staBg2" taborder="27" left="staDT_TRANSFER:-1" top="69" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staBg3_00" taborder="31" left="staNO_JUMIN:-1" top="98" height="30" cssclass="sta_WF_tablebg" text="" width="175"/>
              <Static id="staBg5" taborder="28" left="staNO_TEL:-1" top="127" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staBg6" taborder="29" left="staDS_REMARK:-1" top="388" right="0%" height="70" cssclass="sta_WF_tablebg"/>
              <TextArea id="txtDS_REMARK" taborder="21" left="staDS_REMARK:5" top="393" height="60" value="" visible="true" enable="true" width="472" maxlength="250"/>
              <Radio id="rdoTY_CUSTOMER" taborder="1" left="staTY_CUSTOMER:5" top="46" height="20" innerdataset="dsTY_CUSTOMER" fittocontents="width" width="138" index="0" text="승인" value="APRV" codecolumn="CODE" datacolumn="VALUE" enable="true" direction="vertical"/>
              <Edit id="txtNO_JUMIN" taborder="5" height="22" value="" top="102" left="staNO_JUMIN:5" width="163" maxlength="20"/>
              <Static id="staTY_CONTRACTOR" taborder="32" text="계약구분" left="staBg2:-1" top="69" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00" taborder="33" left="staTY_CONTRACTOR:-1" top="69" right="0" height="30" cssclass="sta_WF_tablebg"/>
              <Static id="staCD_CUSTOMER" taborder="34" text="주민(사업자)번호" left="staBg1:-1" top="40" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_00" taborder="35" left="426" top="40" right="0" height="30" cssclass="sta_WF_tablebg"/>
              <Calendar id="calDT_TRANSFER" taborder="3" left="staDT_TRANSFER:5" top="73" width="108" height="22"/>
              <Radio id="rdoTY_CONTRACTOR" taborder="4" left="staTY_CONTRACTOR:5" top="74" height="20" innerdataset="dsTY_CONTRACTOR" fittocontents="width" width="178" index="0" text="승인" value="APRV" codecolumn="CODE" datacolumn="VALUE" enable="true" direction="vertical"/>
              <Static id="staDS_CONTRACTOR" taborder="36" text="계약자명" left="staBg3_00:-1" top="98" width="127" height="30" textAlign="right" cssclass="sta_WF_tablelabelE"/>
              <Static id="staBg2_00_01" taborder="37" left="staDS_CONTRACTOR:-1" top="98" right="0" height="30" cssclass="sta_WF_tablebg"/>
              <Edit id="txtDS_CONTRACTOR" taborder="6" height="22" value="" top="102" left="staDS_CONTRACTOR:4" right="16" maxlength="40"/>
              <Static id="staNO_OFFICETEL" taborder="38" text="☎(직장)" left="staBg5:-1" top="127" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_01_00" taborder="39" left="staNO_OFFICETEL:-1" top="127" right="0" height="30" cssclass="sta_WF_tablebg"/>
              <Edit id="txtNO_TEL" taborder="7" height="22" value="" top="131" left="staNO_TEL:5" width="163" maxlength="15"/>
              <Edit id="txtNO_OFFICETEL" taborder="8" height="22" value="" top="131" left="staNO_OFFICETEL:4" right="16" maxlength="15"/>
              <Static id="staNO_MOBILE" taborder="40" text="휴대폰" left="0" top="156" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg5_00" taborder="41" left="staNO_MOBILE:-1" top="156" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Edit id="txtNO_MOBILE" taborder="9" height="22" value="" top="160" left="staNO_MOBILE:5" width="163" maxlength="15"/>
              <Static id="staDS_EMAIL" taborder="42" text="e-Mail" left="staBg5_00:-1" top="156" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_01_00_00" taborder="43" left="staDS_EMAIL:-1" top="156" right="0" height="30" cssclass="sta_WF_tablebg"/>
              <Edit id="txtDS_EMAIL" taborder="10" height="22" value="" top="160" left="staDS_EMAIL:4" right="16"/>
              <Static id="staNO_POST" taborder="44" text="현주소" left="0" top="185" width="127" height="59" textAlign="right" cssclass="sta_WF_tablelabelE"/>
              <Static id="staBg5_00_00" taborder="45" left="staNO_POST:-1" top="185" height="30" cssclass="sta_WF_tablebg" right="0"/>
              <Static id="staBg5_00_00_00" taborder="46" left="staNO_POST:-1" top="214" height="30" cssclass="sta_WF_tablebg" right="0"/>
              <Static id="staNO_RECPOST" taborder="47" text="주민등록주소" left="0" top="243" width="127" height="59" textAlign="right" cssclass="sta_WF_tablelabelE"/>
              <Static id="staBg5_00_00_01" taborder="48" left="staNO_RECPOST:-1" top="243" height="30" cssclass="sta_WF_tablebg" right="0"/>
              <Static id="staBg5_00_00_00_00" taborder="49" left="staNO_RECPOST:-1" top="272" height="30" cssclass="sta_WF_tablebg" right="0"/>
              <Static id="staCD_VENDOR" taborder="50" text="사업자번호" left="0" top="301" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg5_00_01" taborder="51" left="staCD_VENDOR:-1" top="301" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staDS_VENDOR" taborder="52" text="상호" left="staBg5_00_01:-1" top="301" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_01_00_00_00" taborder="53" left="staDS_VENDOR:-1" top="301" right="0%" height="30" cssclass="sta_WF_tablebg"/>
              <Static id="staDS_UPTAE" taborder="54" text="업태" left="0" top="330" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg5_00_01_00" taborder="55" left="staDS_UPTAE:-1" top="330" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staDS_UPJONG" taborder="56" text="업종" left="staBg5_00_01_00:-1" top="330" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_01_00_00_00_00" taborder="57" left="staDS_UPJONG:-1" top="330" right="0%" height="30" cssclass="sta_WF_tablebg"/>
              <Static id="staTY_EBILL" taborder="58" text="세금계산서발급구분" left="0" top="359" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg5_00_01_00_00" taborder="59" left="staTY_EBILL:-1" top="359" height="30" cssclass="sta_WF_tablebg" width="175"/>
              <Static id="staYN_JOINT" taborder="60" text="공동명의계약자여부" left="staBg5_00_01_00_00:-1" top="359" width="127" height="30" cssclass="sta_WF_tablelabel" textAlign="right"/>
              <Static id="staBg2_00_01_00_00_00_00_00" taborder="61" left="staYN_JOINT:-1" top="359" right="0%" height="30" cssclass="sta_WF_tablebg"/>
              <Div id="ccfCD_CUSTOMER" taborder="2" CDTextWidth="125" left="staCD_CUSTOMER:3" top="44" width="150" height="22" url="cmm::cmmCodeFind.xfdl" CodeFindName="DRX_CFCUSTOMER"/>
              <Div id="ccfNO_POST" taborder="11" CDTextWidth="100" left="staNO_POST:5" top="189" width="472" height="22" url="cmm::cmmCodeFind.xfdl" CodeFindName="DZX_CFZIP_STREET"/>
              <Div id="ccfNO_RECPOST" taborder="13" CDTextWidth="100" left="staNO_RECPOST:5" top="247" width="472" height="22" url="cmm::cmmCodeFind.xfdl" CodeFindName="DZX_CFZIP_STREET"/>
              <Edit id="txtDS_ADDR" taborder="12" height="22" value="" top="218" left="staNO_POST:5" width="472" onkillfocus="divData_txtDS_ADDR_onkillfocus" maxlength="150"/>
              <Edit id="txtDS_RECADDR" taborder="14" height="22" value="" top="276" left="staNO_RECPOST:5" width="472" maxlength="150"/>
              <Edit id="txtCD_VENDOR" taborder="15" height="22" value="" top="305" left="staCD_VENDOR:5" width="163" maxlength="13"/>
              <Edit id="txtDS_VENDOR" taborder="16" height="22" value="" top="305" left="staDS_VENDOR:5" width="172" maxlength="15"/>
              <Edit id="txtDS_UPTAE" taborder="17" height="22" value="" top="334" left="staDS_UPTAE:5" width="163" maxlength="15"/>
              <Edit id="txtDS_UPJONG" taborder="18" height="22" value="" top="334" left="staDS_UPJONG:5" width="172" maxlength="15"/>
              <Radio id="rdoTY_EBILL" taborder="19" left="staTY_EBILL:5" top="365" height="20" innerdataset="dsTY_EBILL" fittocontents="width" width="138" index="0" text="승인" value="APRV" codecolumn="CODE" datacolumn="VALUE" enable="true" direction="vertical" readonly="true"/>
              <Radio id="rdoYN_JOINT" taborder="20" left="staYN_JOINT:5" top="365" height="20" innerdataset="dsYN_JOINT" fittocontents="width" width="138" index="0" text="승인" value="APRV" codecolumn="CODE" datacolumn="VALUE" enable="true" direction="vertical"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btnConf" taborder="1" text="확인" left="39.52%" top="480" width="60" height="30" cssclass="btnExt" onclick="btnConf_onclick"/>
        <Button id="btnCancel" taborder="2" text="취소" left="50.00%" top="480" width="60" height="30" cssclass="btnExt" onclick="btnCancel_onclick"/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.objApp = this.gfnGetApplication();

this.form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	// -- 필수 -------------------//
	this.gfnFormOnLoad(this);	
	this.gfnFormInfo(this);		
	// ---------------------------//
	
	this.fnSetButton();
	this.fnSetExtendButton();
	this.fnSetVariable();
	this.fnSetEvent();
	this.fnSetParameter();

	// 이전 화면에서 데이터 받기.
	this.dsData.setColumn(0, "CD_ACNTUNIT"	 , this.getOwnerFrame().CD_ACNTUNIT.substr(0, 6));
	this.dsData.setColumn(0, "TY_GUBUN"		 , this.getOwnerFrame().CD_ACNTUNIT.substr(6, 1));
	this.dsData.setColumn(0, "NO_CHASU"		 , this.getOwnerFrame().CD_ACNTUNIT.substr(7, 2));
	this.dsData.setColumn(0, "NO_DONG"		 , this.getOwnerFrame().DONG);
	this.dsData.setColumn(0, "NO_FLOOR"		 , this.getOwnerFrame().FLOOR) 
	this.dsData.setColumn(0, "NO_HO"		 , this.getOwnerFrame().HO);
	this.dsData.setColumn(0, "NO_UNIONMEMBER", this.getOwnerFrame().NO_UNIONMEMBER);
	
	this.dsData.setColumn(0, "TY_CUSTOMER"  , "P");					//기존고객검색(개인)
	this.dsData.setColumn(0, "TY_CONTRACTOR", "P");					//계약구분(개인)
	this.dsData.setColumn(0, "YN_EBILL"	  	, "N");					//세금계산서(종이)
	this.dsData.setColumn(0, "YN_JOINT"		, "N");					//공동명의계약자여부(없음)
	this.dsData.setColumn(0, "DT_TRANSFER"	, this.gfnGetDate()); 	//변경일자
	
	var titletxt = "";
	if(this.gfnIsNull(this.dsData.getColumn(0, "NO_UNIONMEMBER"))){
		titletxt  = this.FormInfo.NM_FORM  +"(";
		titletxt += this.dsData.getColumn(0, "NO_DONG")  +" 동 ";
		titletxt += this.dsData.getColumn(0, "NO_FLOOR") +" 층 ";
		titletxt += this.dsData.getColumn(0, "NO_HO")    +" 호)";
	}else{
		titletxt  = this.dsData.getColumn(0, "NO_UNIONMEMBER");
	}
	
	this.staTITLE.set_text(titletxt);
	
};

/************************************************************************
 * 버튼 설정 : 화면(Tab) 전환시 마다 호출
 * 서브버튼 사용 및 공통버튼 강제 제어시 여기서 처리
 ************************************************************************/
this.fnSetButton = function() {
	//this.FormBtns.Select.set_enable(false);
} 

/************************************************************************
 * 확장 버튼 : 화면별 버튼 설정 ID, function 연결 (화면버튼관리)
 ************************************************************************/
this.fnSetExtendButton = function() {

};

/************************************************************************
 * 변수 선언
 ************************************************************************/
this.fnSetVariable = function() {	
	this.staTITLE = this.divData.form.staTITLE;
	this.rdoTY_CUSTOMER 	= this.divData.form.rdoTY_CUSTOMER;
	this.ccfCD_CUSTOMER 	= this.divData.form.ccfCD_CUSTOMER;
	this.calDT_TRANSFER 	= this.divData.form.calDT_TRANSFER;
	this.rdoTY_CONTRACTOR 	= this.divData.form.rdoTY_CONTRACTOR;
	this.txtNO_JUMIN 		= this.divData.form.txtNO_JUMIN;
	this.txtDS_CONTRACTOR 	= this.divData.form.txtDS_CONTRACTOR;
	this.txtNO_TEL 			= this.divData.form.txtNO_TEL;
	this.txtNO_OFFICETEL 	= this.divData.form.txtNO_OFFICETEL;
	this.txtNO_MOBILE 		= this.divData.form.txtNO_MOBILE;
	this.txtDS_EMAIL 		= this.divData.form.txtDS_EMAIL;
	this.ccfNO_POST 		= this.divData.form.ccfNO_POST;
	this.txtDS_ADDR 		= this.divData.form.txtDS_ADDR;
	this.ccfNO_RECPOST 		= this.divData.form.ccfNO_RECPOST;
	this.txtDS_RECADDR 		= this.divData.form.txtDS_RECADDR;
	this.txtCD_VENDOR 		= this.divData.form.txtCD_VENDOR;
	this.txtDS_VENDOR 		= this.divData.form.txtDS_VENDOR;
	this.txtDS_UPTAE 		= this.divData.form.txtDS_UPTAE;
	this.txtDS_UPJONG 		= this.divData.form.txtDS_UPJONG;
	this.rdoTY_EBILL 		= this.divData.form.rdoTY_EBILL;
	this.rdoYN_JOINT 		= this.divData.form.rdoYN_JOINT;
	this.txtDS_REMARK 		= this.divData.form.txtDS_REMARK;
	
};

/************************************************************************
 * 이벤트 설정
 ************************************************************************/
this.fnSetEvent = function() {

	this.ccfCD_CUSTOMER.BeforeUserDataSetParam = "fnBeforeUserDataSetParam";
	this.ccfCD_CUSTOMER.AfterCDTextChanged = "fnAfterCDTextChanged";
};

/************************************************************************
 * 파라미터 설정
 ************************************************************************/
this.fnSetParameter = function() {
	this.dsInsert = new Dataset();
	this.dsInsert.addColumn("CD_ACNTUNIT", "string");
	this.dsInsert.addColumn("TY_GUBUN", "string");
	this.dsInsert.addColumn("NO_CHASU", "string");
	this.dsInsert.addColumn("NO_DONG", "string");
	this.dsInsert.addColumn("NO_FLOOR", "string");
	this.dsInsert.addColumn("NO_HO", "string");
	this.dsInsert.addColumn("NO_UNIONMEMBER", "string");
	this.dsInsert.addColumn("DT_TRANSFER", "string");
	this.dsInsert.addColumn("TY_CONTRACTOR", "string");
	this.dsInsert.addColumn("DS_CONTRACTOR", "string");
	this.dsInsert.addColumn("NO_JUMIN", "string");
	this.dsInsert.addColumn("NO_RECPOST", "string");
	this.dsInsert.addColumn("DS_RECADDR2", "string");
	this.dsInsert.addColumn("DS_RECADDR3", "string");
	this.dsInsert.addColumn("NO_POST", "string");
	this.dsInsert.addColumn("DS_ADDR2", "string");
	this.dsInsert.addColumn("DS_ADDR3", "string");
	this.dsInsert.addColumn("NO_TEL", "string");
	this.dsInsert.addColumn("NO_OFFICETEL", "string");
	this.dsInsert.addColumn("NO_MOBILE", "string");
	this.dsInsert.addColumn("DS_EMAIL", "string");
	this.dsInsert.addColumn("CD_VENDOR", "string");
	this.dsInsert.addColumn("DS_VENDOR", "string");
	this.dsInsert.addColumn("DS_UPJONG", "string");
	this.dsInsert.addColumn("DS_UPTAE", "string");
	this.dsInsert.addColumn("DS_REMARK", "string");
	this.dsInsert.addColumn("YN_EBILL", "string");
	this.dsInsert.addColumn("YN_JOINT", "string");
	this.dsInsert.addColumn("ID_INSERT", "string");
}

/************************************************************************
 * 컨트롤 이벤트
 ************************************************************************/
 
 /************************************************************************
 * 콤보 이벤트
 ************************************************************************/
 
 
/************************************************************************
 * Validate
 ************************************************************************/
this.fnSaveValidate = function() {
	var validate = true;
	
	if (this.gfnIsNull(this.dsData.getColumn(0, "DT_TRANSFER"))) {
		validate = false;
		this.fnVaidateCallback = function() {
			this.calDT_TRANSFER.setFocus();
		}
		this.gfnAlert("변경일자를 입력하지 않았습니다.", "fnVaidateCallback");
		return;
	}
	
	if (this.gfnIsNull(this.dsData.getColumn(0, "NO_JUMIN"))) {
		validate = false;
		this.fnVaidateCallback = function() {
			this.txtNO_JUMIN.setFocus();
		}
		this.gfnAlert("주민등록번호를 입력하지 않았습니다.", "fnVaidateCallback");
		return;
	}
	
	if (this.gfnIsNull(this.dsData.getColumn(0, "DS_CONTRACTOR"))) {
		validate = false;
		this.fnVaidateCallback = function() {
			this.txtDS_CONTRACTOR.setFocus();
		}
		this.gfnAlert("계약자성명을 입력하지 않았습니다.", "fnVaidateCallback");
		return;
	}
	
	if(this.dsData.getColumn(0, "TY_CONTRACTOR") == "P"){	//개인일경우
		if (nexacro.replaceAll(this.dsData.getColumn(0, "NO_JUMIN"),"-","").length != 13) {
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtNO_JUMIN.setFocus();
			}
			this.gfnAlert("주민등록번호는 13자리입니다.", "fnVaidateCallback");
			return;
//		} else {
// 			공통체크 gfnIsSSN 가 2000년대생 체크로직이 안들어가 있어서 무조건 fasle 가 들어옴	
// 			if(!this.gfnIsSSN(nexacro.replaceAll(this.dsData.getColumn(0, "NO_JUMIN"),"-",""))){
// 				validate = false;
// 				this.fnVaidateCallback = function() {
// 					this.txtNO_JUMIN.setFocus();
// 				}
// 				this.gfnAlert("잘못된 주민등록번호입니다.", "fnVaidateCallback");
// 				return;
// 			}
		}
	} else if(this.dsData.getColumn(0, "TY_CONTRACTOR") == "C"){	//법인일경우
		if (this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "CD_VENDOR")))) {
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtCD_VENDOR.setFocus();
			}
			this.gfnAlert("사업자등록번호를 입력하지 않았습니다.", "fnVaidateCallback");
			return;
		}
		if(!this.gfnIsBzIdNo(nexacro.replaceAll(this.dsData.getColumn(0, "CD_VENDOR"),"-",""))){
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtCD_VENDOR.setFocus();
			}
			this.gfnAlert("잘못된 사업자등록번호입니다.", "fnVaidateCallback");
			return;
		}
		
		if (this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "DS_VENDOR")))) {
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtDS_VENDOR.setFocus();
			}
			this.gfnAlert("상호를 입력하지 않았습니다.", "fnVaidateCallback");
			return;
		}
	}
	
	if (this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_TEL"))) &&
	    this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_OFFICETEL"))) &&
		this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_MOBILE")))) {
		validate = false;
		this.gfnAlert("전화번호를 입력하지 않았습니다.");
		return;
	}
	
	if (!this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_TEL")))) {
		if(!nexacro.isNumeric(nexacro.replaceAll(nexacro.replaceAll(this.dsData.getColumn(0, "NO_TEL"),"-",""),")",""))){
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtNO_TEL.setFocus();
			}
			this.gfnAlert("자택 전화번호가 정확하지 않습니다.", "fnVaidateCallback");
			return;
		}	
	}
	
	if (!this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_OFFICETEL")))) {
		if(!nexacro.isNumeric(nexacro.replaceAll(nexacro.replaceAll(this.dsData.getColumn(0, "NO_OFFICETEL"),"-",""),")",""))){
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtNO_OFFICETEL.setFocus();
			}
			this.gfnAlert("직장 전화번호가 정확하지 않습니다.", "fnVaidateCallback");
			return;
		}	
	}
	if (!this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_MOBILE")))) {
		if(!nexacro.isNumeric(nexacro.replaceAll(nexacro.replaceAll(this.dsData.getColumn(0, "NO_MOBILE"),"-",""),")",""))){
			validate = false;
			this.fnVaidateCallback = function() {
				this.txtNO_MOBILE.setFocus();
			}
			this.gfnAlert("휴대폰 번호가 정확하지 않습니다.", "fnVaidateCallback");
			return;
		}	
	}
	
	if (this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_POST")))) {
		validate = false;
		this.fnVaidateCallback = function() {
			this.ccfNO_POST.form.setFocus();
		}
		this.gfnAlert("현주소를 입력하지 않았습니다.", "fnVaidateCallback");	
		return;
	}
	if (this.gfnIsNull(this.gfnTrim(this.dsData.getColumn(0, "NO_RECPOST")))) {
		validate = false;
		this.fnVaidateCallback = function() {
			this.ccfNO_RECPOST.form.setFocus();
		}
		this.gfnAlert("주민등록주소를 입력하지 않았습니다.", "fnVaidateCallback");	
		return;
	}
	return validate;
}
/************************************************************************
 * 콜백 이벤트
 ************************************************************************/
/*
 *	콜백 처리
 */
this.fnCallback = function(svcID, errorCode, errorMsg)
{
	if (svcID == "save") {
		if(errorCode == 0){
			this.getParentContext().close(true);		
		}else{
			this.gfnAlert(errorMsg);
		}
	}
}

/************************************************************************
 * 코드파인드 이벤트
 ************************************************************************/
this.fnBeforeUserDataSetParam = function(id, dsUserParam, nrow) {
	if (id == "ccfCD_CUSTOMER") {
		dsUserParam.setColumn(nrow, "TY_CONT", this.dsData.getColumn(0, "TY_CUSTOMER"));
	}	
	return true;
};

this.fnAfterCDTextChanged = function(id, codeFindData) {
	var arr = codeFindData; 
	
	switch(id){
		case "ccfCD_CUSTOMER" : 
			this.dsData.setColumn(0, "NO_JUMIN"	   	, arr[0].NO_JUMIN);
			this.dsData.setColumn(0, "NO_TEL"	   	, arr[0].NO_TEL);
			this.dsData.setColumn(0, "NO_OFFICETEL"	, arr[0].NO_OFFICETEL);
			this.dsData.setColumn(0, "DS_CONTRACTOR", arr[0].DS_CUSTOMER);
			this.dsData.setColumn(0, "NO_MOBILE"   	, arr[0].NO_MOBILE);
			this.dsData.setColumn(0, "NO_POST"	  	, arr[0].NO_POST);
			this.dsData.setColumn(0, "DS_ADDR2"	   	, arr[0].DS_ADDR2);
			this.dsData.setColumn(0, "DS_ADDR3"	   	, arr[0].DS_ADDR3);
			this.dsData.setColumn(0, "NO_RECPOST"  	, arr[0].NO_RECPOST);
			this.dsData.setColumn(0, "DS_RECADDR2" 	, arr[0].DS_RECADDR2);
			this.dsData.setColumn(0, "DS_RECADDR3" 	, arr[0].DS_RECADDR3);
			this.dsData.setColumn(0, "DS_EMAIL"    	, arr[0].DS_EMAIL);
			this.dsData.setColumn(0, "DS_REMARK"   	, arr[0].DS_REMARK);
			
			if(this.dsData.getColumn(0, "TY_CUSTOMER") == "P"){	//개인
				this.dsData.setColumn(0, "TY_CONTRACTOR", "P");
				this.dsData.setColumn(0, "CD_VENDOR"	, "");
				this.dsData.setColumn(0, "DS_VENDOR"	, "");
				this.dsData.setColumn(0, "DS_UPTAE"		, "");
				this.dsData.setColumn(0, "DS_UPJONG"	, "");
			}else{	//법인
				this.dsData.setColumn(0, "TY_CONTRACTOR", "C");
				this.dsData.setColumn(0, "CD_VENDOR"	, arr[0].CD_VENDOR);
				this.dsData.setColumn(0, "DS_VENDOR"	, arr[0].DS_VENDOR1);
				this.dsData.setColumn(0, "DS_UPTAE"		, arr[0].DS_UPTAE);
				this.dsData.setColumn(0, "DS_UPJONG"	, arr[0].DS_UPJONG);
			}
			break;
	}
}
/************************************************************************
 * 그리드 이벤트
 ************************************************************************/
 
/************************************************************************
 * 기타 이벤트
 ************************************************************************/

this.dsData_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if(e.oldvalue != e.newvalue){
		if(e.columnid == "TY_CONTRACTOR"){
			obj.setColumn(e.row, "NO_JUMIN" 	 , "");
			obj.setColumn(e.row, "DS_CONTRACTOR" , "");
			obj.setColumn(e.row, "NO_TEL" 		 , "");
			obj.setColumn(e.row, "NO_OFFICETEL"  , "");
			obj.setColumn(e.row, "NO_MOBILE" 	 , "");
			obj.setColumn(e.row, "DS_EMAIL" 	 , "");
			obj.setColumn(e.row, "NO_POST" 	  	 , "");
			obj.setColumn(e.row, "DS_ADDR2" 	 , "");
			obj.setColumn(e.row, "DS_ADDR3" 	 , "");
			obj.setColumn(e.row, "NO_RECPOST" 	 , "");
			obj.setColumn(e.row, "DS_RECADDR2"   , "");
			obj.setColumn(e.row, "DS_RECADDR3"   , "");
			obj.setColumn(e.row, "DS_REMARK"     , "");
			
			if(e.newvalue == "P"){	//개인
				this.txtCD_VENDOR.set_readonly(true);
				this.txtDS_VENDOR.set_readonly(true);
				this.txtDS_UPJONG.set_readonly(true);
				this.txtDS_UPTAE.set_readonly(true);
				
				obj.setColumn(e.row, "CD_VENDOR"	 , "");
				obj.setColumn(e.row, "DS_VENDOR"	 , "");
				obj.setColumn(e.row, "DS_UPJONG"	 , "");
				obj.setColumn(e.row, "DS_UPTAE"      , "");
			} else if (e.newvalue == "C"){	//법인
				this.txtCD_VENDOR.set_readonly(false);
				this.txtDS_VENDOR.set_readonly(false);
				this.txtDS_UPJONG.set_readonly(false);
				this.txtDS_UPTAE.set_readonly(false);
			} else {	//개인사업자
				this.txtCD_VENDOR.set_readonly(false);
				this.txtDS_VENDOR.set_readonly(false);
				this.txtDS_UPJONG.set_readonly(false);
				this.txtDS_UPTAE.set_readonly(false);
				
				obj.setColumn(e.row, "NO_JUMIN" 	 , this.getOwnerFrame().NO_JUMIN);
				obj.setColumn(e.row, "DS_CONTRACTOR" , this.getOwnerFrame().DS_CONTRACTOR);
				obj.setColumn(e.row, "NO_TEL" 		 , this.getOwnerFrame().NO_TEL);
				obj.setColumn(e.row, "NO_OFFICETEL"  , this.getOwnerFrame().NO_OFFICETEL);
				obj.setColumn(e.row, "NO_MOBILE" 	 , this.getOwnerFrame().NO_MOBILE);
				obj.setColumn(e.row, "DS_EMAIL" 	 , this.getOwnerFrame().DS_EMAIL);
				obj.setColumn(e.row, "NO_POST" 	  	 , this.getOwnerFrame().NO_POST);
				obj.setColumn(e.row, "DS_ADDR2" 	 , this.getOwnerFrame().DS_ADDR1);
				obj.setColumn(e.row, "DS_ADDR3" 	 , this.getOwnerFrame().DS_ADDR2);
				obj.setColumn(e.row, "NO_RECPOST" 	 , this.getOwnerFrame().NO_RECPOST);
				obj.setColumn(e.row, "DS_RECADDR2"   , this.getOwnerFrame().DS_RECADDR1);
				obj.setColumn(e.row, "DS_RECADDR3"   , this.getOwnerFrame().DS_RECADDR2);
			}
		}
	}
};

//확인버튼
this.btnConf_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(!this.fnSaveValidate()) return;

	this.dsInsert.clearData();
	var nrow = this.dsInsert.addRow();
	
	this.dsInsert.setColumn(nrow, "CD_ACNTUNIT"		, this.dsData.getColumn(0, "CD_ACNTUNIT"));
	this.dsInsert.setColumn(nrow, "TY_GUBUN"		, this.dsData.getColumn(0, "TY_GUBUN"));
	this.dsInsert.setColumn(nrow, "NO_CHASU"		, this.dsData.getColumn(0, "NO_CHASU"));
	this.dsInsert.setColumn(nrow, "NO_DONG"			, this.dsData.getColumn(0, "NO_DONG"));
	this.dsInsert.setColumn(nrow, "NO_FLOOR"		, this.dsData.getColumn(0, "NO_FLOOR"));
	this.dsInsert.setColumn(nrow, "NO_HO"			, this.dsData.getColumn(0, "NO_HO"));
	this.dsInsert.setColumn(nrow, "NO_UNIONMEMBER"  , this.dsData.getColumn(0, "NO_UNIONMEMBER"));
	this.dsInsert.setColumn(nrow, "DT_TRANSFER"  	, this.dsData.getColumn(0, "DT_TRANSFER"));
	this.dsInsert.setColumn(nrow, "TY_CONTRACTOR"   , this.dsData.getColumn(0, "TY_CONTRACTOR"));
	this.dsInsert.setColumn(nrow, "DS_CONTRACTOR"   , this.dsData.getColumn(0, "DS_CONTRACTOR"));
	this.dsInsert.setColumn(nrow, "NO_JUMIN"  		, nexacro.replaceAll(this.dsData.getColumn(0, "NO_JUMIN"),"-",""));
	this.dsInsert.setColumn(nrow, "NO_RECPOST"  	, nexacro.replaceAll(this.dsData.getColumn(0, "NO_RECPOST"),"-",""));
	this.dsInsert.setColumn(nrow, "DS_RECADDR2"  	, this.dsData.getColumn(0, "DS_RECADDR2"));
	this.dsInsert.setColumn(nrow, "DS_RECADDR3"  	, this.dsData.getColumn(0, "DS_RECADDR3"));
	this.dsInsert.setColumn(nrow, "NO_POST"  		, nexacro.replaceAll(this.dsData.getColumn(0, "NO_POST"),"-",""));
	this.dsInsert.setColumn(nrow, "DS_ADDR2"  		, this.dsData.getColumn(0, "DS_ADDR2"));
	this.dsInsert.setColumn(nrow, "DS_ADDR3"  		, this.dsData.getColumn(0, "DS_ADDR3"));
	this.dsInsert.setColumn(nrow, "NO_TEL"  		, this.dsData.getColumn(0, "NO_TEL"));
	this.dsInsert.setColumn(nrow, "NO_OFFICETEL"  	, this.dsData.getColumn(0, "NO_OFFICETEL"));
	this.dsInsert.setColumn(nrow, "NO_MOBILE"  		, this.dsData.getColumn(0, "NO_MOBILE"));
	this.dsInsert.setColumn(nrow, "DS_EMAIL"  		, this.dsData.getColumn(0, "DS_EMAIL"));
	this.dsInsert.setColumn(nrow, "CD_VENDOR"  		, nexacro.replaceAll(this.dsData.getColumn(0, "CD_VENDOR"),"-",""));
	this.dsInsert.setColumn(nrow, "DS_VENDOR"  		, this.dsData.getColumn(0, "DS_VENDOR"));
	this.dsInsert.setColumn(nrow, "DS_UPJONG"		, this.dsData.getColumn(0, "DS_UPJONG"));
	this.dsInsert.setColumn(nrow, "DS_UPTAE"  		, this.dsData.getColumn(0, "DS_UPTAE"));
	this.dsInsert.setColumn(nrow, "DS_REMARK"  		, this.dsData.getColumn(0, "DS_REMARK"));
	this.dsInsert.setColumn(nrow, "YN_EBILL"  		, this.dsData.getColumn(0, "YN_EBILL"));
	this.dsInsert.setColumn(nrow, "YN_JOINT"  		, this.dsData.getColumn(0, "YN_JOINT"));
	this.dsInsert.setColumn(nrow, "ID_INSERT"		, this.AuthClient.ID_USER);
				
	var strSvcId    = "save";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = "insert=dsInsert";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]	
};

//취소버튼
this.btnCancel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.getParentContext().close(false);
};

this.divData_txtDS_ADDR_onkillfocus = function(obj:nexacro.Edit,e:nexacro.KillFocusEventInfo)
{
	this.dsData.setColumn(0, "NO_RECPOST" 	 , this.dsData.getColumn(0, "NO_POST"));
	this.dsData.setColumn(0, "DS_RECADDR2"   , this.dsData.getColumn(0, "DS_ADDR2"));
	this.dsData.setColumn(0, "DS_RECADDR3"   , this.dsData.getColumn(0, "DS_ADDR3"));
};
]]></Script>
    <Objects>
      <Dataset id="_dsProc">
        <ColumnInfo>
          <Column id="TARGET" type="STRING" size="256"/>
          <Column id="SP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TARGET">insert</Col>
            <Col id="SP">DRBPR_NOMINALTRANSFER_INSERT</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsData" onvaluechanged="dsData_onvaluechanged" oncolumnchanged="dsData_oncolumnchanged">
        <ColumnInfo>
          <Column id="CD_ACNTUNIT" type="STRING" size="256"/>
          <Column id="TY_GUBUN" type="STRING" size="256"/>
          <Column id="NO_CHASU" type="STRING" size="256"/>
          <Column id="NO_DONG" type="STRING" size="256"/>
          <Column id="NO_FLOOR" type="STRING" size="256"/>
          <Column id="NO_HO" type="STRING" size="256"/>
          <Column id="NO_UNIONMEMBER" type="STRING" size="256"/>
          <Column id="DT_TRANSFER" type="STRING" size="256"/>
          <Column id="TY_CONTRACTOR" type="STRING" size="256"/>
          <Column id="DS_CONTRACTOR" type="STRING" size="256"/>
          <Column id="NO_JUMIN" type="STRING" size="256"/>
          <Column id="NO_TEL" type="STRING" size="256"/>
          <Column id="NO_OFFICETEL" type="STRING" size="256"/>
          <Column id="NO_MOBILE" type="STRING" size="256"/>
          <Column id="DS_EMAIL" type="STRING" size="256"/>
          <Column id="NO_POST" type="STRING" size="256"/>
          <Column id="DS_ADDR2" type="STRING" size="256"/>
          <Column id="DS_ADDR3" type="STRING" size="256"/>
          <Column id="NO_RECPOST" type="STRING" size="256"/>
          <Column id="DS_RECADDR2" type="STRING" size="256"/>
          <Column id="DS_RECADDR3" type="STRING" size="256"/>
          <Column id="CD_VENDOR" type="STRING" size="256"/>
          <Column id="DS_VENDOR" type="STRING" size="256"/>
          <Column id="DS_UPTAE" type="STRING" size="256"/>
          <Column id="DS_UPJONG" type="STRING" size="256"/>
          <Column id="YN_EBILL" type="STRING" size="256"/>
          <Column id="YN_JOINT" type="STRING" size="256"/>
          <Column id="DS_REMARK" type="STRING" size="256"/>
          <Column id="TY_CUSTOMER" type="STRING" size="256"/>
          <Column id="CD_CUSTOMER" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="dsTY_CUSTOMER">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">P</Col>
            <Col id="VALUE">개인</Col>
          </Row>
          <Row>
            <Col id="CODE">C</Col>
            <Col id="VALUE">법인</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTY_CONTRACTOR">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="VALUE">개인</Col>
            <Col id="CODE">P</Col>
          </Row>
          <Row>
            <Col id="VALUE">법인</Col>
            <Col id="CODE">C</Col>
          </Row>
          <Row>
            <Col id="VALUE">개인사업자</Col>
            <Col id="CODE">A</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTY_EBILL">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="VALUE">전자</Col>
            <Col id="CODE">Y</Col>
          </Row>
          <Row>
            <Col id="VALUE">종이</Col>
            <Col id="CODE">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsYN_JOINT">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="VALUE">있음</Col>
            <Col id="CODE">Y</Col>
          </Row>
          <Row>
            <Col id="VALUE">없음</Col>
            <Col id="CODE">N</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item6" compid="divData.form.rdoTY_CUSTOMER" propid="value" datasetid="dsData" columnid="TY_CUSTOMER"/>
      <BindItem id="item2" compid="divData.form.txtDS_REMARK" propid="value" datasetid="dsData" columnid="DS_REMARK"/>
      <BindItem id="item3" compid="divData.form.txtNO_JUMIN" propid="value" datasetid="dsData" columnid="NO_JUMIN"/>
      <BindItem id="item0" compid="divData.form.rdoTY_CONTRACTOR" propid="value" datasetid="dsData" columnid="TY_CONTRACTOR"/>
      <BindItem id="item1" compid="divData.form.txtDS_CONTRACTOR" propid="value" datasetid="dsData" columnid="DS_CONTRACTOR"/>
      <BindItem id="item4" compid="divData.form.txtNO_TEL" propid="value" datasetid="dsData" columnid="NO_TEL"/>
      <BindItem id="item5" compid="divData.form.txtNO_OFFICETEL" propid="value" datasetid="dsData" columnid="NO_OFFICETEL"/>
      <BindItem id="item7" compid="divData.form.txtNO_MOBILE" propid="value" datasetid="dsData" columnid="NO_MOBILE"/>
      <BindItem id="item8" compid="divData.form.txtDS_EMAIL" propid="value" datasetid="dsData" columnid="DS_EMAIL"/>
      <BindItem id="item9" compid="divData.form.ccfCD_CUSTOMER.form.CDTextBox" propid="value" datasetid="dsData" columnid="CD_CUSTOMER"/>
      <BindItem id="item11" compid="divData.form.ccfNO_POST.form.CDTextBox" propid="value" datasetid="dsData" columnid="NO_POST"/>
      <BindItem id="item12" compid="divData.form.ccfNO_POST.form.DSTextBox" propid="value" datasetid="dsData" columnid="DS_ADDR2"/>
      <BindItem id="item13" compid="divData.form.ccfNO_RECPOST.form.CDTextBox" propid="value" datasetid="dsData" columnid="NO_RECPOST"/>
      <BindItem id="item14" compid="divData.form.ccfNO_RECPOST.form.DSTextBox" propid="value" datasetid="dsData" columnid="DS_RECADDR2"/>
      <BindItem id="item15" compid="divData.form.txtDS_ADDR" propid="value" datasetid="dsData" columnid="DS_ADDR3"/>
      <BindItem id="item16" compid="divData.form.txtDS_RECADDR" propid="value" datasetid="dsData" columnid="DS_RECADDR3"/>
      <BindItem id="item17" compid="divData.form.txtCD_VENDOR" propid="value" datasetid="dsData" columnid="CD_VENDOR"/>
      <BindItem id="item18" compid="divData.form.txtDS_VENDOR" propid="value" datasetid="dsData" columnid="DS_VENDOR"/>
      <BindItem id="item19" compid="divData.form.txtDS_UPTAE" propid="value" datasetid="dsData" columnid="DS_UPTAE"/>
      <BindItem id="item20" compid="divData.form.txtDS_UPJONG" propid="value" datasetid="dsData" columnid="DS_UPJONG"/>
      <BindItem id="item21" compid="divData.form.rdoTY_EBILL" propid="value" datasetid="dsData" columnid="YN_EBILL"/>
      <BindItem id="item22" compid="divData.form.rdoYN_JOINT" propid="value" datasetid="dsData" columnid="YN_JOINT"/>
      <BindItem id="item23" compid="divData.form.calDT_TRANSFER" propid="value" datasetid="dsData" columnid="DT_TRANSFER"/>
    </Bind>
  </Form>
</FDL>
