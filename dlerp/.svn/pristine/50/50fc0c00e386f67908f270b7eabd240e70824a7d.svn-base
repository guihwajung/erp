<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.0">
  <Form id="form" width="930" height="550" titletext="레저시설이용 신청" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="divSearch" taborder="1" left="0" top="0" height="78.0" right="0" cssclass="div_SEARCH_Bg">
          <Layouts>
            <Layout>
              <Static id="staTY_LEISURE" taborder="0" text="이용구분" left="0.0" top="10.0" width="92.0" height="24.0" cssclass="sta_WF_SchLabelE"/>
              <Combo id="ccboTY_LEISURE" taborder="1" left="staTY_LEISURE:0.0" top="10.0" width="110" height="24.0" innerdataset="dsTY_LEISURE" codecolumn="CD_CODE" datacolumn="DS_CODE" value="0" index="0" onitemchanged="divSearch_ccboTY_LEISURE_onitemchanged"/>
              <Static id="staCD_LEISURE" taborder="2" text="사업장" left="ccboTY_LEISURE:0.0" top="10.0" width="92.0" height="24.0" onclick="divSearch_staCD_POSITION_onclick" cssclass="sta_WF_SchLabelE"/>
              <Div id="ccfCD_LEISURE" CDTextWidth="40" taborder="3" left="staCD_LEISURE:0.0" top="10.0" width="200" height="24.0" url="cmm::cmmCodeFind.xfdl" text=""/>
              <Static id="staDT_START_END" taborder="4" text="이용시작일" left="0.0" top="staTY_LEISURE:10.0" width="92.0" height="24.0" cssclass="sta_WF_SchLabelE"/>
              <Calendar id="calDT_START" taborder="5" left="staDT_START_END:0.0" top="staTY_LEISURE:10.0" width="110" height="24.0" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true"/>
              <Combo id="ccboDS_R_DAYS" taborder="6" left="calDT_START:0.0" top="staTY_LEISURE:10.0" width="95" height="24.0" innerdataset="dsDS_R_DAYS" codecolumn="CD_CODE" datacolumn="CD_CODE" value="0" index="0" readonly="true" canitemchange="divSearch_ccboDS_R_DAYS_canitemchange"/>
              <Button id="btnLeisureRoomType" taborder="7" text="객실별 정보 안내" left="ccfCD_LEISURE:0.0" top="10.0" width="100" height="24.0" visible="true" onclick="divSearch_btnLeisureRoomType_onclick"/>
              <Calendar id="calDT_END" taborder="8" left="ccboDS_R_DAYS:0.0" top="staTY_LEISURE:10.0" width="110" height="24.0" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divPoint" taborder="2" left="0" top="divSearch:10" height="140" cssclass="div_DATA_Bg" text="" right="0">
          <Layouts>
            <Layout>
              <Static id="staTITLE0" taborder="0" text="포인트" left="0" top="0" width="610" height="30" cssclass="sta_TITLE_Bg"/>

              <Static id="staYEAR" taborder="1" text="년도" left="10" top="staTITLE0:10" width="90" height="59" cssclass="sta_WF_tablelabel" textAlign="center"/>
              <Static id="staBg00" taborder="2" left="10" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" textAlign="center"/>
              <Static id="staRESORT_ROOM" taborder="3" text="리조트숙박" left="staYEAR:-1" top="staTITLE0:10" width="268" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staBg01" taborder="4" left="staBg00:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg02" taborder="16" left="staBg01:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg03" taborder="17" left="staBg02:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg04" taborder="18" left="staBg03:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg05" taborder="19" left="staBg04:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg06" taborder="20" left="staBg05:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg07" taborder="21" left="staBg06:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg08" taborder="22" left="staBg07:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staBg09" taborder="23" left="staBg08:-1" top="staYEAR:-1" width="90" height="30" cssclass="sta_WF_tablebg" visible="true" textAlign="center"/>
              <Static id="staRESORT00" taborder="5" text="생성" left="staYEAR:-1" top="staRESORT_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staRESORT01" taborder="6" text="사용" left="staRESORT00:-1" top="staRESORT_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staRESORT02" taborder="7" text="잔여" left="staRESORT01:-1" top="staRESORT_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF00" taborder="8" text="생성" left="staRESORT02:-1" top="staRESORT_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF_ROOM" taborder="9" text="골프숙박" left="staRESORT_ROOM:-1" top="staTITLE0:10" width="268" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF" taborder="10" text="골프" left="staGOLF_ROOM:-1" top="staTITLE0:10" width="268" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF01" taborder="11" text="사용" left="staGOLF00:-1" top="staGOLF_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF02" taborder="12" text="잔여" left="staGOLF01:-1" top="staGOLF_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF03" taborder="13" text="생성" left="staGOLF02:-1" top="staGOLF_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF04" taborder="14" text="사용" left="staGOLF03:-1" top="staGOLF_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
              <Static id="staGOLF05" taborder="15" text="잔여" left="staGOLF04:-1" top="staGOLF_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center" visible="true"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divData" taborder="0" left="0" top="divPoint:10" bottom="0" right="0" cssclass="div_DATA_Bg">
          <Layouts>
            <Layout>
              <Tab id="tabData" taborder="0" tabindex="0" left="0" top="0" bottom="0" right="0" onchanged="divData_tabData_onchanged" enableevent="true" canchange="divData_tabData_canchange">
                <Tabpages>
                  <Tabpage id="tab1" text="휴가지원">
                    <Layouts>
                      <Layout>
                        <Static id="staTITLE10" taborder="0" text="객실" left="5" top="5" width="80%" height="25" cssclass="sta_TITLE_Bg" enableevent="true" enable="true"/>
                        <Static id="staDS_R_RELATION" taborder="1" text="관계" left="10" top="staTITLE10:10" width="90" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staDS_R_RESERVE" taborder="2" text="예약자" left="staDS_R_RELATION:-1" top="staTITLE10:10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staNO_R_RESERVE" taborder="3" text="예약번호" left="staDS_R_RESERVE:-1" top="staTITLE10:10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staTY_R_ROOM" taborder="4" text="객실타입" left="staNO_R_RESERVE:-1" top="staTITLE10:10" width="300" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staCT_R_ROOM" taborder="10" text="객실수" left="staTY_R_ROOM:-1" top="staTITLE10:10" width="90" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staBg00" taborder="5" left="10" top="staDS_R_RELATION:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg01" taborder="6" left="staBg00:-1" top="staDS_R_RESERVE:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg02" taborder="7" left="staBg01:-1" top="staNO_R_RESERVE:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg03" taborder="8" left="staBg02:-1" top="staTY_R_ROOM:-1" width="300" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg04" taborder="11" left="staBg03:-1" top="staTY_R_ROOM:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staTITLE11" taborder="9" text="골프  (예약자가 본인 or 배우자가 아닐 경우 반드시 실제 예약자 이름 입력)" left="5" top="staBg00:20" width="90%" height="25" cssclass="sta_TITLE_Bg" enable="true" enableevent="true"/>
                        <Static id="staNO_G" taborder="12" text="번호" left="10" top="staTITLE11:10" width="60" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staDS_G_RELATION" taborder="13" text="관계" left="staNO_G:-1" top="staTITLE11:10" width="90" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staDS_G_USER" taborder="14" text="사용자" left="staDS_G_RELATION:-1" top="staTITLE11:10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staDS_G_TEE_OFF" taborder="16" text="티오프시간" left="staDS_G_USER:-1" top="staTITLE11:10" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staDS_G_INSERT" taborder="17" text="예약자" left="staDS_G_TEE_OFF:-1" top="staTITLE11:10" width="110" height="30" cssclass="sta_WF_tablelabel" textAlign="center" enableevent="true"/>
                        <Static id="staDT_G_USE" taborder="15" text="이용일자" left="staDS_G_INSERT:-1" top="staTITLE11:10" width="106" height="30" textAlign="center" visible="false" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staBg05" taborder="18" left="10" top="staNO_G:-1" width="60" height="30" cssclass="sta_WF_tablebg" text="1" textAlign="center"/>
                        <Static id="staBg06" taborder="19" left="staBg05:-1" top="staDS_G_RELATION:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg07" taborder="20" left="staBg06:-1" top="staDS_G_USER:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg08" taborder="22" left="staBg07:-1" top="staDS_G_TEE_OFF:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg09" taborder="23" left="staBg08:-1" top="staDS_G_INSERT:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg10" taborder="21" left="staBg09:-1" top="staDT_G_USE:-1" width="106" height="30" cssclass="sta_WF_tablebg" visible="false"/>
                        <Static id="staBg11" taborder="24" left="10" top="staBg05:-1" width="60" height="30" cssclass="sta_WF_tablebg" text="2" textAlign="center"/>
                        <Static id="staBg12" taborder="25" left="staBg11:-1" top="staBg06:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg13" taborder="26" left="staBg12:-1" top="staBg07:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg14" taborder="28" left="staBg13:-1" top="staBg08:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg15" taborder="29" left="staBg14:-1" top="staBg09:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg16" taborder="27" left="staBg15:-1" top="staBg10:-1" width="106" height="30" cssclass="sta_WF_tablebg" visible="false"/>
                        <Combo id="cboDS_G_RELATION1" taborder="34" left="staBg05:4" top="staDS_G_RELATION:4" width="80" height="20" value="" index="-1" innerdataset="dsDS_RELATION" datacolumn="CD_CODE" codecolumn="CD_CODE"/>
                        <Combo id="cboDS_G_RELATION2" taborder="35" left="staBg11:4" top="staBg06:4" width="80" height="20" innerdataset="dsDS_RELATION" datacolumn="CD_CODE" codecolumn="CD_CODE"/>
                        <Edit id="edtDS_G_USER1" taborder="32" left="staBg06:4" top="staDS_G_USER:4" width="100" height="20" readonly="true"/>
                        <Edit id="edtDS_G_USER2" taborder="33" left="staBg12:4" top="staBg07:4" width="100" height="20" readonly="true"/>
                        <Edit id="edtDS_G_TEE_OFF1" taborder="41" left="staBg07:4" top="staDS_G_TEE_OFF:4" width="80" height="20"/>
                        <Edit id="edtDS_G_TEE_OFF2" taborder="43" left="staBg13:4" top="staBg08:4" width="80" height="20"/>
                        <Edit id="edtDS_G_INSERT1" taborder="42" left="staBg08:4" top="staDS_G_INSERT:4" width="100" height="20"/>
                        <Edit id="edtDS_G_INSERT2" taborder="44" left="staBg14:4" top="staBg09:4" width="100" height="20"/>
                        <Calendar id="ctclDT_G_USE1" taborder="30" left="staBg09:4" top="staDT_G_USE:4" width="95" height="20" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" visible="false"/>
                        <Calendar id="ctclDT_G_USE2" taborder="31" left="staBg15:4" top="staBg10:4" width="95" height="20" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" visible="false"/>
                        <Div id="ccfTY_R_ROOM" CodeFindName="DAX_LEISURE_ROOMTYPE" CDTextWidth="70" taborder="36" left="staBg02:4" top="staTY_R_ROOM:4" width="290" height="20" url="cmm::cmmCodeFind.xfdl" text="" visible="true" BeforeUserDataSetParam="fnBeforeUserDataSetParam" AfterCDTextChanged="fnAfterCDTextChanged"/>
                        <Combo id="cboDS_R_RELATION" taborder="37" left="15" top="staDS_R_RELATION:4" width="80" height="20" value="" index="-1" innerdataset="dsDS_RELATION" datacolumn="CD_CODE" codecolumn="CD_CODE"/>
                        <Edit id="edtDS_R_RESERVE" taborder="38" left="staBg00:4" top="staDS_R_RESERVE:4" width="100" height="20" text="일이삼사오육" readonly="true"/>
                        <Edit id="edtNO_R_RESERVE" taborder="39" left="staBg01:4" top="staNO_R_RESERVE:4" width="100" height="20" text="일이삼사오육"/>
                        <Combo id="cboCT_R_ROOM" taborder="40" left="staBg03:4" top="staCT_R_ROOM:4" width="80" height="20" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn">
                          <Dataset id="innerdataset">
                            <ColumnInfo>
                              <Column id="codecolumn" size="256"/>
                              <Column id="datacolumn" size="256"/>
                            </ColumnInfo>
                            <Rows>
                              <Row>
                                <Col id="codecolumn">1</Col>
                                <Col id="datacolumn">1</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">2</Col>
                                <Col id="datacolumn">2</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">3</Col>
                                <Col id="datacolumn">3</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">4</Col>
                                <Col id="datacolumn">4</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">5</Col>
                                <Col id="datacolumn">5</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">6</Col>
                                <Col id="datacolumn">6</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">7</Col>
                                <Col id="datacolumn">7</Col>
                              </Row>
                            </Rows>
                          </Dataset>
                        </Combo>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tab2" text="직원(추천)할인">
                    <Layouts>
                      <Layout>
                        <Radio id="rdoTY_A_SALE" taborder="0" left="10" top="10" width="230" height="25" onitemchanged="divData_tabData_tab2_rdo00_onitemchanged" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn" direction="vertical" value="1" text="임직원본인할인" index="0">
                          <Dataset id="innerdataset">
                            <ColumnInfo>
                              <Column id="codecolumn" size="256"/>
                              <Column id="datacolumn" size="256"/>
                            </ColumnInfo>
                            <Rows>
                              <Row>
                                <Col id="codecolumn">1</Col>
                                <Col id="datacolumn">임직원본인할인</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">2</Col>
                                <Col id="datacolumn">임직원추천할인</Col>
                              </Row>
                            </Rows>
                          </Dataset>
                        </Radio>
                        <Static id="staNO_A_RESERVE" taborder="1" text="예약번호" left="10" top="rdoTY_A_SALE:10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staDS_A_USER" taborder="2" text="실사용자" left="staNO_A_RESERVE:-1" top="rdoTY_A_SALE:10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staDS_A_PHONE" taborder="3" text="연락처" left="staDS_A_USER:-1" top="rdoTY_A_SALE:10" width="110" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staDS_A_RELATION" taborder="4" text="관계" left="staDS_A_PHONE:-1" top="rdoTY_A_SALE:10" width="90" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staTY_A_ROOM" taborder="5" text="객실타입" left="staDS_A_RELATION:-1" top="rdoTY_A_SALE:10" width="300" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staCT_A_ROOM" taborder="6" text="객실수" left="staTY_A_ROOM:-1" top="rdoTY_A_SALE:10" width="90" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staBg16" taborder="7" left="10" top="staNO_A_RESERVE:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg17" taborder="8" left="staBg16:-1" top="staNO_A_RESERVE:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg18" taborder="9" left="staBg17:-1" top="staNO_A_RESERVE:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg19" taborder="10" left="staBg18:-1" top="staNO_A_RESERVE:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg20" taborder="11" left="staBg19:-1" top="staNO_A_RESERVE:-1" width="300" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg21" taborder="13" left="staBg20:-1" top="staNO_A_RESERVE:-1" width="90" height="30" cssclass="sta_WF_tablebg"/>
                        <Edit id="edtNO_A_RESERVE" taborder="12" left="15" top="staNO_A_RESERVE:5" width="100" height="20" text="일이삼사오육"/>
                        <Edit id="edtDS_A_USER" taborder="14" left="staBg16:5" top="staDS_A_USER:5" width="100" height="20" text="일이삼사오육"/>
                        <Edit id="edtDS_A_PHONE" taborder="15" left="staBg17:5" top="staDS_A_PHONE:5" width="100" height="20" text="일이삼사오육"/>
                        <Div id="ccfTY_A_ROOM" CodeFindName="DAX_LEISURE_ROOMTYPE" CDTextWidth="70" taborder="16" left="staBg19:5" top="staTY_A_ROOM:5" width="290" height="20" url="cmm::cmmCodeFind.xfdl" text="" visible="true" BeforeUserDataSetParam="fnBeforeUserDataSetParam" AfterCDTextChanged="fnAfterCDTextChanged"/>
                        <Combo id="cboCT_A_ROOM" taborder="17" left="staBg20:5" top="staCT_A_ROOM:5" width="80" height="20" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn">
                          <Dataset id="innerdataset">
                            <ColumnInfo>
                              <Column id="codecolumn" size="256"/>
                              <Column id="datacolumn" size="256"/>
                            </ColumnInfo>
                            <Rows>
                              <Row>
                                <Col id="codecolumn">1</Col>
                                <Col id="datacolumn">1</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">2</Col>
                                <Col id="datacolumn">2</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">3</Col>
                                <Col id="datacolumn">3</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">4</Col>
                                <Col id="datacolumn">4</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">5</Col>
                                <Col id="datacolumn">5</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">6</Col>
                                <Col id="datacolumn">6</Col>
                              </Row>
                              <Row>
                                <Col id="codecolumn">7</Col>
                                <Col id="datacolumn">7</Col>
                              </Row>
                            </Rows>
                          </Dataset>
                        </Combo>
                        <Edit id="edtDS_A_RELATION" taborder="18" left="staDS_A_PHONE:5" top="staDS_A_RELATION:5" width="80" height="20" text="일이삼사오육"/>
                        <Static id="sta00" taborder="19" text="(제주부영호텔&amp;리조트, 오투리조트, 마에스트로CC에 한함) " left="rdoTY_A_SALE:0" top="10" width="563" height="30" font="bold 12px/normal &quot;Dotum&quot;"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tab3" text="무주쿠폰">
                    <Layouts>
                      <Layout>
                        <Static id="staNO_B" taborder="0" text="번호" left="10" top="10" width="60" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staNO_B_RESERVE" taborder="1" text="예약번호" left="staNO_B:-1" top="10" width="110" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staTY_B_ROOM" taborder="2" text="객실타입" left="staNO_B_RESERVE:-1" top="10" width="130" height="30" textAlign="center" cssclass="sta_WF_tablelabelE"/>
                        <Static id="staAM_COUPON" taborder="3" text="판매금액" left="staTY_B_ROOM:-1" top="10" width="110" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staNO_B_NUMBER" taborder="4" text="일련번호" left="staAM_COUPON:-1" top="10" width="110" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staDS_BANK" taborder="5" text="은행" left="staNO_B_NUMBER:-1" top="10" width="110" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staNO_ACCOUNT" taborder="6" text="계좌번호" left="staDS_BANK:-1" top="10" width="140" height="30" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staBg22" taborder="7" left="10" top="staNO_B:-1" width="60" height="30" cssclass="sta_WF_tablebg" text="1" textAlign="center"/>
                        <Static id="staBg23" taborder="8" left="staBg22:-1" top="staNO_B:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg24" taborder="9" left="staBg23:-1" top="staNO_B:-1" width="130" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg25" taborder="10" left="staBg24:-1" top="staNO_B:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg26" taborder="11" left="staBg25:-1" top="staNO_B:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg27" taborder="12" left="staBg26:-1" top="staNO_B:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg28" taborder="13" left="staBg27:-1" top="staNO_B:-1" width="140" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg29" taborder="14" left="10" top="staBg22:-1" width="60" height="30" cssclass="sta_WF_tablebg" text="2" textAlign="center"/>
                        <Static id="staBg30" taborder="15" left="staBg29:-1" top="staBg22:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg31" taborder="16" left="staBg30:-1" top="staBg22:-1" width="130" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg32" taborder="17" left="staBg31:-1" top="staBg22:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg33" taborder="18" left="staBg32:-1" top="staBg22:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg34" taborder="19" left="staBg33:-1" top="staBg22:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg35" taborder="20" left="staBg34:-1" top="staBg22:-1" width="140" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg36" taborder="21" left="10" top="staBg29:-1" width="60" height="30" cssclass="sta_WF_tablebg" text="3" textAlign="center"/>
                        <Static id="staBg37" taborder="22" left="staBg36:-1" top="staBg29:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg38" taborder="23" left="staBg37:-1" top="staBg29:-1" width="130" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg39" taborder="24" left="staBg38:-1" top="staBg29:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg40" taborder="25" left="staBg39:-1" top="staBg29:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg41" taborder="26" left="staBg40:-1" top="staBg29:-1" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg42" taborder="27" left="staBg41:-1" top="staBg29:-1" width="140" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg00" taborder="28" left="10" top="126" width="60" height="30" cssclass="sta_WF_tablebg" text="4" textAlign="center"/>
                        <Static id="staBg01" taborder="29" left="69" top="126" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg02" taborder="30" left="staBg01:-1" top="126" width="130" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg03" taborder="31" left="staBg02:-1" top="126" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg04" taborder="32" left="staBg03:-1" top="126" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg05" taborder="33" left="staBg04:-1" top="126" width="110" height="30" cssclass="sta_WF_tablebg"/>
                        <Static id="staBg06" taborder="34" left="staBg05:-1" top="126" width="140" height="30" cssclass="sta_WF_tablebg"/>
                        <Edit id="edtNO_B_RESERVE1" taborder="35" left="staNO_B:5" top="staNO_B_RESERVE:4" width="100" height="20" text="3198237"/>
                        <Combo id="cboTY_B_ROOM1" taborder="36" left="staNO_B_RESERVE:5" top="staTY_B_ROOM:5" width="120" height="20" innerdataset="dsTY_B_ROOM" datacolumn="DS_CODE" codecolumn="CD_CODE" index="-1" text="" value=""/>
                        <Combo id="cboTY_B_ROOM2" taborder="37" left="staNO_B_RESERVE:5" top="staBg24:5" width="120" height="20" innerdataset="dsTY_B_ROOM" datacolumn="DS_CODE" codecolumn="CD_CODE" index="-1" text="" value=""/>
                        <Combo id="cboTY_B_ROOM3" taborder="38" left="staNO_B_RESERVE:5" top="staBg31:5" width="120" height="20" innerdataset="dsTY_B_ROOM" datacolumn="DS_CODE" codecolumn="CD_CODE" index="-1" text="" value=""/>
                        <Combo id="cboTY_B_ROOM4" taborder="39" left="staNO_B_RESERVE:5" top="staBg38:5" width="120" height="20" innerdataset="dsTY_B_ROOM" datacolumn="DS_CODE" codecolumn="CD_CODE" index="-1" text="" value=""/>
                        <Edit id="edtNO_B_RESERVE2" taborder="40" left="staNO_B:5" top="staBg23:5" width="100" height="20" text="3198237"/>
                        <Edit id="edtNO_B_RESERVE3" taborder="41" left="staNO_B:5" top="staBg30:5" width="100" height="20" text="3198237"/>
                        <Edit id="edtNO_B_RESERVE4" taborder="42" left="staNO_B:5" top="staBg37:5" width="100" height="20" text="3198237"/>
                        <Edit id="edtNO_ACCOUNT1" taborder="43" left="staDS_BANK:5" top="staNO_ACCOUNT:5" width="130" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_ACCOUNT2" taborder="44" left="staDS_BANK:5" top="staBg28:5" width="130" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_ACCOUNT3" taborder="45" left="staDS_BANK:5" top="staBg35:5" width="130" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_ACCOUNT4" taborder="46" left="staDS_BANK:5" top="staBg42:5" width="130" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_B_NUMBER1" taborder="47" left="staAM_COUPON:5" top="staNO_B_NUMBER:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_B_NUMBER2" taborder="48" left="staAM_COUPON:5" top="staBg26:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_B_NUMBER3" taborder="49" left="staAM_COUPON:5" top="staBg33:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtNO_B_NUMBER4" taborder="50" left="staAM_COUPON:5" top="staBg40:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtDS_BANK1" taborder="51" left="staNO_B_NUMBER:5" top="staDS_BANK:5" width="100" height="20" text="3198237" readonly="true"/>
                        <MaskEdit id="edtAM_COUPON1" taborder="52" left="staTY_B_ROOM:5" top="staAM_COUPON:5" width="100" height="20" readonly="true" inputtype="number" textAlign="right" format="#,##"/>
                        <Edit id="edtDS_BANK2" taborder="53" left="staNO_B_NUMBER:5" top="staBg27:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtDS_BANK3" taborder="54" left="staNO_B_NUMBER:5" top="staBg34:5" width="100" height="20" text="3198237" readonly="true"/>
                        <Edit id="edtDS_BANK4" taborder="55" left="staNO_B_NUMBER:5" top="staBg41:5" width="100" height="20" text="3198237" readonly="true"/>
                        <MaskEdit id="edtAM_COUPON2" taborder="56" left="staTY_B_ROOM:5" top="staBg25:5" width="100" height="20" readonly="true" inputtype="number" textAlign="right" format="#,##"/>
                        <MaskEdit id="edtAM_COUPON3" taborder="57" left="staTY_B_ROOM:5" top="staBg32:5" width="100" height="20" readonly="true" inputtype="number" textAlign="right" format="#,##"/>
                        <MaskEdit id="edtAM_COUPON4" taborder="58" left="staTY_B_ROOM:5" top="staBg39:5" width="100" height="20" readonly="true" inputtype="number" textAlign="right" format="#,##"/>
                        <Static id="sta01" taborder="59" text="■ 무주쿠폰 등록안내" left="10" top="edtAM_COUPON4:15" width="445" height="20" font="bold 12px/normal &quot;Dotum&quot;" verticalAlign="middle"/>
                        <Static id="sta02" taborder="60" text="* 부영주택/동광주택/남광/광영토건 소속자만 신청 가능합니다." left="10" top="sta01:2" width="445" height="20" font="bold 12px/normal &quot;Dotum&quot;" verticalAlign="middle"/>
                        <Static id="sta03" taborder="61" text="* 동하계골드/춘추계로얄 부영주택 소속자는 신청이 불가합니다." left="10" top="sta02:2" width="445" height="20" font="bold 12px/normal &quot;Dotum&quot;" verticalAlign="middle"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.objApp = this.gfnGetApplication();

var gIdPerson;
var gNoSeq;
var gTySave = "I";

this.form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	// -- 필수 -------------------//
	this.gfnFormOnLoad(this);	
	this.gfnFormInfo(this);		
	// ---------------------------//
	
	this.fnSetButton();
	this.fnSetExtendButton();
	this.fnSetVariable();
	this.fnSetEvent();
	this.fnSetParameter();

	this.fnSetCombo();	// 콜백에서 fnReset 호출(조회)
	this.fnSelectPoint();
};

/************************************************************************
 * 버튼 설정 : 화면(Tab) 전환시 마다 호출
 * 서브버튼 사용 및 공통버튼 강제 제어시 여기서 처리
 ************************************************************************/
this.fnSetButton = function() {
	// Select, Add, Del, Save, Excel, Print
	// SubSelect, SubAdd, SubDel, SuubSave, SubExcel
	//this.FormBtns.Select.set_enable(false);
	
	this.FormBtns.Select.set_enable(false);
	this.FormBtns.Add.set_enable(false);
	this.FormBtns.Del.set_enable(false);
	this.FormBtns.Reset.set_enable(true);
}

/************************************************************************
 * 확장 버튼 : 화면별 버튼 설정 ID, function 연결 (화면버튼관리)
 ************************************************************************/
this.fnSetExtendButton = function() {
	//this.btn1 = this.gfnFormButtonAdd("btnPeriodSetting", "fnPeriodSetting");	// 기간설정
};

/************************************************************************
 * 변수 선언
 ************************************************************************/
this.fnSetVariable = function() {
	
	this.ccfCD_LEISURE    =	this.divSearch.form.ccfCD_LEISURE;		// 사업장
	this.ccboTY_LEISURE	  =	this.divSearch.form.ccboTY_LEISURE;		// 레저구분(휴가지원/직원할인/무주쿠폰)
	this.calDT_START   =	this.divSearch.form.calDT_START; 		// 이용시작일(FROM)
	this.calDT_END   	  =	this.divSearch.form.calDT_END;			// 이용시작일(TO)
	this.ccboDS_R_DAYS =	this.divSearch.form.ccboDS_R_DAYS;		// 박수

	this.dxTab = this.divData.form.tabData;

	// Tab1 휴가지원
	
	this.staTITLE10 = this.dxTab.tab1.form.staTITLE10;
	
	this.cboDS_R_RELATION = this.dxTab.tab1.form.cboDS_R_RELATION;
	this.edtDS_R_RESERVE = this.dxTab.tab1.form.edtDS_R_RESERVE;
	this.edtNO_R_RESERVE = this.dxTab.tab1.form.edtNO_R_RESERVE;
	this.ccfTY_R_ROOM = this.dxTab.tab1.form.ccfTY_R_ROOM;
	this.cboCT_R_ROOM = this.dxTab.tab1.form.cboCT_R_ROOM;

	this.cboDS_G_RELATION1 = this.dxTab.tab1.form.cboDS_G_RELATION1;
	this.cboDS_G_RELATION2 = this.dxTab.tab1.form.cboDS_G_RELATION2;
	this.edtDS_G_USER1 = this.dxTab.tab1.form.edtDS_G_USER1;
	this.edtDS_G_USER2 = this.dxTab.tab1.form.edtDS_G_USER2;
	//this.ctclDT_G_USE1 = this.dxTab.tab1.form.ctclDT_G_USE1;
	//this.ctclDT_G_USE2 = this.dxTab.tab1.form.ctclDT_G_USE2;
	this.edtDS_G_TEE_OFF1 = this.dxTab.tab1.form.edtDS_G_TEE_OFF1;
	this.edtDS_G_TEE_OFF2 = this.dxTab.tab1.form.edtDS_G_TEE_OFF2;
	this.edtDS_G_INSERT1 = this.dxTab.tab1.form.edtDS_G_INSERT1;
	this.edtDS_G_INSERT2 = this.dxTab.tab1.form.edtDS_G_INSERT2;

	// Tab2 직원(추천)할인
	this.rdoTY_A_SALE = this.dxTab.tab2.form.rdoTY_A_SALE;
	this.edtNO_A_RESERVE = this.dxTab.tab2.form.edtNO_A_RESERVE;
	this.edtDS_A_USER = this.dxTab.tab2.form.edtDS_A_USER;
	this.edtDS_A_PHONE = this.dxTab.tab2.form.edtDS_A_PHONE;
	this.edtDS_A_RELATION = this.dxTab.tab2.form.edtDS_A_RELATION;
	this.ccfTY_A_ROOM = this.dxTab.tab2.form.ccfTY_A_ROOM;
	this.cboCT_A_ROOM = this.dxTab.tab2.form.cboCT_A_ROOM;

	// Tab3 무주쿠폰
	this.edtNO_B_RESERVE1 = this.dxTab.tab3.form.edtNO_B_RESERVE1;
	this.edtNO_B_RESERVE2 = this.dxTab.tab3.form.edtNO_B_RESERVE2;
	this.edtNO_B_RESERVE3 = this.dxTab.tab3.form.edtNO_B_RESERVE3;
	this.edtNO_B_RESERVE4 = this.dxTab.tab3.form.edtNO_B_RESERVE4;
	this.cboTY_B_ROOM1 = this.dxTab.tab3.form.cboTY_B_ROOM1;
	this.cboTY_B_ROOM2 = this.dxTab.tab3.form.cboTY_B_ROOM2;
	this.cboTY_B_ROOM3 = this.dxTab.tab3.form.cboTY_B_ROOM3;
	this.cboTY_B_ROOM4 = this.dxTab.tab3.form.cboTY_B_ROOM4;

	//this.dxGrid = this.divData.form.tabData.tab1.form.objGrid;
	//this.dxGrid2 = this.divData.form.tabData.tab2.form.objGrid2;
	
	this.grSearch = this.FormInfo.GR_SEARCH;		// 권한
	this.cdGroup = this.AuthClient.CD_GROUP;		// 그룹코드	
	//this.dxGrid2.BeforeUserDataSetParam = "fnGrid_BeforeUserDataSetParam";
};

/************************************************************************
 * 이벤트 설정
 ************************************************************************/
this.fnSetEvent = function() {

	this.ccfCD_LEISURE.CodeFindName = "DAX_CFCOMMONCODE";
	this.ccfCD_LEISURE.BeforeUserDataSetParam = "fnBeforeUserDataSetParam";
	this.ccfCD_LEISURE.AfterCDTextChanged = "fnAfterCDTextChanged";
};

/************************************************************************
 * 파라미터 설정
 ************************************************************************/
this.fnSetParameter = function() {

	this.dsSelectPoint = new Dataset();
	this.dsSelectPoint.addColumn("ID_PERSON", "bigdecimal");

	this.dsSelect = new Dataset();
	this.dsSelect.addColumn("NO_SEQ", "bigdecimal");
	this.dsSelect.addColumn("ID_PERSON", "string");

	this.dsSave = new Dataset();
	this.dsSave.addColumn("ID_PERSON", "string");
	this.dsSave.addColumn("NO_SEQ", "bigdecimal");
	this.dsSave.addColumn("DT_REQUEST", "string");
	this.dsSave.addColumn("CD_LEISURE", "string");
	this.dsSave.addColumn("DT_START", "string");
	this.dsSave.addColumn("DT_END", "string");
	this.dsSave.addColumn("DS_R_DAYS", "string");
	this.dsSave.addColumn("DS_R_RELATION", "string");
	this.dsSave.addColumn("DS_R_RESERVE", "string");
	this.dsSave.addColumn("NO_R_RESERVE", "string");
	this.dsSave.addColumn("TY_R_ROOM", "string");
	this.dsSave.addColumn("NO_R_ROOM", "bigdecimal");
	this.dsSave.addColumn("CT_R_ROOM", "bigdecimal");
	this.dsSave.addColumn("DS_G_RELATION1", "string");
	this.dsSave.addColumn("DS_G_USER1", "string");
	this.dsSave.addColumn("DT_G_USE1", "string");
	this.dsSave.addColumn("DS_G_TEE_OFF1", "string");
	this.dsSave.addColumn("DS_G_INSERT1", "string");
	this.dsSave.addColumn("DS_G_RELATION2", "string");
	this.dsSave.addColumn("DS_G_USER2", "string");
	this.dsSave.addColumn("DT_G_USE2", "string");
	this.dsSave.addColumn("DS_G_TEE_OFF2", "string");
	this.dsSave.addColumn("DS_G_INSERT2", "string");
	this.dsSave.addColumn("TY_A_SALE", "string");
	this.dsSave.addColumn("NO_A_RESERVE", "string");
	this.dsSave.addColumn("DS_A_USER", "string");
	this.dsSave.addColumn("TY_A_ROOM", "string");
	this.dsSave.addColumn("NO_A_ROOM", "bigdecimal");
	this.dsSave.addColumn("CT_A_ROOM", "bigdecimal");
	this.dsSave.addColumn("DS_A_DAYS", "string");
	this.dsSave.addColumn("DS_A_RELATION", "string");
	this.dsSave.addColumn("DS_A_PHONE", "string");
	this.dsSave.addColumn("NO_B_NUMBER1", "string");
	this.dsSave.addColumn("NO_B_NUMBER2", "string");
	this.dsSave.addColumn("NO_B_NUMBER3", "string");
	this.dsSave.addColumn("NO_B_NUMBER4", "string");
	this.dsSave.addColumn("NO_B_RESERVE1", "string");
	this.dsSave.addColumn("NO_B_RESERVE2", "string");
	this.dsSave.addColumn("NO_B_RESERVE3", "string");
	this.dsSave.addColumn("NO_B_RESERVE4", "string");
	this.dsSave.addColumn("TY_B_ROOM1", "string");
	this.dsSave.addColumn("TY_B_ROOM2", "string");
	this.dsSave.addColumn("TY_B_ROOM3", "string");
	this.dsSave.addColumn("TY_B_ROOM4", "string");
	this.dsSave.addColumn("TY_LEISURE", "string");
	this.dsSave.addColumn("ID_INSERT", "string");
	this.dsSave.addColumn("DT_INSERT", "string");
	this.dsSave.addColumn("ID_USER", "string");
	this.dsSave.addColumn("TY_SAVE", "string");
}

/************************************************************************
 * 컨트롤 이벤트
 ************************************************************************/
 /*
  *	조회 버튼
  */
this.fnSelect = function() {
	//if (!this.fnSelectValidate()) return false;
	var tidx = this.divData.form.tabData.tabindex;

	var P_ID_PERSON = this.gfnNvl(this.gIdPerson, this.getOwnerFrame().P_ID_PERSON);
	var P_NO_SEQ = this.gfnNvl(this.gNoSeq, this.getOwnerFrame().P_NO_SEQ);

	this.dsSelect.clearData();
	this.dsSelect.addRow();
	
	this.dsSelect.setColumn(0, "ID_PERSON", P_ID_PERSON);
	this.dsSelect.setColumn(0, "NO_SEQ", P_NO_SEQ);

	var strSvcId    = "select";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select=dsSelect";
	var outData     = "dsList=select0";
	var strArg      = "";
	var callBackFnc = "fnCallback";	
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

// 포인트 조회
this.fnSelectPoint = function() {

	if(this.FormInfo.GR_SEARCH != "1" && this.gfnIsNull(this.AuthClient.ID_PERSON)){
		this.gfnAlert("레저 신청 대상자가 아닙니다.");

		this.FormBtns.Select.set_enable(false);
		this.FormBtns.Add.set_enable(false);
		this.FormBtns.Del.set_enable(false);
		this.FormBtns.Reset.set_enable(false);
		
		return;
	}
	
	//if (!this.fnSelectValidate()) return false;

	//var ID_USER = this.AuthClient.ID_USER;
	var TY_SAVE = this.gfnNvl(this.gTySave, this.getOwnerFrame().P_TY_SAVE);
	var ID_PERSON = this.gfnNvl(this.gIdPerson, this.getOwnerFrame().P_ID_PERSON);
	
	if(TY_SAVE == "I"){
		ID_PERSON = this.AuthClient.ID_PERSON;
	}

	this.dsSelectPoint.clearData();
	this.dsSelectPoint.addRow();
	
	//ID_USER = "1008";	// for test
	this.dsSelectPoint.setColumn(0, "ID_PERSON", ID_PERSON);

	var strSvcId    = "selectPoint";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "selectPoint=dsSelectPoint";
	var outData     = "dsListPoint=selectPoint0";
	var strArg      = "";
	var callBackFnc = "fnCallback";

	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 	    // 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

/*
 *	입력 버튼
 */
this.fnAdd = function() {
	//var nrow = this.gfnGridAdd(this.dxGrid);
}

/*
 *	삭제 버튼
 */
this.fnDel = function() {
	//this.gfnGridDel(this.dxGrid);
}

/*
 *	저장 버튼
 */
this.fnSave = function() {

	// 유효성 검사	
	if (!this.fnSaveValidate()) return false;


	var sToday = this.gfnGetDate();
	var TY_SAVE = this.gfnNvl(this.gTySave, this.getOwnerFrame().P_TY_SAVE);
	var ID_PERSON = this.gfnNvl(this.gIdPerson, this.getOwnerFrame().P_ID_PERSON);
	var NO_SEQ = this.gfnNvl(this.gNoSeq, this.getOwnerFrame().P_NO_SEQ);

	var ID_USER = this.AuthClient.ID_USER;
	var DT_END = this.fnGetDtEnd();	// 시작일로 1박~~~ 계산해서 받아옴
	var DS_R_DAYS = this.dsSearch.getColumn(0, "DS_R_DAYS");	// 박수
	var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");	// 레저구분(1휴가지원/2직원할인/3무주쿠폰)
	var DT_START = this.dsSearch.getColumn(0, "DT_START");

	var DT_G_USE1 = (!this.gfnIsNull(this.dsList.getColumn(0, "DS_G_USER1"))) ? DT_START : "";
	var DT_G_USE2 = (!this.gfnIsNull(this.dsList.getColumn(0, "DS_G_USER2"))) ? DT_START : "";	

	if(TY_SAVE == "I"){
		ID_PERSON = this.AuthClient.ID_PERSON;
	}
	//ID_USER = "1008";	// for test
	
	this.dsResult.clearData();
	this.dsSave.clearData();
	var nrow = this.dsSave.addRow();	
	
	this.dsSave.setColumn( nrow, "ID_PERSON", ID_PERSON);
	this.dsSave.setColumn( nrow, "NO_SEQ", NO_SEQ);
	this.dsSave.setColumn( nrow, "TY_SAVE", TY_SAVE);	
	
	this.dsSave.setColumn( nrow, "DT_REQUEST", sToday);
	
	this.dsSave.setColumn( nrow, "TY_LEISURE", this.dsSearch.getColumn(0, "TY_LEISURE"));
	this.dsSave.setColumn( nrow, "CD_LEISURE", this.dsSearch.getColumn(0, "CD_LEISURE"));
	this.dsSave.setColumn( nrow, "DT_START", this.dsSearch.getColumn(0, "DT_START"));
	this.dsSave.setColumn( nrow, "DT_END", DT_END);
	this.dsSave.setColumn( nrow, "DS_R_DAYS", DS_R_DAYS);	// 객실_박수
	//====================================================================================
	switch(this.divData.form.tabData.tabindex) {
		case 0:
			this.dsSave.setColumn( nrow, "DS_R_RELATION", this.dsList.getColumn(0, "DS_R_RELATION"));
			this.dsSave.setColumn( nrow, "DS_R_RESERVE", this.dsList.getColumn(0, "DS_R_RESERVE"));
			this.dsSave.setColumn( nrow, "NO_R_RESERVE", this.dsList.getColumn(0, "NO_R_RESERVE"));
			this.dsSave.setColumn( nrow, "TY_R_ROOM", this.dsList.getColumn(0, "TY_R_ROOM"));
			this.dsSave.setColumn( nrow, "NO_R_ROOM", this.dsList.getColumn(0, "NO_R_ROOM"));	// 객실_객실타입(SEQ)
			this.dsSave.setColumn( nrow, "CT_R_ROOM", this.dsList.getColumn(0, "CT_R_ROOM"));
			//====================================================================================
			this.dsSave.setColumn( nrow, "DS_G_RELATION1", this.dsList.getColumn(0, "DS_G_RELATION1"));
			this.dsSave.setColumn( nrow, "DS_G_USER1", this.dsList.getColumn(0, "DS_G_USER1"));
			this.dsSave.setColumn( nrow, "DT_G_USE1", DT_G_USE1);
			this.dsSave.setColumn( nrow, "DS_G_TEE_OFF1", this.dsList.getColumn(0, "DS_G_TEE_OFF1"));
			this.dsSave.setColumn( nrow, "DS_G_INSERT1", this.dsList.getColumn(0, "DS_G_INSERT1"));
			this.dsSave.setColumn( nrow, "DS_G_RELATION2", this.dsList.getColumn(0, "DS_G_RELATION2"));
			this.dsSave.setColumn( nrow, "DS_G_USER2", this.dsList.getColumn(0, "DS_G_USER2"));
			this.dsSave.setColumn( nrow, "DT_G_USE2", DT_G_USE2);
			this.dsSave.setColumn( nrow, "DS_G_TEE_OFF2", this.dsList.getColumn(0, "DS_G_TEE_OFF2"));
			this.dsSave.setColumn( nrow, "DS_G_INSERT2", this.dsList.getColumn(0, "DS_G_INSERT2"));

			break;
		case 1:
			//====================================================================================
			this.dsSave.setColumn( nrow, "TY_A_SALE", this.dsList.getColumn(0, "TY_A_SALE"));
			this.dsSave.setColumn( nrow, "NO_A_RESERVE", this.dsList.getColumn(0, "NO_A_RESERVE"));
			this.dsSave.setColumn( nrow, "DS_A_USER", this.dsList.getColumn(0, "DS_A_USER"));
			this.dsSave.setColumn( nrow, "TY_A_ROOM", this.dsList.getColumn(0, "TY_A_ROOM"));
			this.dsSave.setColumn( nrow, "NO_A_ROOM", this.dsList.getColumn(0, "NO_A_ROOM"));	// 객실_객실타입(SEQ)
			this.dsSave.setColumn( nrow, "CT_A_ROOM", this.dsList.getColumn(0, "CT_A_ROOM"));
			this.dsSave.setColumn( nrow, "DS_A_DAYS", DS_R_DAYS);
			this.dsSave.setColumn( nrow, "DS_A_RELATION", this.dsList.getColumn(0, "DS_A_RELATION"));
			this.dsSave.setColumn( nrow, "DS_A_PHONE", this.dsList.getColumn(0, "DS_A_PHONE"));

			break;
		case 2:
			//====================================================================================
			this.dsSave.setColumn( nrow, "NO_B_NUMBER1", this.dsList.getColumn(0, "NO_B_NUMBER1"));
			this.dsSave.setColumn( nrow, "NO_B_NUMBER2", this.dsList.getColumn(0, "NO_B_NUMBER2"));
			this.dsSave.setColumn( nrow, "NO_B_NUMBER3", this.dsList.getColumn(0, "NO_B_NUMBER3"));
			this.dsSave.setColumn( nrow, "NO_B_NUMBER4", this.dsList.getColumn(0, "NO_B_NUMBER4"));
			this.dsSave.setColumn( nrow, "NO_B_RESERVE1", this.dsList.getColumn(0, "NO_B_RESERVE1"));
			this.dsSave.setColumn( nrow, "NO_B_RESERVE2", this.dsList.getColumn(0, "NO_B_RESERVE2"));
			this.dsSave.setColumn( nrow, "NO_B_RESERVE3", this.dsList.getColumn(0, "NO_B_RESERVE3"));
			this.dsSave.setColumn( nrow, "NO_B_RESERVE4", this.dsList.getColumn(0, "NO_B_RESERVE4"));
			this.dsSave.setColumn( nrow, "TY_B_ROOM1", this.dsList.getColumn(0, "TY_B_ROOM1"));
			this.dsSave.setColumn( nrow, "TY_B_ROOM2", this.dsList.getColumn(0, "TY_B_ROOM2"));
			this.dsSave.setColumn( nrow, "TY_B_ROOM3", this.dsList.getColumn(0, "TY_B_ROOM3"));
			this.dsSave.setColumn( nrow, "TY_B_ROOM4", this.dsList.getColumn(0, "TY_B_ROOM4"));

			break;
	}

	this.dsSave.setColumn( nrow, "DT_INSERT", this.dsList.getColumn(0, "DT_INSERT"));
	this.dsSave.setColumn( nrow, "ID_INSERT", this.dsList.getColumn(0, "ID_INSERT"));
	this.dsSave.setColumn( nrow, "ID_USER", ID_USER);
	this.dsSave.setColumn( nrow, "GR_SEARCH", this.FormInfo.GR_SEARCH);	 // 권한

	if (this.dsSave.rowcount == 0) return;

	trace(this.dsSave.saveXML());
	
	// DABPR_LEISURE_REQUEST_SAVE
	// DABPR_LEISURE_REQUEST_INSERT
	

	var strSvcId    = "save";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = "save=dsSave"; // "insert=dsSave";
	var outData     = "dsResult=save0";
	var strArg      = "";
	var callBackFnc = "fnCallback";

	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
}

/*
 *	엑셀 버튼
 */
this.fnExcel = function() {
	//this.gfnExcelExport(this.dxGrid);
}

/*
 *	출력 버튼
 */
this.fnPrint = function() {
}

/*
 *	초기화 버튼
 */
this.fnReset  = function() {
	this.dsSearch.clearData();
	this.dsSearch.addRow();

	this.dsList.clearData();	
	var nRow = this.dsList.addRow();
	this.dsList.updatecontrol = false;
	var bSucc = this.dsList.setRowType(0, Dataset.ROWTYPE_NORMAL);	// 1 초기 행의 상태 2추가 4수정 8삭제
	this.dsList.setColumn(nRow, "TY_A_SALE", "1");	// RADIO 1:임직원본인할인 / 2:임직원추천할인
	this.dsList.updatecontrol = true; 
	
	//지급년월(현재월)
	//this.divSearch.form.ctclYY_TUITION.form.TextBox.set_value(this.gfnGetDate().substr(0,6));
	
	var P_TY_SAVE = this.getOwnerFrame().P_TY_SAVE;
	var P_ID_PERSON = this.getOwnerFrame().P_ID_PERSON;
	var P_NO_SEQ = this.getOwnerFrame().P_NO_SEQ;
	var P_TY_LEISURE = this.getOwnerFrame().P_TY_LEISURE;
	// TY_LEISURE 레저구분(휴가지원/직원할인/무주쿠폰)
	
	// 상태값 (I:등록 / U:수정,조회)
	this.gTySave = P_TY_SAVE;
	//this.gfnNvl(this.getOwnerFrame().arguments.Args.P_TY_LEISURE, "01");


	this.gIdPerson = "";
	this.gNoSeq = "";

	// 부모창에서 받아오는 값 있으면
	if(!this.gfnIsNull(P_NO_SEQ) && !this.gfnIsNull(P_ID_PERSON)) {
		this.gIdPerson = P_ID_PERSON;
		this.gNoSeq = P_NO_SEQ;
		
		this.FormBtns.Select.click(true);

	}else{	
		// 이용구분
		this.dxTab.set_tabindex(0);
		this.ccboTY_LEISURE.set_index(0);
		//this.rdoTY_A_SALE.set_index(0);
		this.fnSetReadonlyByTab(true);
	}
}

/************************************************************************
 * Validate
 ************************************************************************/
/*
 *	조회 Validate
 */
this.fnSelectValidate = function() {
	var validate = true;
	/*
	if(this.gfnIsNull(this.ctclYY_TUITION.form.TextBox.value)){	
		validate = false;	
		this.gfnAlert("지급년월을 입력하세요");	
		this.ctclYY_TUITION.form.TextBox.setFocus();
	}
	*/
	return validate;
};

/*
 *	저장 Validate
 */
this.fnSaveValidate = function() {
	var strMsg = "";
	var ID_USER = this.AuthClient.ID_USER;

	var YN_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "YN_APPROVE"), "N");			// 담당자_승인값
	var YN_TEAMLEADER = this.gfnNvl(this.dsList.getColumn(0, "YN_TEAMLEADER"), "N");	// 부서장_승인값
	var YN_OFFICER = this.gfnNvl(this.dsList.getColumn(0, "YN_OFFICER"), "N");			// 임원_승인값

	if ( YN_APPROVE == "Y" || YN_TEAMLEADER == "Y" || YN_OFFICER == "Y"){
		this.gfnAlert("승인중이거나 승인 완료된 자료는 삭제 할 수 없습니다.");
		return;
	}

	var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");	// 레저구분(1휴가지원/2직원할인/3무주쿠폰)
	var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");	// 이용사업장
	var DS_R_DAYS = this.dsSearch.getColumn(0, "DS_R_DAYS");	// 박수
	var DT_START = this.dsSearch.getColumn(0, "DT_START");		// 이용시작일
	
	if(this.gfnIsNull(CD_LEISURE)) {
		this.gfnAlert("이용 사업장은 반드시 입력 하셔야 합니다");
		return false;
	}

	if(this.gfnIsNull(DT_START)) {
		this.gfnAlert("이용 시작일은 반드시 입력 하셔야 합니다");
		return false;
	}

	if(DT_START.substring(0,4)  < this.gfnGetDate().substring(0,4) ){
		this.gfnAlert("이용 시작일은 당해년도(" + this.gfnGetDate().substring(0,4) + ") 이전 일자로 입력이 불가합니다");
		return false;
	}
	
	/*
	if(DT_START < this.gfnGetDate()){
		this.gfnAlert("이용 시작일은 오늘 이전 일자로 입력이 불가합니다");
		return false;
	}
	*/
	
	var DT_END = this.fnGetDtEnd();								// 이용종료일 (시작일로 1박~~~ 계산해서 받아옴)
	var nDateRange = this.gfnGetDiffDate(DT_START, DT_END);		// 두 일자간의 차이 일수 계산
	switch(this.divData.form.tabData.tabindex) {
		case 0:
			// 휴가지원----------------------------------------------------------------------------------------------------------------
			var DS_R_RELATION = this.dsList.getColumn(0, "DS_R_RELATION");	// 휴가지원_관계
			var DS_R_RESERVE = this.dsList.getColumn(0, "DS_R_RESERVE");	// 휴가지원_예약자
			var NO_R_RESERVE = this.dsList.getColumn(0, "NO_R_RESERVE");	// 휴가지원_예약번호
			var TY_R_ROOM = this.dsList.getColumn(0, "TY_R_ROOM");			// 휴가지원_객실타입
			var CT_R_ROOM = this.dsList.getColumn(0, "CT_R_ROOM");			// 휴가지원_객실수

			/*
			if( (!this.gfnIsNull(NO_R_RESERVE) && this.gfnIsNull(TY_R_ROOM)) || (this.gfnIsNull(NO_R_RESERVE) && !this.gfnIsNull(TY_R_ROOM)) || 
				(this.gfnIsNull(NO_R_RESERVE) && !this.gfnIsNull(DS_R_RESERVE)) || (!this.gfnIsNull(NO_R_RESERVE) && this.gfnIsNull(DS_R_RESERVE))	){
				strMsg += "객실이용내역 입력이 완료되지 않았습니다.\n";
			}
			*/
			
			if( (!this.gfnIsNull(DS_R_RELATION) || !this.gfnIsNull(DS_R_RESERVE) || !this.gfnIsNull(NO_R_RESERVE) || !this.gfnIsNull(TY_R_ROOM) || !this.gfnIsNull(CT_R_ROOM)) &&
				(this.gfnIsNull(DS_R_RELATION) || this.gfnIsNull(DS_R_RESERVE) || this.gfnIsNull(NO_R_RESERVE) || this.gfnIsNull(TY_R_ROOM) || this.gfnIsNull(CT_R_ROOM)) ) {
				strMsg += "객실이용내역 입력이 완료되지 않았습니다.\n";
			}	
			

			/*  [OO]레저사업장구분
					10:제주부영호텔리조트 / 20:무주덕유산리조트 / 30:오투리조트 /40:제주부영CC
					50:순천부영CC / 60:나주부영CC / 70:더클래식CC / 80:마에스트로CC / 90:바디스타
			*/
			if ( (CD_LEISURE == "40" || CD_LEISURE == "50" || CD_LEISURE == "60" || CD_LEISURE == "80") && nDateRange > 5 && !this.gfnIsNull(TY_R_ROOM)){
				strMsg += "골프사업장 객실이용은 최대 5일을 초과할 수 없습니다.\n";
			}	

			if ( CD_LEISURE == "20" && nDateRange > 4 && !this.gfnIsNull(TY_R_ROOM)){
				strMsg += "무주덕유산리조트 휴가할인지원은 한번에 최대 4박(성수기2박)까지 신청 가능합니다.\n";
			}

			var DS_G_RELATION1 = this.dsList.getColumn(0, "DS_G_RELATION1");// 골프_관계1
			var DS_G_USER1 = this.dsList.getColumn(0, "DS_G_USER1");		// 골프_사용자1
			//var DT_G_USE1 = this.dsList.getColumn(0, "DT_G_USE1");			// 골프_이용일자1
			var DT_G_USE1 = (!this.gfnIsNull(this.dsList.getColumn(0, "DS_G_USER1"))) ? DT_START : "";
			var DS_G_TEE_OFF1 = this.dsList.getColumn(0, "DS_G_TEE_OFF1");	// 골프_티오프시간1
			var DS_G_INSERT1 = this.dsList.getColumn(0, "DS_G_INSERT1");	// 골프_예약자1

			var DS_G_RELATION2 = this.dsList.getColumn(0, "DS_G_RELATION2");// 골프_관계2
			var DS_G_USER2 = this.dsList.getColumn(0, "DS_G_USER2");		// 골프_사용자2
			//var DT_G_USE2 = this.dsList.getColumn(0, "DT_G_USE2");			// 골프_이용일자2
			var DT_G_USE2 = (!this.gfnIsNull(this.dsList.getColumn(0, "DS_G_USER2"))) ? DT_START : "";
			var DS_G_TEE_OFF2 = this.dsList.getColumn(0, "DS_G_TEE_OFF2");	// 골프_티오프시간2
			var DS_G_INSERT2 = this.dsList.getColumn(0, "DS_G_INSERT2");	// 골프_예약자2

			if( (!this.gfnIsNull(DS_G_RELATION1) || !this.gfnIsNull(DS_G_USER1) || !this.gfnIsNull(DT_G_USE1) || !this.gfnIsNull(DS_G_INSERT1) || !this.gfnIsNull(DS_G_TEE_OFF1)) &&
				(this.gfnIsNull(DS_G_RELATION1) || this.gfnIsNull(DS_G_USER1) || this.gfnIsNull(DT_G_USE1) || this.gfnIsNull(DS_G_INSERT1) || this.gfnIsNull(DS_G_TEE_OFF1)) ) {
				strMsg += "골프이용내역 1번 라인의 입력이 완료되지 않았습니다.\n";
			}

			if( (!this.gfnIsNull(DS_G_RELATION2) || !this.gfnIsNull(DS_G_USER2) || !this.gfnIsNull(DT_G_USE2) || !this.gfnIsNull(DS_G_INSERT2) || !this.gfnIsNull(DS_G_TEE_OFF2)) &&
				(this.gfnIsNull(DS_G_RELATION2) || this.gfnIsNull(DS_G_USER2) || this.gfnIsNull(DT_G_USE2) || this.gfnIsNull(DS_G_INSERT2) || this.gfnIsNull(DS_G_TEE_OFF2)) ) {
				strMsg += "골프이용내역 2번 라인의 입력이 완료되지 않았습니다.\n";
			}

			/*
			if( (!this.gfnIsNull(DT_G_USE1) && DT_G_USE1 != DT_START) || ( !this.gfnIsNull(DT_G_USE2) && DT_G_USE2 != DT_START) ){
				strMsg += "골프 이용일자는 상단 입력한 이용기간 내에만 가능합니다.\n";
			}
			
			if( !this.gfnIsNull(DT_G_USE1) && !this.gfnIsNull(DT_G_USE2) && DT_G_USE1 != DT_G_USE2 ){
				strMsg += "2건의 골프 이용시 이용일자는 2건이 동일하여야 합니다.\n";
			}
			*/
			
			if( CD_LEISURE == "10" && ( !this.gfnIsNull(DS_G_USER1) || !this.gfnIsNull(DT_G_USE1) || !this.gfnIsNull(DS_G_USER2) || !this.gfnIsNull(DT_G_USE2)) ){
				strMsg += "제주부영호텔리조트는 골프이용이 불가합니다.\n";
			}

			break;

		case 1:
			// 추천할인 ----------------------------------------------------------------------------------------------------------------

			var TY_A_SALE = this.dsList.getColumn(0, "TY_A_SALE");	// 1:임직원본인할인 / 2:임직원추천할인
			var NO_A_RESERVE = this.dsList.getColumn(0, "NO_A_RESERVE");	// 추천_예약번호
			var DS_A_USER = this.dsList.getColumn(0, "DS_A_USER");			// 추천_실사용자
			var DS_A_PHONE = this.dsList.getColumn(0, "DS_A_PHONE");		// 추천_연락처
			var DS_A_RELATION = this.dsList.getColumn(0, "DS_A_RELATION");	// 추천_관계
			var TY_A_ROOM = this.dsList.getColumn(0, "TY_A_ROOM");			// 추천_객실타입
			var CT_A_ROOM = this.dsList.getColumn(0, "CT_A_ROOM");			// 추천_객실수	
			/*  [OO]레저사업장구분
					10:제주부영호텔리조트 / 20:무주덕유산리조트 / 30:오투리조트 /40:제주부영CC
					50:순천부영CC / 60:나주부영CC / 70:더클래식CC / 80:마에스트로CC / 90:바디스타
			*/
			if ( TY_A_SALE == "2" && (CD_LEISURE == "20" || CD_LEISURE == "40" || CD_LEISURE == "50" || CD_LEISURE == "60" )){			
				strMsg += "[임직원 추천 할인]은 제주부영호텔리조트, 오투리조트, 마에스트로CC만 가능합니다.\n";
			}
			
			if ( TY_A_SALE == "2" && this.gfnIsNull(DS_A_USER)){
				strMsg += "[임직원 추천 할인]은 실사용자 입력이 필수 사항입니다.\n";
			}

			if ( (!this.gfnIsNull(TY_A_SALE) || !this.gfnIsNull(NO_A_RESERVE) || !this.gfnIsNull(DS_A_PHONE) || !this.gfnIsNull(DS_A_RELATION) || !this.gfnIsNull(TY_A_ROOM) || !this.gfnIsNull(CT_A_ROOM)) &&
				 (this.gfnIsNull(TY_A_SALE) || this.gfnIsNull(NO_A_RESERVE) || this.gfnIsNull(DS_A_PHONE) || this.gfnIsNull(DS_A_RELATION) || this.gfnIsNull(TY_A_ROOM) || this.gfnIsNull(CT_A_ROOM)) ){
				strMsg += "직원(추천)할인 입력이 완료되지 않았습니다.\n";
			}

			break;
		case 2:

			// 무주쿠폰 ----------------------------------------------------------------------------------------------------------------
			var nReserveCnt = 0;
			var NO_B_RESERVE1 = this.dsList.getColumn(0, "NO_B_RESERVE1");	// 무주_예약번호1
			var NO_B_RESERVE2 = this.dsList.getColumn(0, "NO_B_RESERVE2");	// 무주_예약번호2
			var NO_B_RESERVE3 = this.dsList.getColumn(0, "NO_B_RESERVE3");	// 무주_예약번호3
			var NO_B_RESERVE4 = this.dsList.getColumn(0, "NO_B_RESERVE4");	// 무주_예약번호4			
			var TY_B_ROOM1 = this.dsList.getColumn(0, "TY_B_ROOM1");	// 무주_객실타입1
			var TY_B_ROOM2 = this.dsList.getColumn(0, "TY_B_ROOM2");	// 무주_객실타입2
			var TY_B_ROOM3 = this.dsList.getColumn(0, "TY_B_ROOM3");	// 무주_객실타입3
			var TY_B_ROOM4 = this.dsList.getColumn(0, "TY_B_ROOM4");	// 무주_객실타입4

			if( (!this.gfnIsNull(NO_B_RESERVE1) || !this.gfnIsNull(TY_B_ROOM1)) && (this.gfnIsNull(NO_B_RESERVE1) || this.gfnIsNull(TY_B_ROOM1)) ) {
				strMsg += "무주쿠폰 1번 라인의 입력이 완료되지 않았습니다.\n";
			}
			
			if( (!this.gfnIsNull(NO_B_RESERVE2) || !this.gfnIsNull(TY_B_ROOM2)) && (this.gfnIsNull(NO_B_RESERVE2) || this.gfnIsNull(TY_B_ROOM2)) ) {
				strMsg += "무주쿠폰 2번 라인의 입력이 완료되지 않았습니다.\n";
			}
			
			if( (!this.gfnIsNull(NO_B_RESERVE3) || !this.gfnIsNull(TY_B_ROOM3)) && (this.gfnIsNull(NO_B_RESERVE3) || this.gfnIsNull(TY_B_ROOM3)) ) {
				strMsg += "무주쿠폰 3번 라인의 입력이 완료되지 않았습니다.\n";
			}
			
			if( (!this.gfnIsNull(NO_B_RESERVE4) || !this.gfnIsNull(TY_B_ROOM4)) && (this.gfnIsNull(NO_B_RESERVE4) || this.gfnIsNull(TY_B_ROOM4)) ) {
				strMsg += "무주쿠폰 4번 라인의 입력이 완료되지 않았습니다.\n";
			}
			
			if( !this.gfnIsNull(NO_B_RESERVE1) || !this.gfnIsNull(TY_B_ROOM1)) nReserveCnt++;
			if( !this.gfnIsNull(NO_B_RESERVE2) || !this.gfnIsNull(TY_B_ROOM2)) nReserveCnt++;
			if( !this.gfnIsNull(NO_B_RESERVE3) || !this.gfnIsNull(TY_B_ROOM3)) nReserveCnt++;
			if( !this.gfnIsNull(NO_B_RESERVE4) || !this.gfnIsNull(TY_B_ROOM4)) nReserveCnt++;
			
			//예약번호 1개만 입력시 1박으로 수정되어 저장됨 -> 박수와 예약번호 수량 불일치시 저장 안되도
			if(DS_R_DAYS == "5박" || DS_R_DAYS == "6박" || DS_R_DAYS == "7박" || DS_R_DAYS == "골프"){
				strMsg += "무주쿠폰 이용 박수는 1박~4박 입력 가능합니다..\n";
			}
			
			if(nReserveCnt != DS_R_DAYS.substr(0,1)){
				strMsg += "무주쿠폰 이용 박수와 예약번호 수량이 일치하지 않습니다.\n";
			}
			
			break;
		case 3:
			break;
	}

	if(strMsg.length > 0) {
		this.gfnAlert(strMsg);
		return false;
	}

	return true;
};

/************************************************************************
 * 콜백 이벤트
 ************************************************************************/
/*
 *	콜백 처리
 */
this.fnCallback = function(svcID, errorCode, errorMsg)
{
	if (svcID == "selectPoint") {
	}

	if (svcID == "select") {
		var TY_LEISURE = this.dsList.getColumn(0, "TY_LEISURE");
		var CD_LEISURE = this.dsList.getColumn(0, "CD_LEISURE");
		var DS_G_USER1 = this.dsList.getColumn(0, "DS_G_USER1");
		var DS_G_USER2 = this.dsList.getColumn(0, "DS_G_USER2");
		var DS_R_DAYS = this.dsList.getColumn(0, "DS_R_DAYS");
		var DS_A_DAYS = this.dsList.getColumn(0, "DS_A_DAYS");
		
		var DS_LEISURE = this.dsList.getColumn(0, "DS_LEISURE");
		var DT_START = this.dsList.getColumn(0, "DT_START");
		var NO_A_RESERVE = this.dsList.getColumn(0, "NO_A_RESERVE");

		var NO_B_RESERVE1 = this.dsList.getColumn(0, "NO_B_RESERVE1");	// 무주_예약번호1
		var NO_B_RESERVE2 = this.dsList.getColumn(0, "NO_B_RESERVE2");	// 무주_예약번호2
		var NO_B_RESERVE3 = this.dsList.getColumn(0, "NO_B_RESERVE3");	// 무주_예약번호3
		var NO_B_RESERVE4 = this.dsList.getColumn(0, "NO_B_RESERVE4");	// 무주_예약번호4

		if(TY_LEISURE == "1"){	// 휴가지원
			if(!this.gfnIsNull(DS_G_USER1) || !this.gfnIsNull(DS_G_USER1)){
				DS_R_DAYS = "골프";
			}
		}
		
		if(TY_LEISURE == "2" && !this.gfnIsNull(NO_A_RESERVE)){	// 직원(추천)할인
			DS_R_DAYS = DS_A_DAYS;
		}
		
		if(TY_LEISURE == "3"){	// 무주쿠폰
			var CT_DAYS = 0;
			 if(!this.gfnIsNull(NO_B_RESERVE1))	CT_DAYS++;
			 if(!this.gfnIsNull(NO_B_RESERVE2))	CT_DAYS++;
			 if(!this.gfnIsNull(NO_B_RESERVE3))	CT_DAYS++;
			 if(!this.gfnIsNull(NO_B_RESERVE4))	CT_DAYS++;		 
			if(CT_DAYS > 0){
				DS_R_DAYS = CT_DAYS + "박";
			}
		}

		this.dsSearch.setColumn( 0, "CD_LEISURE", CD_LEISURE);
		this.dsSearch.setColumn( 0, "DS_LEISURE", DS_LEISURE);
		this.dsSearch.setColumn( 0, "TY_LEISURE", TY_LEISURE);
		this.dsSearch.setColumn( 0, "DS_R_DAYS", DS_R_DAYS);

		// DataSet 에서 이벤트가 발생하지 않도록 설정합니다.
		this.dsSearch.set_enableevent(false);
		
		this.dsSearch.setColumn( 0, "DT_START", DT_START);	// 검색조건 변경하면 dsList에 자동셋팅
		
		// DataSet 에서 이벤트가 발생하도록 설정합니다.
		this.dsSearch.set_enableevent(true);

		if(DS_LEISURE == "바디스타")	this.dxTab.set_visible(false);	// 텝숨기기
		// this.dxTab.set_tabindex(0);

		// 검색조건 비활성화
		var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
		var benable = (TY_APPROVE == "Y") ?  true : false;
		this.fnSetReadonlySearch(benable);
		//this.dxTab.set_enable(!benable);
	}

	if (svcID == "combo") {
		// 초기 셋팅 ID_PERSON, NO_SEQ 값있으면 조회
		this.fnReset();
	}

	if(svcID == "insert" || svcID == "save"){
		if (errorCode == 0) {
			var RESULT_MSG = this.dsResult.getColumn( 0, "RESULT_MSG");
			var NO_SEQ = this.dsResult.getColumn( 0, "NO_SEQ");
			var ID_PERSON = this.dsResult.getColumn( 0, "ID_PERSON");
			
			if(!this.gfnIsNull(RESULT_MSG)){
				this.gfnAlert(RESULT_MSG);
			}else{
				this.getParentContext().close(true);
			}
			/*
			else{
				this.gfnAlert("작업이 완료되었습니다.");
			}
			*/

			/*
			// 작업완료 재조회
			this.gIdPerson = ID_PERSON;
			this.gNoSeq = NO_SEQ;
			this.gTySave = "U";

			this.FormBtns.Select.click();
			this.fnSelectPoint();
			*/
			
			
			
		} else {
			this.gfnAlert(errorMsg);
		}
	}

	this.fnSetButton();
}

/************************************************************************
 * 코드파인드 이벤트
 ************************************************************************/
this.fnBeforeUserDataSetParam = function(id, dsUserParam, nrow) {
	//trace("코드파인드 id:"+id);
	switch(id) {
		case "ccfCD_LEISURE":
			dsUserParam.setColumn(nrow, "CD_PREFIX", "OO");
			
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
			if((!this.gfnIsNull(CD_LEISURE) && this.gfnIsUpdatedRow(this.dsList, 0)) || this.gTySave == "U" ){			
				   var rtnConfirm = confirm("저장되지 않은 정보가 있습니다.\n 계속하시겠습니까?");
				   return this.fnBeforeCDTextChanged(rtnConfirm);
			}else{
				return true;
			}

			break;

		case "ccfTY_R_ROOM":
		case "ccfTY_A_ROOM":
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			if (this.gfnIsNull(this.gfnTrim(CD_LEISURE))) {
				this.gfnAlert("이용사업장을 먼저 선택하세요");
				return;
			}
			var TY_GUBUN = "A";	// 휴가지원
			if(id == "ccfTY_A_ROOM"){
				TY_GUBUN = "B";	// 직원추천
			}
			// DAXPR_LEISURE_ROOMTYPE_CODEFIND
			dsUserParam.setColumn(nrow, "TY_GUBUN", TY_GUBUN);	// 객실구분(A:본인할인, B:직원소개추천)
			dsUserParam.setColumn(nrow, "CD_LEISURE", CD_LEISURE);

			return true;
			
			break;

		default:
	}

	//return true;
};

this.fnBeforeCDTextChanged = function(val) {
	var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
	var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
	if(val){
		this.dsList.clearData();
		var nRow = this.dsList.addRow();
		this.dsList.updatecontrol = false;
		this.dsList.setColumn(nRow, "TY_A_SALE", "1");	// RADIO 1:임직원본인할인 / 2:임직원추천할인 
		var bSucc = this.dsList.setRowType(0, Dataset.ROWTYPE_NORMAL);	// 1 초기 행의 상태 2추가 4수정 8삭제
		this.dsList.updatecontrol = true;
		return true;

	}else{
		if(DS_LEISURE == "바디스타"){
			this.dxTab.set_visible(true);
		}
	
		if(this.gTySave == "U"  && !this.gfnIsNull(this.gNoSeq) && !this.gfnIsNull(this.gIdPerson)) {
			this.FormBtns.Select.click(true);
		}		
		
		return false;
		//this.divData.form.tabData.set_enableevent(false);
		//this.divData.form.tabData.set_tabindex(e.preindex);
		//this.divData.form.tabData.set_enableevent(true);
	}
}

this.fnAfterCDTextChanged = function(id, codeFindData) {
	var arr = codeFindData; 
	switch(id){
		case "ccfCD_LEISURE" :
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
			var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");
			
			// 객실_박수 셋팅 (골프, 1박, 2박, 3박, 4박, 5박, 6박, 7박,6개월, 1년 /  - 6개월, 1년 )
			this.fnSetCboDsDays();

			var bVisible = true;
			if(DS_LEISURE == "바디스타"){
				bVisible = false;
				this.FormBtns.Save.set_enable(true);
			}else{
				this.FormBtns.Save.set_enable(false);
			}

			this.dxTab.set_visible(bVisible);

		break;
	}
}

/************************************************************************
 * 그리드 이벤트
 ************************************************************************/
this.fnGrid_BeforeUserDataSetParam = function(id, dsUserParam, nrow){
	//trace('grid_코드파인드_식별id: ' + id); 
	
	switch(id) {
		case "ID_SABUN":     // 사번,부서,법인	ID_SABUN	DAX_CFBASEINFO
			dsUserParam.setColumn(nrow, "GR_SEARCH", this.FormInfo.GR_SEARCH);
			dsUserParam.setColumn(nrow, "CD_DEPT", "%");		 
			dsUserParam.setColumn(nrow, "TY_RETIRE", "%");			
		break;		

		case "CD_CONTACT":	//관계코드(FA)	CD_CONTACT	DAX_CFCOMMONCODE_FA
			 dsUserParam.setColumn(nrow, "CD_PREFIX", 'FA'); // 관계코드
		break;		

		default:
	}	
	return true;	
	
};

/************************************************************************
 * 기타 이벤트
 ************************************************************************/
/*
 *	조회 조건 변경시 초기화
 */
this.fnSearchInit = function(obj,e) {
	if(e == null || (e.pretext != e.posttext)) {
		//this.gfnSetFormStatus(this);
		//this.gfnGridClear(this.dxGrid2);
	}
};

this.fnSetCombo = function() {

	// 관계
	this.dsCombo1 = new Dataset();
	this.dsCombo1.addColumn("TY_SEL", "string");
	//this.dsCombo1.addColumn("ID_USER", "string");
	this.dsCombo1.addColumn("ID_PERSON", "bigdecimal");
	this.dsCombo1.addColumn("DS_HNAME", "string");
	var ID_USER = this.AuthClient.ID_USER;
	var ID_PERSON = this.AuthClient.ID_PERSON;
	
	//ID_USER = "1008";	// for test
	
	this.dsCombo1.clearData();
	this.dsCombo1.addRow();

	this.dsCombo1.setColumn(0, "TY_SEL", "A");
	this.dsCombo1.setColumn(0, "ID_PERSON", ID_PERSON);
	this.dsCombo1.setColumn(0, "DS_HNAME", this.AuthClient.DS_HNAME);

	// [OC]무주쿠폰구분
	this.dsCombo = new Dataset();
	this.dsCombo.addColumn("TY_SEL", "string");
	this.dsCombo.addColumn("CD_PREFIX", "string");
	this.dsCombo.addColumn("CD_UPPREFIX", "string");

	this.dsCombo.clearData();
	this.dsCombo.addRow();

	this.dsCombo.setColumn(0, "TY_SEL", "P");
	this.dsCombo.setColumn(0, "CD_PREFIX", "OC");
	this.dsCombo.setColumn(0, "CD_UPPREFIX", "");

	var strSvcId    = "combo";
	var strSvcType  = "select";
	var inProc		= "_dsProc";
	var inData      = "comboRelation=dsCombo1 combo=dsCombo";
	var outData     = "dsDS_RELATION=comboRelation0 dsTY_B_ROOM=combo0";
	
	var strArg      = "";
	var callBackFnc = "fnCallback";

	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
};

// 이용시작 종료일
this.fnGetDtEnd = function(){
	var DT_END = this.dsSearch.getColumn(0, "DT_START");		// 이용종료일
	var DT_START = this.dsSearch.getColumn(0, "DT_START");		// 이용시작일
	var DS_R_DAYS = this.dsSearch.getColumn(0, "DS_R_DAYS");	// 객실_박수
	var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");	// 레저구분(1휴가지원/2직원할인/3무주쿠폰)
	var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
	var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");

	/*  [OO]레저사업장구분
		10:제주부영호텔리조트 / 20:무주덕유산리조트 / 30:오투리조트 /40:제주부영CC
		50:순천부영CC / 60:나주부영CC / 70:더클래식CC / 80:마에스트로CC / 90:바디스타
	*/

	if(this.gfnIsNull(CD_LEISURE)) {
		this.gfnAlert("이용 사업장은 반드시 입력 하셔야 합니다");
		return;
	}

	if(this.gfnIsNull(DT_START)) {
		this.gfnAlert("이용 시작일은 반드시 입력 하셔야 합니다");
		return;
	}

	if(!this.gfnIsNull(DS_R_DAYS) && !this.gfnIsNull(DT_START)) {
		if(DS_LEISURE == "바디스타"){
			// 입력된 월에 OffSet 으로 지정된 만큼의 월을 더함
			var nOffSet = (DS_R_DAYS == "6개월") ? 6 : 12;
			DT_END = this.gfnAddMonth(DT_START, nOffSet);
			return DT_END;
		}
		
		if(DS_R_DAYS != "골프"){

			var nOffSet = 0;
			var pattern = /[^(0-9)]/gi;   // 숫자이외는 제거
			if(pattern.test(DS_R_DAYS)){
				nOffSet = DS_R_DAYS.replace(pattern,"");
			}
			// 입력된 날짜에 OffSet 으로 지정된 만큼의 날짜를 더함
			DT_END = this.gfnAddDate(DT_START, nOffSet);
		}
	}

	return DT_END;
}

// 기간설정
this.fnPeriodSetting = function(obj:nexacro.Button,e:nexacro.ClickEventInfo) {
	// TODO 기간설정 기능 추가
	//if(!this.gfnGridIsRow(this.dxGrid)) return;
	var param = {};
	//param.NO_ACCOUNT = this.dsList0.getColumn(this.dsList0.rowposition,"NO_ACCOUNT");
	this.gfnFormOpen(this.FormInfo.CD_MODULE, "DAB_TUITION_PERIOD", "", param, this.getOffsetWidth(), this.getOffsetHeight());
}

this.dsSearch_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
	if(e.oldvalue != e.newvalue) {

	//trace("dsSearch_onvaluechanged" + "   e.columnid->" + e.columnid
	//+ "   e.oldvalue->" + e.oldvalue 	+ "   e.newvalue->" + e.newvalue);

		var tidx = this.divData.form.tabData.tabindex;
		if( e.columnid == "TY_LEISURE" ){
			// 이용구분- 1:휴가지원 / 2:직원(추천)할인 / 3:무주쿠폰
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
			var nIndex = (e.newvalue == "1") ? 0 :  ((e.newvalue == "2") ? 1 : 2);
			this.dxTab.set_tabindex(nIndex);
			if(e.newvalue == "3"){	// 무주쿠폰
				 // [OO]레저사업장구분 20:무주덕유산리조트
				if(CD_LEISURE != "20" && TY_APPROVE != "Y"){
					if( this.gfnIsUpdatedRow(this.dsList, 0) == false){
						this.ccfCD_LEISURE.form.CDTextBox.set_value("20");
						this.ccfCD_LEISURE.form.CDTextBox_onchanged();
					}
				}
				// 사업장 변경불가
				this.ccfCD_LEISURE.set_enable(false);
			}else{
				// 사업장 변경불가
				bReadOnly = (TY_APPROVE == "Y") ?  false : true;
				this.ccfCD_LEISURE.set_enable(bReadOnly);
			}

			// 객실_박수 셋팅 (골프, 1박, 2박, 3박, 4박, 5박, 6박, 7박,6개월, 1년 /  - 6개월, 1년 )
			this.fnSetCboDsDays();
		}
		
		if( e.columnid == "DT_START" ){
			if(this.gTySave == "U" ){
				this.dsList.setColumn( 0, "DT_START",  e.newvalue);	// 검색조건 변경하면 dsList에 자동셋팅
			}
		}

		if( e.columnid == "DS_R_DAYS" ){
			var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			if(DS_LEISURE == "바디스타" ) return;
			
			this.fnSetReadonlyByTab(true);
		}
		//this.gfnSetFormStatus(this);	// 폼상태 초기화
		this.fnSetButton();
	}
};

this.fnSetReadonlyByTab = function(bReadOnly){
	var nTabIdx = this.divData.form.tabData.tabindex;

	var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
	bReadOnly = (TY_APPROVE == "Y") ?  true : false;
	
	//trace("[fnSetReadonlyByTab] " + "nTabIdx->" + nTabIdx + " \n bReadOnly->" + bReadOnly);
	
	if(nTabIdx == 0){
		this.fnSetReadonlyResort(bReadOnly);
		this.fnSetReadonlyGolf(bReadOnly);
	}

	if(nTabIdx == 1){
		this.rdoTY_A_SALE.set_readonly(bReadOnly);
		this.edtNO_A_RESERVE.set_readonly(bReadOnly);
		this.edtDS_A_USER.set_readonly(bReadOnly);
		this.edtDS_A_PHONE.set_readonly(bReadOnly);
		this.edtDS_A_RELATION.set_readonly(bReadOnly);
		this.ccfTY_A_ROOM.set_enable(!bReadOnly);
		this.cboCT_A_ROOM.set_readonly(bReadOnly);
	}

	if(nTabIdx == 2){
		// 무주쿠폰은 수정안됨
		var NO_B_RESERVE1 = this.dsList.getColumn(0, "NO_B_RESERVE1");	// 무주_예약번호1
		var NO_B_RESERVE2 = this.dsList.getColumn(0, "NO_B_RESERVE2");	// 무주_예약번호2
		var NO_B_RESERVE3 = this.dsList.getColumn(0, "NO_B_RESERVE3");	// 무주_예약번호3
		var NO_B_RESERVE4 = this.dsList.getColumn(0, "NO_B_RESERVE4");	// 무주_예약번호4
		var bExist = (!this.gfnIsNull(NO_B_RESERVE1) || !this.gfnIsNull(NO_B_RESERVE2) || !this.gfnIsNull(NO_B_RESERVE3) || !this.gfnIsNull(NO_B_RESERVE4));
		bReadOnly = (TY_APPROVE == "Y" || (this.gTySave == "U" && bExist) ) ? true : false;

		this.edtNO_B_RESERVE1.set_readonly(bReadOnly);
		this.edtNO_B_RESERVE2.set_readonly(bReadOnly);
		this.edtNO_B_RESERVE3.set_readonly(bReadOnly);
		this.edtNO_B_RESERVE4.set_readonly(bReadOnly);
		this.cboTY_B_ROOM1.set_readonly(bReadOnly);
		this.cboTY_B_ROOM2.set_readonly(bReadOnly);
		this.cboTY_B_ROOM3.set_readonly(bReadOnly);
		this.cboTY_B_ROOM4.set_readonly(bReadOnly);
	}
}

// Tab 1 휴가지원 비/활성화 (객실이용내역)
this.fnSetReadonlyResort = function(bReadOnly){
	var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
	var DS_R_DAYS = this.dsSearch.getColumn(0, "DS_R_DAYS");
	if(TY_APPROVE == "N" && !this.gfnIsNull(DS_R_DAYS)) {
		bReadOnly = (DS_R_DAYS == "골프") ? true : false;
	}

	this.cboDS_R_RELATION.set_readonly(bReadOnly);
	//this.edtDS_R_RESERVE.set_readonly(bReadOnly);	// 관계 콤보에서 선택해서 입력
	this.edtNO_R_RESERVE.set_readonly(bReadOnly);
	this.ccfTY_R_ROOM.set_enable(!bReadOnly);
	this.cboCT_R_ROOM.set_readonly(bReadOnly);
}

// Tab 1  휴가지원 비/활성화 (골프이용내역)
this.fnSetReadonlyGolf = function(bReadOnly){
	var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
	var DS_R_DAYS = this.dsSearch.getColumn(0, "DS_R_DAYS");
	if(TY_APPROVE == "N" && !this.gfnIsNull(DS_R_DAYS)) {
		bReadOnly = (DS_R_DAYS == "골프") ? false : true;
	}

	this.cboDS_G_RELATION1.set_readonly(bReadOnly);
	this.cboDS_G_RELATION2.set_readonly(bReadOnly);
	//this.edtDS_G_USER1.set_readonly(bReadOnly);	// 관계 콤보에서 선택해서 입력
	//this.edtDS_G_USER2.set_readonly(bReadOnly);	// 관계 콤보에서 선택해서 입력
	//this.ctclDT_G_USE1.set_readonly(bReadOnly);	// 검색조건 이용시작일 사용함
	//this.ctclDT_G_USE2.set_readonly(bReadOnly);
	this.edtDS_G_TEE_OFF1.set_readonly(bReadOnly);
	this.edtDS_G_TEE_OFF2.set_readonly(bReadOnly);
	this.edtDS_G_INSERT1.set_readonly(bReadOnly);
	this.edtDS_G_INSERT2.set_readonly(bReadOnly);
}

// 검색조건 비활성화
this.fnSetReadonlySearch = function(bReadOnly){
	this.ccfCD_LEISURE.set_enable(!bReadOnly);
	this.ccboTY_LEISURE.set_readonly(bReadOnly);
	this.calDT_START.set_readonly(bReadOnly);
	this.calDT_END.set_readonly(bReadOnly);
	this.ccboDS_R_DAYS.set_readonly(bReadOnly);
	
	var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");
	if(TY_LEISURE == "3"){	//무주쿠폰
		this.ccfCD_LEISURE.set_enable(false);
	}
}

// 객실_박수 셋팅 (골프, 1박, 2박, 3박, 4박, 5박, 6박, 7박,6개월, 1년 /  - 6개월, 1년 )
this.fnSetCboDsDays = function(){
	var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
	var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
	var TY_LEISURE = this.dsSearch.getColumn(0, "TY_LEISURE");

	//trace("객실_박수 셋팅 TY_LEISURE->" + TY_LEISURE+ "   CD_LEISURE->" + CD_LEISURE);

	this.ccboDS_R_DAYS.set_readonly(true);
	this.ccboDS_R_DAYS.set_index(-1);

	var bVisible = true;
	if (!this.gfnIsNull(this.gfnTrim(CD_LEISURE))) {

		var strFilterExpr = (DS_LEISURE == "바디스타") ? "B" : "R";	// (R:리조트 G골프 B바디스타)	
		//trace("CD_LEISURE->" + CD_LEISURE+ " \n DS_LEISURE->" + DS_LEISURE+ " \n strFilterExpr->" + strFilterExpr);
		this.dsDS_R_DAYS.filter("");
		this.dsDS_R_DAYS.filter("DS_CODE == '" + strFilterExpr + "'");

		// 객실_박수 (골프, 1박, 2박, 3박, 4박, 5박, 6박, 7박,6개월, 1년 /  - 6개월, 1년 )
		var TY_APPROVE = this.gfnNvl(this.dsList.getColumn(0, "TY_APPROVE"), "N");	// 승인상태(N:결재중 , Y:승인완료)
		var bReadOnly = (TY_APPROVE == "Y") ?  true : false;
		this.ccboDS_R_DAYS.set_readonly(bReadOnly);
		/*
		if(TY_LEISURE != "1" && CD_LEISURE != "90"){	// 20:무주덕유산리조트 1무주쿠폰
			this.ccboDS_R_DAYS.set_index(1);	// 1박
		}else{
			this.ccboDS_R_DAYS.set_index(0);
		}
		*/
		if(CD_LEISURE == "90"){	// 바디스타
			this.ccboDS_R_DAYS.set_index(0);
		}else{
			this.ccboDS_R_DAYS.set_index(1);
		}		
	}
}

this.divData_tabData_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo)
{
	//trace("텝 변경 divData_tabData_onchanged->" + e.postindex);	
	// 탭 변경시 조회처리시
 	if(e.preindex != e.postindex) {

		this.dxTab = this.divData.form.tabData;
		var tabIdx = this.dxTab.tabindex;
		if(this.gfnIsUpdatedRow(this.dsList, 0)){
			this.fnDsUpdateCallback = function(id, val){
				if(val){
					this.dsList.clearData();	
					var nRow = this.dsList.addRow();
					this.dsList.updatecontrol = false;
					this.dsList.setColumn(nRow, "TY_A_SALE", "1");	// RADIO 1:임직원본인할인 / 2:임직원추천할인 
					var bSucc = this.dsList.setRowType(0, Dataset.ROWTYPE_NORMAL);	// 1 초기 행의 상태 2추가 4수정 8삭제
					this.dsList.updatecontrol = true;
				}else{
					this.divData.form.tabData.set_enableevent(false);
					this.divData.form.tabData.set_tabindex(e.preindex);
					this.divData.form.tabData.set_enableevent(true);

					var TY_LEISURE = (e.preindex == 0) ? "1" : (e.preindex == 1) ? "2" : "3";
					this.dsSearch.setColumn(0, "TY_LEISURE", TY_LEISURE );
					this.fnSetReadonlyByTab(true);	
				}
			}
			this.gfnConfirm("저장되지 않은 정보가 있습니다.\n 계속하시겠습니까?","fnDsUpdateCallback");
		}

		// 이용구분- 1:휴가지원 / 2:직원(추천)할인 / 3:무주쿠폰
		var TY_LEISURE = (e.postindex == 0) ? "1" : (e.postindex == 1) ? "2" : "3";
		this.dsSearch.setColumn(0, "TY_LEISURE", TY_LEISURE );
		
		this.fnSetReadonlyByTab(true);	
	}
};

this.dsList_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{

	if(e.oldvalue != e.newvalue) {
		
		var nRowType = obj.getRowType(e.row);
		var status = this.gfnGetFormStatus(this);
		if( nRowType == Dataset.ROWTYPE_INSERT || nRowType == Dataset.ROWTYPE_UPDATE || nRowType == Dataset.ROWTYPE_DELETE ){
			this.FormBtns.Save.set_enable(true);
		} else if( nRowType == Dataset.ROWTYPE_NORMAL ){
			this.FormBtns.Save.set_enable(false);
		}
		
		// 텝1 - 관계
		if (e.columnid == "DS_R_RELATION" || e.columnid == "DS_G_RELATION1" || e.columnid == "DS_G_RELATION2") {
			var DS_R_RESERVE = this.dsDS_RELATION.lookup( "CD_CODE", e.newvalue, "DS_CODE" );
			var sColNm = "DS_R_RESERVE";
			if(e.columnid == "DS_G_RELATION1"){
				sColNm = "DS_G_USER1";
			}
			if(e.columnid == "DS_G_RELATION2"){
				sColNm = "DS_G_USER2";
			}

			if (!this.gfnIsNull(this.gfnTrim(DS_R_RESERVE))) {
				this.dsList.setColumn(0, sColNm, DS_R_RESERVE);
			}else{
				this.gfnAlert("가족관계 배우자 정보가 등록된 경우에만 이용 가능합니다.");
				this.dsList.setColumn(0, sColNm, "");
			}
		}
	}
	this.fnSetButton();
};

// 객실별 정보 안내 팝업
this.divSearch_btnLeisureRoomType_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	param={};
	this.gfnFormOpen(this.FormInfo.CD_MODULE, "DAB_LEISURE_ROOMTYPE_DLG", "", param);
};

// 조회조건 골프로 변경 시 데이터 초기화
this.divSearch_ccboDS_R_DAYS_canitemchange = function(obj:nexacro.Combo,e:nexacro.ItemChangeEventInfo)
{	
	if(e.prevalue != e.postvalue){

	//trace( " prevalue->" + e.prevalue	+ "\n postvalue->" + e.postvalue);
	
		if(!this.gfnIsNull(e.prevalue) && !this.gfnIsNull(e.postvalue)){
			var CD_LEISURE = this.dsSearch.getColumn(0, "CD_LEISURE");
			var DS_LEISURE = this.dsSearch.getColumn(0, "DS_LEISURE");
		
			if(this.gTySave == "U"){
				this.dsList.setColumn( 0, "DS_R_DAYS",  e.postvalue);	// 검색조건 변경하면 dsList에 자동셋팅
			}

			if(e.prevalue == "골프" || e.postvalue == "골프"){
			
				var tidx = this.divData.form.tabData.tabindex;
				if(tidx != 0 && e.postvalue == "골프"){	// 휴가지원
					return false;
				}


				if( (!this.gfnIsNull(CD_LEISURE) && (this.gfnIsUpdatedRow(this.dsList, 0)) || this.gTySave == "U") ){	// 
					var rtnConfirm = confirm("저장되지 않은 정보가 있습니다.\n 계속하시겠습니까?");
					return this.fnBeforeCDTextChanged(rtnConfirm);
				}
			}
		}
	}
};]]></Script>
    <Objects>
      <Dataset id="dsList" oncolumnchanged="dsList_oncolumnchanged">
        <ColumnInfo>
          <Column id="ID_PERSON" type="BIGDECIMAL" size="256" description="PERSON ID"/>
          <Column id="NO_SEQ" type="STRING" size="256" description="순번"/>
          <Column id="DT_REQUEST" type="STRING" size="256" description="신청일"/>
          <Column id="CD_LEISURE" type="STRING" size="256" description="이용사업장"/>
          <Column id="DT_START" type="STRING" size="256" description="이용시작일"/>
          <Column id="DT_END" type="STRING" size="256" description="이용종료일"/>
          <Column id="DS_R_DAYS" type="STRING" size="256" description="객실_박수"/>
          <Column id="DS_R_RELATION" type="STRING" size="256" description="객실_관계"/>
          <Column id="DS_R_RESERVE" type="STRING" size="256" description="객실_예약자"/>
          <Column id="NO_R_RESERVE" type="STRING" size="256" description="객실_예약번호"/>
          <Column id="TY_R_ROOM" type="STRING" size="256" description="객실_객실타입"/>
          <Column id="NO_R_ROOM" type="BIGDECIMAL" size="256" description="객실_객실타입SEQ"/>
          <Column id="CT_R_ROOM" type="STRING" size="256" description="객실_객실수"/>
          <Column id="DS_G_RELATION1" type="STRING" size="256" description="골프_관계1"/>
          <Column id="DS_G_USER1" type="STRING" size="256" description="골프_사용자1"/>
          <Column id="DT_G_USE1" type="STRING" size="256" description="골프_사용일자1"/>
          <Column id="DS_G_TEE_OFF1" type="STRING" size="256" description="골프_티오프시간1"/>
          <Column id="DS_G_INSERT1" type="STRING" size="256" description="골프_예약자1"/>
          <Column id="DS_G_RELATION2" type="STRING" size="256" description="골프_관계2"/>
          <Column id="DS_G_USER2" type="STRING" size="256" description="골프_사용자2"/>
          <Column id="DT_G_USE2" type="STRING" size="256" description="골프_사용일자2"/>
          <Column id="DS_G_TEE_OFF2" type="STRING" size="256" description="골프_티오프시간2"/>
          <Column id="DS_G_INSERT2" type="STRING" size="256" description="골프_예약자2"/>
          <Column id="TY_A_SALE" type="STRING" size="256" description="추천_직원할인선택(1:임직원본인할인, 2:임직원추천할인)"/>
          <Column id="NO_A_RESERVE" type="STRING" size="256" description="추천_예약번호"/>
          <Column id="DS_A_USER" type="STRING" size="256" description="추천_실사용자"/>
          <Column id="TY_A_ROOM" type="STRING" size="256" description="추천_객실타입"/>
          <Column id="NO_A_ROOM" type="BIGDECIMAL" size="256" description="추천_객실타입SEQ"/>
          <Column id="CT_A_ROOM" type="STRING" size="256" description="추천_객실수"/>
          <Column id="DS_A_DAYS" type="STRING" size="256" description="추천_박수"/>
          <Column id="DS_A_RELATION" type="STRING" size="256" description="추천_관계"/>
          <Column id="DS_A_PHONE" type="STRING" size="256" description="추천_연락처"/>
          <Column id="NO_B_NUMBER1" type="STRING" size="256" description="무주_일련번호1"/>
          <Column id="NO_B_NUMBER2" type="STRING" size="256" description="무주_일련번호2"/>
          <Column id="NO_B_NUMBER3" type="STRING" size="256" description="무주_일련번호3"/>
          <Column id="NO_B_NUMBER4" type="STRING" size="256" description="무주_일련번호4"/>
          <Column id="NO_B_RESERVE1" type="STRING" size="256" description="무주_예약번호1"/>
          <Column id="NO_B_RESERVE2" type="STRING" size="256" description="무주_예약번호2"/>
          <Column id="NO_B_RESERVE3" type="STRING" size="256" description="무주_예약번호3"/>
          <Column id="NO_B_RESERVE4" type="STRING" size="256" description="무주_예약번호4"/>
          <Column id="TY_B_ROOM1" type="STRING" size="256" description="무주_객실타입1"/>
          <Column id="TY_B_ROOM2" type="STRING" size="256" description="무주_객실타입2"/>
          <Column id="TY_B_ROOM3" type="STRING" size="256" description="무주_객실타입3"/>
          <Column id="TY_B_ROOM4" type="STRING" size="256" description="무주_객실타입4"/>
          <Column id="YN_APPROVE" type="STRING" size="256" description="담당자_승인값"/>
          <Column id="YN_TEAMLEADER" type="STRING" size="256" description="부서장_승인값"/>
          <Column id="YN_OFFICER" type="STRING" size="256" description="임원_승인값"/>
          <Column id="ID_INSERT" type="STRING" size="256" description="입력자"/>
          <Column id="DT_INSERT" type="STRING" size="256" description="입력일"/>
          <Column id="ID_UPDATE" type="STRING" size="256" description="수정자"/>
          <Column id="DT_UPDATE" type="STRING" size="256" description="수정일"/>
          <Column id="ID_APPROVE" type="STRING" size="256" description="담당자_사번"/>
          <Column id="DT_APPROVE" type="STRING" size="256" description="담당자_승인일자"/>
          <Column id="ID_TEAMLEADER" type="STRING" size="256" description="부서장_사번"/>
          <Column id="DT_TEAMLEADER" type="STRING" size="256" description="부서장_승인일자"/>
          <Column id="ID_OFFICER" type="STRING" size="256" description="임원_사번"/>
          <Column id="DT_OFFICER" type="STRING" size="256" description="임원_승인일자"/>
          <Column id="YN_DELETE" type="STRING" size="256" description="삭제여부"/>
          <Column id="TY_APPROVE" type="STRING" size="256" description="승인상태(N:결재중 , Y:승인완료)"/>
          <Column id="CT_RR_POINT" type="STRING" size="256" description="리조트숙박포인트"/>
          <Column id="CT_GR_POINT" type="STRING" size="256" description="골프숙박포인트"/>
          <Column id="CT_GU_POINT" type="STRING" size="256" description="골프사용포인트"/>
          <Column id="AM_COUPON1" type="STRING" size="256" description="판매금액1"/>
          <Column id="AM_COUPON2" type="STRING" size="256" description="판매금액2"/>
          <Column id="AM_COUPON3" type="STRING" size="256" description="판매금액3"/>
          <Column id="AM_COUPON4" type="STRING" size="256" description="판매금액4"/>
          <Column id="DS_BANK1" type="STRING" size="256" description="은행1"/>
          <Column id="DS_BANK2" type="STRING" size="256" description="은행2"/>
          <Column id="DS_BANK3" type="STRING" size="256" description="은행3"/>
          <Column id="DS_BANK4" type="STRING" size="256" description="은행4"/>
          <Column id="NO_ACCOUNT1" type="STRING" size="256" description="계좌번호1"/>
          <Column id="NO_ACCOUNT2" type="STRING" size="256" description="계좌번호2"/>
          <Column id="NO_ACCOUNT3" type="STRING" size="256" description="계좌번호3"/>
          <Column id="NO_ACCOUNT4" type="STRING" size="256" description="계좌번호4"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="_dsProc">
        <ColumnInfo>
          <Column id="TARGET" type="STRING" size="256"/>
          <Column id="SP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TARGET">selectPoint</Col>
            <Col id="SP">DABPR_LEISURE_POINT_SELECT</Col>
          </Row>
          <Row>
            <Col id="TARGET">select</Col>
            <Col id="SP">DABPR_LEISURE_REQUEST_DETAIL_SELECT</Col>
          </Row>
          <Row>
            <Col id="TARGET">comboRelation</Col>
            <Col id="SP">DAXPR_FAMILY_RELATION_COMBO</Col>
          </Row>
          <Row>
            <Col id="TARGET">combo</Col>
            <Col id="SP">DAZPR_COMMONCODE_COMBO</Col>
          </Row>
          <Row>
            <Col id="TARGET">save</Col>
            <Col id="SP">DABPR_LEISURE_REQUEST_SAVE</Col>
          </Row>
          <Row>
            <Col id="TARGET">insert</Col>
            <Col id="SP">DABPR_LEISURE_REQUEST_INSERT</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsSearch" onvaluechanged="dsSearch_onvaluechanged">
        <ColumnInfo>
          <Column id="TY_LEISURE" type="STRING" size="256"/>
          <Column id="CD_LEISURE" type="STRING" size="256"/>
          <Column id="DT_START" type="STRING" size="256"/>
          <Column id="DS_R_DAYS" type="STRING" size="256"/>
          <Column id="DS_LEISURE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="dsTY_LEISURE">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD_CODE">1</Col>
            <Col id="DS_CODE">휴가지원</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">2</Col>
            <Col id="DS_CODE">직원(추천)할인</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">3</Col>
            <Col id="DS_CODE">무주쿠폰</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsDS_R_DAYS">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD_CODE">골프</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">1박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">2박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">3박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">4박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">5박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">6박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">7박</Col>
            <Col id="DS_CODE">R</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">6개월</Col>
            <Col id="DS_CODE">B</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">1년</Col>
            <Col id="DS_CODE">B</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsResult">
        <ColumnInfo>
          <Column id="RESULT_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsListPoint">
        <ColumnInfo>
          <Column id="YEAR" type="STRING" size="256" description="년도"/>
          <Column id="RESORT_ROOM" type="STRING" size="256" description="리조트숙박"/>
          <Column id="RESORT_ROOM_USE" type="STRING" size="256" description="리조트숙박사용"/>
          <Column id="RESORT_ROOM_REST" type="STRING" size="256" description="리조트숙박잔여"/>
          <Column id="GOLF_ROOM" type="STRING" size="256" description="골프숙박"/>
          <Column id="GOLF_ROOM_USE" type="STRING" size="256" description="골프숙박사용"/>
          <Column id="GOLF_ROOM_REST" type="STRING" size="256" description="골프숙박잔여"/>
          <Column id="GOLF" type="STRING" size="256" description="골프"/>
          <Column id="GOLF_USE" type="STRING" size="256" description="골프사용"/>
          <Column id="GOLF_REST" type="STRING" size="256" description="골프잔여"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsTY_B_ROOM">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsDS_RELATION">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="divSearch.form.ccboTY_LEISURE" propid="value" datasetid="dsSearch" columnid="TY_LEISURE"/>
      <BindItem id="item1" compid="divSearch.form.ccfCD_LEISURE.form.CDTextBox" propid="value" datasetid="dsSearch" columnid="CD_LEISURE"/>
      <BindItem id="item2" compid="divSearch.form.calDT_START" propid="value" datasetid="dsSearch" columnid="DT_START"/>
      <BindItem id="item3" compid="divSearch.form.ccboDS_R_DAYS" propid="value" datasetid="dsSearch" columnid="DS_R_DAYS"/>
      <BindItem id="item4" compid="divSearch.form.ccfCD_LEISURE.form.DSTextBox" propid="value" datasetid="dsSearch" columnid="DS_LEISURE"/>
      <BindItem id="item5" compid="divPoint.form.staBg00" propid="text" datasetid="dsListPoint" columnid="YEAR"/>
      <BindItem id="item6" compid="divPoint.form.staBg01" propid="text" datasetid="dsListPoint" columnid="RESORT_ROOM"/>
      <BindItem id="item7" compid="divPoint.form.staBg02" propid="text" datasetid="dsListPoint" columnid="RESORT_ROOM_USE"/>
      <BindItem id="item8" compid="divPoint.form.staBg03" propid="text" datasetid="dsListPoint" columnid="RESORT_ROOM_REST"/>
      <BindItem id="item9" compid="divPoint.form.staBg04" propid="text" datasetid="dsListPoint" columnid="GOLF_ROOM"/>
      <BindItem id="item10" compid="divPoint.form.staBg05" propid="text" datasetid="dsListPoint" columnid="GOLF_ROOM_USE"/>
      <BindItem id="item11" compid="divPoint.form.staBg06" propid="text" datasetid="dsListPoint" columnid="GOLF_ROOM_REST"/>
      <BindItem id="item12" compid="divPoint.form.staBg07" propid="text" datasetid="dsListPoint" columnid="GOLF"/>
      <BindItem id="item13" compid="divPoint.form.staBg08" propid="text" datasetid="dsListPoint" columnid="GOLF_USE"/>
      <BindItem id="item14" compid="divPoint.form.staBg09" propid="text" datasetid="dsListPoint" columnid="GOLF_REST"/>
      <BindItem id="item15" compid="divData.form.tabData.tab1.form.cboDS_R_RELATION" propid="value" datasetid="dsList" columnid="DS_R_RELATION"/>
      <BindItem id="item16" compid="divData.form.tabData.tab1.form.edtDS_R_RESERVE" propid="value" datasetid="dsList" columnid="DS_R_RESERVE"/>
      <BindItem id="item17" compid="divData.form.tabData.tab1.form.edtNO_R_RESERVE" propid="value" datasetid="dsList" columnid="NO_R_RESERVE"/>
      <BindItem id="item18" compid="divData.form.tabData.tab1.form.ccfTY_R_ROOM.form.CDTextBox" propid="value" datasetid="dsList" columnid="NO_R_ROOM"/>
      <BindItem id="item62" compid="divData.form.tabData.tab1.form.ccfTY_R_ROOM.form.DSTextBox" propid="value" datasetid="dsList" columnid="TY_R_ROOM"/>
      <BindItem id="item19" compid="divData.form.tabData.tab1.form.cboCT_R_ROOM" propid="value" datasetid="dsList" columnid="CT_R_ROOM"/>
      <BindItem id="item20" compid="divData.form.tabData.tab1.form.cboDS_G_RELATION1" propid="value" datasetid="dsList" columnid="DS_G_RELATION1"/>
      <BindItem id="item21" compid="divData.form.tabData.tab1.form.cboDS_G_RELATION2" propid="value" datasetid="dsList" columnid="DS_G_RELATION2"/>
      <BindItem id="item22" compid="divData.form.tabData.tab1.form.ctclDT_G_USE1" propid="value" datasetid="dsList" columnid="DT_G_USE1"/>
      <BindItem id="item23" compid="divData.form.tabData.tab1.form.ctclDT_G_USE2" propid="value" datasetid="dsList" columnid="DT_G_USE2"/>
      <BindItem id="item24" compid="divData.form.tabData.tab1.form.edtDS_G_USER1" propid="value" datasetid="dsList" columnid="DS_G_USER1"/>
      <BindItem id="item25" compid="divData.form.tabData.tab1.form.edtDS_G_USER2" propid="value" datasetid="dsList" columnid="DS_G_USER2"/>
      <BindItem id="item26" compid="divData.form.tabData.tab1.form.edtDS_G_TEE_OFF1" propid="value" datasetid="dsList" columnid="DS_G_TEE_OFF1"/>
      <BindItem id="item27" compid="divData.form.tabData.tab1.form.edtDS_G_TEE_OFF2" propid="value" datasetid="dsList" columnid="DS_G_TEE_OFF2"/>
      <BindItem id="item28" compid="divData.form.tabData.tab1.form.edtDS_G_INSERT1" propid="value" datasetid="dsList" columnid="DS_G_INSERT1"/>
      <BindItem id="item29" compid="divData.form.tabData.tab1.form.edtDS_G_INSERT2" propid="value" datasetid="dsList" columnid="DS_G_INSERT2"/>
      <BindItem id="item30" compid="divData.form.tabData.tab2.form.rdoTY_A_SALE" propid="value" datasetid="dsList" columnid="TY_A_SALE"/>
      <BindItem id="item31" compid="divData.form.tabData.tab2.form.edtNO_A_RESERVE" propid="value" datasetid="dsList" columnid="NO_A_RESERVE"/>
      <BindItem id="item32" compid="divData.form.tabData.tab2.form.edtDS_A_USER" propid="value" datasetid="dsList" columnid="DS_A_USER"/>
      <BindItem id="item33" compid="divData.form.tabData.tab2.form.ccfTY_A_ROOM.form.CDTextBox" propid="value" datasetid="dsList" columnid="NO_A_ROOM"/>
      <BindItem id="item63" compid="divData.form.tabData.tab2.form.ccfTY_A_ROOM.form.DSTextBox" propid="value" datasetid="dsList" columnid="TY_A_ROOM"/>
      <BindItem id="item34" compid="divData.form.tabData.tab2.form.cboCT_A_ROOM" propid="value" datasetid="dsList" columnid="CT_A_ROOM"/>
      <BindItem id="item35" compid="divData.form.tabData.tab2.form.edtDS_A_RELATION" propid="value" datasetid="dsList" columnid="DS_A_RELATION"/>
      <BindItem id="item36" compid="divData.form.tabData.tab2.form.edtDS_A_PHONE" propid="value" datasetid="dsList" columnid="DS_A_PHONE"/>
      <BindItem id="item37" compid="divData.form.tabData.tab3.form.edtNO_B_RESERVE1" propid="value" datasetid="dsList" columnid="NO_B_RESERVE1"/>
      <BindItem id="item38" compid="divData.form.tabData.tab3.form.edtNO_B_RESERVE2" propid="value" datasetid="dsList" columnid="NO_B_RESERVE2"/>
      <BindItem id="item39" compid="divData.form.tabData.tab3.form.edtNO_B_RESERVE3" propid="value" datasetid="dsList" columnid="NO_B_RESERVE3"/>
      <BindItem id="item40" compid="divData.form.tabData.tab3.form.edtNO_B_RESERVE4" propid="value" datasetid="dsList" columnid="NO_B_RESERVE4"/>
      <BindItem id="item41" compid="divData.form.tabData.tab3.form.edtNO_B_NUMBER1" propid="value" datasetid="dsList" columnid="NO_B_NUMBER1"/>
      <BindItem id="item42" compid="divData.form.tabData.tab3.form.edtNO_B_NUMBER2" propid="value" datasetid="dsList" columnid="NO_B_NUMBER2"/>
      <BindItem id="item43" compid="divData.form.tabData.tab3.form.edtNO_B_NUMBER3" propid="value" datasetid="dsList" columnid="NO_B_NUMBER3"/>
      <BindItem id="item44" compid="divData.form.tabData.tab3.form.edtNO_B_NUMBER4" propid="value" datasetid="dsList" columnid="NO_B_NUMBER4"/>
      <BindItem id="item45" compid="divData.form.tabData.tab3.form.cboTY_B_ROOM1" propid="value" datasetid="dsList" columnid="TY_B_ROOM1"/>
      <BindItem id="item46" compid="divData.form.tabData.tab3.form.cboTY_B_ROOM2" propid="value" datasetid="dsList" columnid="TY_B_ROOM2"/>
      <BindItem id="item47" compid="divData.form.tabData.tab3.form.cboTY_B_ROOM3" propid="value" datasetid="dsList" columnid="TY_B_ROOM3"/>
      <BindItem id="item48" compid="divData.form.tabData.tab3.form.cboTY_B_ROOM4" propid="value" datasetid="dsList" columnid="TY_B_ROOM4"/>
      <BindItem id="item49" compid="divData.form.tabData.tab3.form.edtNO_ACCOUNT1" propid="value" datasetid="dsList" columnid="NO_ACCOUNT1"/>
      <BindItem id="item50" compid="divData.form.tabData.tab3.form.edtNO_ACCOUNT2" propid="value" datasetid="dsList" columnid="NO_ACCOUNT2"/>
      <BindItem id="item51" compid="divData.form.tabData.tab3.form.edtNO_ACCOUNT3" propid="value" datasetid="dsList" columnid="NO_ACCOUNT3"/>
      <BindItem id="item52" compid="divData.form.tabData.tab3.form.edtNO_ACCOUNT4" propid="value" datasetid="dsList" columnid="NO_ACCOUNT4"/>
      <BindItem id="item53" compid="divData.form.tabData.tab3.form.edtDS_BANK1" propid="value" datasetid="dsList" columnid="DS_BANK1"/>
      <BindItem id="item54" compid="divData.form.tabData.tab3.form.edtDS_BANK2" propid="value" datasetid="dsList" columnid="DS_BANK2"/>
      <BindItem id="item55" compid="divData.form.tabData.tab3.form.edtDS_BANK3" propid="value" datasetid="dsList" columnid="DS_BANK3"/>
      <BindItem id="item56" compid="divData.form.tabData.tab3.form.edtDS_BANK4" propid="value" datasetid="dsList" columnid="DS_BANK4"/>
      <BindItem id="item57" compid="divData.form.tabData.tab3.form.edtAM_COUPON1" propid="value" datasetid="dsList" columnid="AM_COUPON1"/>
      <BindItem id="item58" compid="divData.form.tabData.tab3.form.edtAM_COUPON2" propid="value" datasetid="dsList" columnid="AM_COUPON2"/>
      <BindItem id="item59" compid="divData.form.tabData.tab3.form.edtAM_COUPON3" propid="value" datasetid="dsList" columnid="AM_COUPON3"/>
      <BindItem id="item60" compid="divData.form.tabData.tab3.form.edtAM_COUPON4" propid="value" datasetid="dsList" columnid="AM_COUPON4"/>
      <BindItem id="item64" compid="divSearch.form.calDT_END" propid="value" datasetid="dsList" columnid="DT_END"/>
    </Bind>
  </Form>
</FDL>
