<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="form" width="1320" height="760" titletext="이행상황신고서" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="divSearch" taborder="1" left="0" top="10.0" height="46.0" right="0" cssclass="div_SEARCH_Bg">
          <Layouts>
            <Layout>
              <Static id="staCD_CORP" taborder="1" text="법인코드" left="0.0" top="10.0" width="92.0" height="24.0" usedecorate="false" cssclass="sta_WF_SchLabelE"/>
              <Div id="ccfCD_CORP" CDTextWidth="80" taborder="0" left="staCD_CORP:0.0" top="10.0" width="250" height="24.0" url="cmm::cmmCodeFind.xfdl"/>
              <Static id="staYM" taborder="3" text="문서번호" left="ccfCD_CORP:0.0" top="10.0" width="92.0" height="24.0" usedecorate="false" cssclass="sta_WF_SchLabelE"/>
              <Edit id="edtNO_ID" taborder="2" left="440" top="10" width="80" height="24"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divData" taborder="0" left="0" top="divSearch:10" bottom="0" right="0" cssclass="div_DATA_Bg">
          <Layouts>
            <Layout>
              <Static id="staBgSINGO" taborder="1" left="109" top="0" height="27" cssclass="sta_WF_tablebg" width="1000" text=""/>
              <Static id="staBgSINGO00" taborder="22" left="109" top="26" height="27" cssclass="sta_WF_tablebg" width="1000" text=""/>
              <Tab id="tabData" taborder="0" tabindex="0" left="0" top="82" bottom="0" right="0" onchanged="divData_tabData_onchanged">
                <Tabpages>
                  <Tabpage id="tab1" left="27" top="29" width="1280" height="511" text="납부서">
                    <Layouts>
                      <Layout>
                        <Grid id="objGrid" taborder="0" left="0" top="0" right="0" binddataset="dsList" onselectchanged="divData_tabData_tab1_objGrid_onselectchanged" bottom="163">
                          <Formats>
                            <Format id="default"/>
                          </Formats>
                        </Grid>
                        <Static id="staBg06" taborder="23" left="193" top="objGrid:68" height="24" cssclass="sta_WF_tablebg" width="398" text=""/>
                        <Static id="staBg08" taborder="20" left="193" top="objGrid:91" height="24" cssclass="sta_WF_tablebg" width="398"/>
                        <Static id="staBg06_00_00" taborder="50" left="193" top="objGrid:45" height="24" cssclass="sta_WF_tablebg" width="398"/>
                        <Static id="staBg04_00" taborder="36" left="743" top="objGrid:114" height="24" cssclass="sta_WF_tablebg" width="475"/>
                        <Static id="sta11_00" taborder="31" text="정액가산세" left="69" top="objGrid:22" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staBg06_00" taborder="32" left="sta11_00:-1" top="objGrid:22" height="24" cssclass="sta_WF_tablebg" width="398"/>
                        <Static id="sta02" taborder="5" text="추가납부액" left="918" top="objGrid:22" width="300" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staBg01" taborder="12" left="743" top="objGrid:68" height="24" cssclass="sta_WF_tablebg" width="475"/>
                        <Static id="staBg04" taborder="28" left="743" top="objGrid:137" height="24" cssclass="sta_WF_tablebg" width="475"/>
                        <Static id="staBg02" taborder="13" left="743" top="sta02:-1" height="24" cssclass="sta_WF_tablebg" width="475"/>
                        <Static id="staBg03" taborder="14" left="743" top="objGrid:91" height="24" cssclass="sta_WF_tablebg" width="475"/>
                        <Static id="sta09_00" taborder="35" text="전월 미환급액" left="619" top="objGrid:114" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_REFUND_BEF" taborder="48" left="sta09_00:4" top="objGrid:116" width="115" height="20" format="###,###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="true"/>
                        <Static id="sta01" taborder="4" text="환급액" left="619" top="objGrid:22" width="300" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta05" taborder="7" text="연말정산환급액" left="619" top="sta01:22" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta07" taborder="8" text="기타환급액(중도퇴사자등)" left="619" top="objGrid:91" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="left"/>
                        <Static id="sta04" taborder="9" text="당월추가납부액" left="918" top="objGrid:45" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta06" taborder="10" text="연말정산추가납부액" left="918" top="objGrid:68" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta08" taborder="11" text="가산세대상추가납부액" left="918" top="objGrid:91" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_ADD_PAYMENT" taborder="49" left="sta04:4" top="objGrid:47" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_YEAREND_PAYMENT" taborder="51" left="sta06:4" top="objGrid:70" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_PENALTY_ADD_PAYMENT" taborder="3" left="sta08:4" top="objGrid:93" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <Static id="sta11" taborder="15" text="가산세 추가납부액" left="69" top="objGrid:68" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta13" taborder="16" text="추가대상&#13;&#10;가산세" left="0" top="sta11:-25" width="70" height="72" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta14" taborder="17" text="미납세액의 3%" left="69" top="sta11:-1" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta15" taborder="18" text="미납지연가산세" left="319" top="objGrid:91" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta16" taborder="19" text="가산세 총액" left="0" top="sta13:-2" width="203" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staBg09" taborder="21" left="193" top="objGrid:114" height="24" cssclass="sta_WF_tablebg" width="398"/>
                        <Static id="staBg10" taborder="22" left="193" top="objGrid:137" height="24" cssclass="sta_WF_tablebg" width="398"/>
                        <MaskEdit id="mskAM_PENALTY_DEFAULT" taborder="38" left="sta11_00:4" top="objGrid:24" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_PENALTY_ADD_PAYMENT2" taborder="40" left="sta11:4" top="objGrid:70" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="true"/>
                        <MaskEdit id="mskAM_PENALTY_ADD_DEFAULT" taborder="42" left="sta14:4" top="objGrid:93" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_PENALTY_ADD_ADD" taborder="43" left="sta15:3" top="objGrid:93" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_PENALTY" taborder="1" left="sta16:-5" top="objGrid:139" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <Static id="sta12" taborder="24" text="납부기한" left="319" top="objGrid:68" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="staTITLE00" taborder="26" text="가산세 내역" left="10" top="objGrid:-3" height="30" cssclass="sta_TITLE_Bg" textAlign="left" onclick="divData_tabData_tab3_staTITLE_onclick" width="500"/>
                        <Calendar id="tclDT_PENALTY_ADD" taborder="41" left="mskAM_PENALTY_ADD_PAYMENT2:134" top="objGrid:70" width="95" height="20" onchanged="divData_ccfDT_ENTER_onchanged" dateformat="yyyy-MM-dd"/>
                        <Static id="staTITLE" taborder="25" text="가감조정내역" left="630" top="objGrid:-3" height="30" cssclass="sta_TITLE_Bg" textAlign="left" onclick="divData_tabData_tab3_staTITLE_onclick" width="500"/>
                        <Static id="sta09" taborder="27" text="환급합계금액" left="619" top="objGrid:137" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta10" taborder="29" text="추가납부합계금액" left="918" top="objGrid:137" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_PAYMENT" taborder="30" left="sta10:4" top="objGrid:139" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <Static id="sta03" taborder="6" text="당월기타환급액" left="619" top="sta01:-1" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_ETC_REFUND" taborder="45" left="sta03:4" top="sta01:1" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_YEAREND_REFUND" taborder="46" left="sta05:4" top="mskAM_ETC_REFUND:3" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_RETIRE_REFUND" taborder="47" left="sta07:4" top="mskAM_YEAREND_REFUND:3" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_REFUND" taborder="2" left="sta09:4" top="mskAM_RETIRE_REFUND:26" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <MaskEdit id="mskDD_PENALTY_ADD" taborder="44" left="mskAM_PENALTY_ADD_ADD:-18" top="objGrid:70" width="39" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <MaskEdit id="mskAM_AMOUNT_PAY" taborder="33" left="336" top="objGrid:139" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" visible="false"/>
                        <MaskEdit id="mskAM_BALANCE" taborder="34" left="460" top="objGrid:139" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" visible="false"/>
                        <Static id="sta11_00_00" taborder="37" text="당월 가산세 계" left="69" top="objGrid:45" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_PENALTY_DATE" taborder="39" left="447" top="objGrid:24" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged"/>
                        <Static id="sta13_00" taborder="52" text="당월 &#13;&#10;가산세" left="0" top="objGrid:22" width="70" height="47" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <Static id="sta11_00_01" taborder="53" text="지연가산세" left="319" top="objGrid:22" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_PENALTY_MON" taborder="54" left="198" top="objGrid:47" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <Static id="sta15_00" taborder="55" text="추가대상가산세 계" left="69" top="objGrid:114" width="125" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                        <MaskEdit id="mskAM_PENALTY_ADD" taborder="56" left="198" top="objGrid:116" width="115" height="20" format="###,###,###,###" limitbymask="both" onkillfocus="mask_onkillfocus" onchanged="fn_OnChanged" enable="false"/>
                        <Static id="sta09_00_00" taborder="57" left="918" top="objGrid:114" width="155" height="24" cssclass="sta_WF_tablelabel" textAlign="center"/>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                  <Tabpage id="tab2" text="징수 및 조정명세서" left="27" top="29" width="1280" height="511">
                    <Layouts>
                      <Layout>
                        <Grid id="objGrid2" taborder="0" left="0" top="0" right="0" bottom="0" binddataset="dsList2">
                          <Formats>
                            <Format id="default"/>
                          </Formats>
                        </Grid>
                      </Layout>
                    </Layouts>
                  </Tabpage>
                </Tabpages>
              </Tab>
              <Static id="staSINGO" taborder="3" text="구분" left="0" top="0" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staYM_IMPUTE" taborder="10" text="지급연월" left="staBgSINGO:-271" top="staBgSINGO:-27" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staYM_IMPUTE00" taborder="20" text="신고구분" left="staSINGO:236" top="0" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staYM_SUPPLY" taborder="11" text="귀속연월" left="staYM_IMPUTE00:145" top="0" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staSINGO00" taborder="21" text="신고기한" left="0" top="26" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staDT_ENTER" taborder="12" text="제출일자" left="staSINGO00:236" top="26" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabelE"/>
              <Static id="staNM_SANGHO" taborder="13" left="0" top="staSINGO00:-1" width="110" height="27" cssclass="sta_WF_tablelabel" textAlign="center" text="사업장명"/>
              <Static id="staBgNM_SANGHO" taborder="14" left="staNM_SANGHO:-1" top="staNM_SANGHO:-27" height="27" cssclass="sta_WF_tablebg" width="1000" text=""/>
              <Static id="staDS_ADDRESS" taborder="15" text="사업장주소" left="staNM_SANGHO:236" top="staDT_ENTER:-1" width="110" height="27" cssclass="sta_WF_tablelabel" textAlign="center"/>
              <Static id="sta22" taborder="23" text="지연일자" left="staDT_ENTER:145" top="26" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabel"/>
              <Static id="sta23" taborder="18" text="마감여부" left="sta22:127" top="staYM_IMPUTE:-1" width="110" height="27" textAlign="center" cssclass="sta_WF_tablelabel"/>
              <Static id="staADDR" taborder="16" text="법정동명" left="staDS_ADDRESS:382" top="staDS_ADDRESS:-27" width="110" height="27" cssclass="sta_WF_tablelabel" textAlign="center"/>
              <Radio id="rdoSINGO" taborder="9" left="staSINGO:5" top="staSINGO:-23" width="119" height="20" onitemchanged="divData_item_onchanged" index="0" text="매월" value="M" innerdataset="dsSINGO" datacolumn="VALUE" codecolumn="CODE" fittocontents="width" direction="vertical" enable="false"/>
              <Div id="ctclYM_WORK" taborder="6" left="staYM_SUPPLY:5" top="staYM_IMPUTE:-24" width="80" height="20" url="cmm::cmmCalMM.xfdl" enableevent="true" text=""/>
              <Div id="ctclYM_PAYMENT" taborder="7" left="staYM_IMPUTE:4" top="staYM_SUPPLY:-24" width="80" height="20" url="cmm::cmmCalMM.xfdl" enableevent="true" text=""/>
              <Calendar id="ccfDT_DELIVERY" taborder="2" left="staDT_ENTER:5" top="staDT_ENTER:-23" width="98" height="20" onchanged="divData_ccfDT_ENTER_onchanged" dateformat="yyyy-MM-dd"/>
              <Edit id="edtDS_PLACE" taborder="17" left="staNM_SANGHO:5" top="staNM_SANGHO:-23" width="231" height="20" readonly="true" tabstop="false"/>
              <Radio id="rdoYN_CLOSE" taborder="19" left="sta23:4" top="30" width="100" height="20" index="-1" text="" value="" datacolumn="datacolumn" codecolumn="codecolumn" fittocontents="width" direction="vertical" enable="false" innerdataset="innerdataset" tabstop="false">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">Y</Col>
                      <Col id="datacolumn">여</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">N</Col>
                      <Col id="datacolumn">부</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Radio id="rdoTY_WORK" taborder="5" left="staYM_IMPUTE00:9" top="4" width="121" height="20" onitemchanged="divData_item_onchanged" index="0" text="정기" value="1" innerdataset="dsWORK" datacolumn="VALUE" codecolumn="CODE" fittocontents="width" direction="vertical"/>
              <Calendar id="ccfDT_NOTIFY" taborder="8" left="staSINGO00:6" top="30" width="115" height="20" onchanged="divData_ccfDT_ENTER_onchanged"/>
              <MaskEdit id="mskDD_PENALTY" taborder="4" left="sta22:5" top="30" width="78" height="18"/>
              <Edit id="edtDS_ADDRESS" taborder="24" left="459" top="56" width="373" height="20" readonly="true" tabstop="false"/>
              <Edit id="edtDS_STREET" taborder="25" left="952" top="56" width="106" height="20" readonly="true" tabstop="false"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.objApp = this.gfnGetApplication();

var context = "/";
if (nexacro.getEnvironmentVariable("evContextPath") != undefined) {
	context = nexacro.getEnvironmentVariable("evContextPath");
}

this.fileConfig = {
	host : this.gfnGetServerUrl(),
	downloadUrl : context + "file/downloadText.do",
	allowTypes : ["txt"],
	maxCount : 1,
	maxSize : "200MB",
	maxTotalSize : "200MB"
};

this.sYnGridMerge = "N";
this.rows = [];
this.vYnSetVarA = false; 
this.vYnSetVarB = false;
this.form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	// -- 필수 -------------------//
	this.gfnFormOnLoad(this);	
	this.gfnFormInfo(this);		
	// ---------------------------//
	
	this.fnSetButton();
	this.fnSetExtendButton();
	this.fnSetVariable();
	this.fnSetParameter();
	this.fnSetEvent();
	this.fnSetCombo();
		
	//법인코드 세션에 코드로 셋팅
// 	this.ccfCD_CORP.form.CDTextBox.set_value(this.AuthClient.CD_CORP);
// 	this.ccfCD_CORP.form.DSTextBox.set_value(this.AuthClient.DS_CORP); 
	this.edtNO_ID.set_value(this.getOwnerFrame().NO_ID);
	this.dsSearch.setColumn(0, "CD_CORP", this.getOwnerFrame().CD_CORP); 
	this.dsSearch.setColumn(0, "DS_CORP", this.getOwnerFrame().DS_CORP); 
	if (!this.gfnIsNull(this.getOwnerFrame().NO_ID))
	{	
		this.fnSelect();
	}
};

/************************************************************************
 * 버튼 설정 : 화면(Tab) 전환시 마다 호출
 * 서브버튼 사용 및 공통버튼 강제 제어시 여기서 처리
 ************************************************************************/
this.fnSetButton = function() {
};

/************************************************************************
 * 확장 버튼 : 화면별 버튼 설정 ID, function 연결 (화면버튼관리)
 ************************************************************************/
this.fnSetExtendButton = function() {
	this.btnClose = this.gfnFormButtonAdd("btnClose", "fnTaxClose")//, "마감");	
	this.btnCancle = this.gfnFormButtonAdd("btnCancle", "fnCancle")//, "마감취소");	
	this.btnESingo = this.gfnFormButtonAdd("ESingo", "fnESingo")//, "전자신고");	
};

/************************************************************************
 * 변수 선언
 ************************************************************************/
this.fnSetVariable = function() {

	this.ccfCD_CORP = this.divSearch.form.ccfCD_CORP;
	this.edtNO_ID = this.divSearch.form.edtNO_ID;
	
	this.rdoSINGO = this.divData.form.rdoSINGO;
	this.rdoTY_WORK = this.divData.form.rdoTY_WORK;
	this.ctclYM_PAYMENT = this.divData.form.ctclYM_PAYMENT;
	this.ctclYM_WORK = this.divData.form.ctclYM_WORK;
	this.ccfDT_NOTIFY = this.divData.form.ccfDT_NOTIFY;
	this.ccfDT_DELIVERY = this.divData.form.ccfDT_DELIVERY;
	this.mskDD_PENALTY_DAY = this.divData.form.mskDD_PENALTY_DAY;
	this.rdoYN_CLOSE = this.divData.form.rdoYN_CLOSE;
	this.edtDS_PLACE = this.divData.form.edtDS_PLACE;
	this.edtDS_ADDRESS = this.divData.form.edtDS_ADDRESS;	
	this.edtDS_STREET = this.divData.form.edtDS_STREET;
	this.mskDD_PENALTY = this.divData.form.mskDD_PENALTY;
	
	this.tabData = this.divData.form.tabData;
	
	this.mskAM_ETC_REFUND = this.tabData.tab1.form.mskAM_ETC_REFUND;
	this.mskAM_YEAREND_REFUND = this.tabData.tab1.form.mskAM_YEAREND_REFUND;
	this.mskAM_RETIRE_REFUND = this.tabData.tab1.form.mskAM_RETIRE_REFUND;
	this.mskAM_ILBANRETURN = this.tabData.tab1.form.mskAM_ILBANRETURN;
	this.mskAM_REFUND = this.tabData.tab1.form.mskAM_REFUND;
	this.mskAM_ADD_PAYMENT = this.tabData.tab1.form.mskAM_ADD_PAYMENT;
	this.mskAM_YEAREND_PAYMENT = this.tabData.tab1.form.mskAM_YEAREND_PAYMENT;
	this.mskAM_PENALTY_ADD_PAYMENT = this.tabData.tab1.form.mskAM_PENALTY_ADD_PAYMENT;
	this.mskAM_RETURNTAXSUM = this.tabData.tab1.form.mskAM_RETURNTAXSUM;
	this.mskAM_PAYMENT = this.tabData.tab1.form.mskAM_PAYMENT;
	this.mskAM_PENALTY_DEF = this.tabData.tab1.form.mskAM_PENALTY_DEF;

	
	this.mskAM_PENALTY_DATE = this.tabData.tab1.form.mskAM_PENALTY_DATE;
	this.mskAM_PENALTY_ADD_PAYMENT2 = this.tabData.tab1.form.mskAM_PENALTY_ADD_PAYMENT2;
	this.tclDT_PENALTY_ADD = this.tabData.tab1.form.tclDT_PENALTY_ADD;
	this.mskAM_PENALTY_DEFAULT = this.tabData.tab1.form.mskAM_PENALTY_DEFAULT;
	this.mskAM_PENALTY_ADD_DEFAULT = this.tabData.tab1.form.mskAM_PENALTY_ADD_DEFAULT;
	this.mskAM_PENALTY_ADD_ADD = this.tabData.tab1.form.mskAM_PENALTY_ADD_ADD;
	this.mskDD_PENALTY_ADD = this.tabData.tab1.form.mskDD_PENALTY_ADD;
	this.mskAM_PENALTY = this.tabData.tab1.form.mskAM_PENALTY;
	this.mskAM_PENALTY_MON = this.tabData.tab1.form.mskAM_PENALTY_MON;
	this.mskAM_PENALTY_ADD = this.tabData.tab1.form.mskAM_PENALTY_ADD;
	
	this.mskAM_REFUND_BEF = this.tabData.tab1.form.mskAM_REFUND_BEF;
	this.mskAM_REFUND_MON = this.tabData.tab1.form.mskAM_REFUND_MON;
	this.mskAM_REFUND_SUM = this.tabData.tab1.form.mskAM_REFUND_SUM;
	this.mskAM_REFUND_JOJUNG = this.tabData.tab1.form.mskAM_REFUND_JOJUNG;
	this.mskAM_REFUND_BALANCE = this.tabData.tab1.form.mskAM_REFUND_BALANCE;	
	
	this.mskAM_AMOUNT_PAY = this.tabData.tab1.form.mskAM_AMOUNT_PAY;	
	this.mskAM_BALANCE = this.tabData.tab1.form.mskAM_BALANCE;	
	
	this.dxGrid = this.tabData.tab1.form.objGrid;
	this.dxGrid2 = this.tabData.tab2.form.objGrid2;	
	
	this.getDataFlag = false;	
	this.rowSum = 0; 
	this.rowPenalty = 0;
	this.rowBalance = 0;
	this.rowAmountPay = 0;
};

/************************************************************************
 * 이벤트 설정
 ************************************************************************/
this.fnSetEvent = function() {

	this.ccfCD_CORP.CodeFindName = "DHX_CFCORP";
	this.ccfCD_CORP.BeforeUserDataSetParam = "fnBeforeUserDataSetParam";
	this.ccfCD_CORP.AfterCDTextChanged = "fnAfterCDTextChanged";
	
	this.gfnGridInit(this.dxGrid, this.dsListDetail, "DH", "DHV_LOCALTAX_DETAIL");
	this.gfnGridInit(this.dxGrid2, this.dsListAdjust, "DH", "DHV_LOCALTAX_ADJUST");	

	this.dxGrid.setFormatRowProperty(0, "size", 27);
	this.dxGrid.setFormatRowProperty(1, "size", 24);
	this.dxGrid2.setFormatRowProperty(0, "size", 27);
	this.dxGrid2.setFormatRowProperty(1, "size", 24);
	
	this.dxGrid.BeforeUserDataSetParam = "fnGrid_BeforeUserDataSetParam";
	this.dxGrid2.BeforeUserDataSetParam = "fnGrid_BeforeUserDataSetParam";		
	
	//헤더 클릭 이벤트 삭제(소팅 막기 위해 처리)
	this.dxGrid.removeEventHandlerLookup("onheadclick", "gfnGrid_onheadclick", this);
	//헤더 클릭 이벤트 삭제(소팅 막기 위해 처리)
	this.dxGrid2.removeEventHandlerLookup("onheadclick", "gfnGrid_onheadclick", this);
	
};

/************************************************************************
 * 파라미터 설정
 ************************************************************************/
this.fnSetParameter = function() {
		
	//
	this.dsSelect = new Dataset();
	this.dsSelect.addColumn("CD_CORP", "string");
	this.dsSelect.addColumn("NO_ID", "string");

	this.dsSaveDetail = new Dataset();
	this.dsSaveDetail.addColumn("CD_CORP", "string");
	this.dsSaveDetail.addColumn("NO_ID", "string");
	this.dsSaveDetail.addColumn("CD_INCOME", "string");
	this.dsSaveDetail.addColumn("NO_TAX", "int");
	this.dsSaveDetail.addColumn("AM_TAXBASE", "bigdecimal");
	this.dsSaveDetail.addColumn("AM_TAX", "bigdecimal");
	this.dsSaveDetail.addColumn("ID_USER", "string");

	this.dsSaveAdjust = new Dataset();
	this.dsSaveAdjust.addColumn("CD_CORP", "string");
	this.dsSaveAdjust.addColumn("NO_ID", "string");
	this.dsSaveAdjust.addColumn("CD_INCOME", "string");
	this.dsSaveAdjust.addColumn("DT_PAY", "string");
	this.dsSaveAdjust.addColumn("AM_TAXBASE", "bigdecimal");
	this.dsSaveAdjust.addColumn("AM_TAX", "bigdecimal");
	this.dsSaveAdjust.addColumn("AM_BALANCE", "bigdecimal");
	this.dsSaveAdjust.addColumn("AM_ADJUST_PAY", "bigdecimal");
	this.dsSaveAdjust.addColumn("DS_NOTE", "string");
	this.dsSaveAdjust.addColumn("ID_USER", "string");

	this.dsSave = new Dataset();
	this.dsSave.addColumn("CD_CORP", "string");
	this.dsSave.addColumn("NO_ID", "string");
	this.dsSave.addColumn("CD_PAYMENT", "string");
	this.dsSave.addColumn("CD_WORK", "string");
	this.dsSave.addColumn("YM_WORK", "string");
	this.dsSave.addColumn("YM_PAYMENT", "string");
	this.dsSave.addColumn("DT_NOTIFY", "string");
	this.dsSave.addColumn("DT_DELIVERY", "string");
	this.dsSave.addColumn("DT_PAY", "string");
	this.dsSave.addColumn("RT_TAX", "int");
	this.dsSave.addColumn("AM_TAXBASE", "bigdecimal");
	this.dsSave.addColumn("AM_TAX", "bigdecimal");
	this.dsSave.addColumn("CD_PENALTY", "string");
	this.dsSave.addColumn("AM_PENALTY_DATE", "bigdecimal");
	this.dsSave.addColumn("DD_PENALTY", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY", "bigdecimal");
	this.dsSave.addColumn("DS_NOTE", "string");
	this.dsSave.addColumn("AM_ETC_REFUND", "bigdecimal");
	this.dsSave.addColumn("AM_ADD_PAYMENT", "bigdecimal");
	this.dsSave.addColumn("AM_YEAREND_REFUND", "bigdecimal");
	this.dsSave.addColumn("AM_RETIRE_REFUND", "bigdecimal");
	this.dsSave.addColumn("AM_YEAREND_PAYMENT", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_ADD_PAYMENT", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_DEFAULT", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_ADD_DEFAULT", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_ADD_ADD", "bigdecimal");
	this.dsSave.addColumn("DT_PENALTY_ADD", "string");
	this.dsSave.addColumn("DD_PENALTY_ADD", "int");
	this.dsSave.addColumn("AM_REFUND", "bigdecimal");
	this.dsSave.addColumn("AM_PAYMENT", "bigdecimal");
	this.dsSave.addColumn("AM_BALANCE", "bigdecimal");
	this.dsSave.addColumn("AM_AMOUNT_PAY", "bigdecimal");
	this.dsSave.addColumn("AM_LOCAL_PAY", "bigdecimal");
	this.dsSave.addColumn("AM_ADD_PAY", "bigdecimal");
	this.dsSave.addColumn("AM_REFUND_BALANCE", "bigdecimal");
	this.dsSave.addColumn("AM_REFUND_BEF", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_MON", "bigdecimal");
	this.dsSave.addColumn("AM_PENALTY_ADD", "bigdecimal");
	this.dsSave.addColumn("ID_USER", "string");
	
	// 마감처리 
	this.dsClose = new Dataset();
	this.dsClose.addColumn("CD_CORP", "string");
	this.dsClose.addColumn("NO_ID", "string");
	this.dsClose.addColumn("YN_CLOSE", "string");
	this.dsClose.addColumn("ID_USER", "string");
	
	this.dsESingo = new Dataset();
	this.dsESingo.addColumn("CD_CORP", "string");
	this.dsESingo.addColumn("NO_ID", "string");
}

/************************************************************************
 * 컨트롤 이벤트
 ************************************************************************/
 /*
  *	조회 버튼
  */
this.fnSelect = function() {

	if (!this.fnSelectValidate()) return false;
		
	this.dsList.clearData();
	this.gfnGridBeforeSelect(this.dxGrid);
	this.gfnGridBeforeSelect(this.dxGrid2);
	
	this.dsSelect.clearData();
	this.dsSelect.addRow();
	
	this.dsSelect.setColumn(0, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP"));
	this.dsSelect.setColumn(0, "NO_ID", this.dsSearch.getColumn(0, "NO_ID"));
	
	var strSvcId    = "select";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select=dsSelect";
	var outData     = "dsList=select0 dsListDetail=select1 dsListAdjust=select2";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
						
}

/*
 *	입력 버튼
 */
this.fnAdd = function(obj:nexacro.NormalDataset) {
}

/*
 *	삭제 버튼
 */
this.fnDel = function() {
}

/*
 *	저장 버튼
 */
this.fnSave = function() {

	if (!this.fnSaveValidate()) return false;

	this.dxGrid.updateToDataset();
 	this.dxGrid2.updateToDataset();

	this.dsSave.clearData();
 	this.dsSaveDetail.clearData();
	this.dsSaveAdjust.clearData();	
	
    if(this.gfnGetFormStatus(this) == "U") {

		nrow = this.dsSave.addRow();
		this.dsSave.setColumn(nrow, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP"));
		this.dsSave.setColumn(nrow, "NO_ID", this.dsSearch.getColumn(0, "NO_ID"));
		this.dsSave.setColumn(nrow, "CD_PAYMENT", this.dsList.getColumn(0, "CD_PAYMENT"));
		this.dsSave.setColumn(nrow, "CD_WORK", this.dsList.getColumn(0, "CD_WORK"));
		this.dsSave.setColumn(nrow, "YM_WORK", this.dsList.getColumn(0, "YM_WORK"));
		this.dsSave.setColumn(nrow, "YM_PAYMENT", this.dsList.getColumn(0, "YM_PAYMENT"));
		this.dsSave.setColumn(nrow, "DT_NOTIFY", this.dsList.getColumn(0, "DT_NOTIFY"));
		this.dsSave.setColumn(nrow, "DT_DELIVERY", this.dsList.getColumn(0, "DT_DELIVERY"));
		this.dsSave.setColumn(nrow, "DT_PAY", this.dsList.getColumn(0, "DT_PAY"));
		this.dsSave.setColumn(nrow, "RT_TAX", this.dsList.getColumn(0, "RT_TAX"));
		this.dsSave.setColumn(nrow, "AM_TAXBASE", this.dsList.getColumn(0, "AM_TAXBASE"));
		this.dsSave.setColumn(nrow, "AM_TAX", this.dsList.getColumn(0, "AM_TAX"));
		this.dsSave.setColumn(nrow, "CD_PENALTY", this.dsList.getColumn(0, "CD_PENALTY"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_DATE", this.dsList.getColumn(0, "AM_PENALTY_DATE"));
		this.dsSave.setColumn(nrow, "DD_PENALTY", this.dsList.getColumn(0, "DD_PENALTY"));
		this.dsSave.setColumn(nrow, "AM_PENALTY", this.dsList.getColumn(0, "AM_PENALTY"));
		this.dsSave.setColumn(nrow, "DS_NOTE", this.dsList.getColumn(0, "DS_NOTE"));
		this.dsSave.setColumn(nrow, "AM_ETC_REFUND", this.dsList.getColumn(0, "AM_ETC_REFUND"));
		this.dsSave.setColumn(nrow, "AM_ADD_PAYMENT", this.dsList.getColumn(0, "AM_ADD_PAYMENT"));
		this.dsSave.setColumn(nrow, "AM_YEAREND_REFUND", this.dsList.getColumn(0, "AM_YEAREND_REFUND"));
		this.dsSave.setColumn(nrow, "AM_RETIRE_REFUND", this.dsList.getColumn(0, "AM_RETIRE_REFUND"));
		this.dsSave.setColumn(nrow, "AM_YEAREND_PAYMENT", this.dsList.getColumn(0, "AM_YEAREND_PAYMENT"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_ADD_PAYMENT", this.dsList.getColumn(0, "AM_PENALTY_ADD_PAYMENT"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_DEFAULT", this.dsList.getColumn(0, "AM_PENALTY_DEFAULT"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_ADD_DEFAULT", this.dsList.getColumn(0, "AM_PENALTY_ADD_DEFAULT"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_ADD_ADD", this.dsList.getColumn(0, "AM_PENALTY_ADD_ADD"));
		this.dsSave.setColumn(nrow, "DT_PENALTY_ADD", this.dsList.getColumn(0, "DT_PENALTY_ADD"));
		this.dsSave.setColumn(nrow, "DD_PENALTY_ADD", this.dsList.getColumn(0, "DD_PENALTY_ADD"));
		this.dsSave.setColumn(nrow, "AM_REFUND", this.dsList.getColumn(0, "AM_REFUND"));
		this.dsSave.setColumn(nrow, "AM_PAYMENT", this.dsList.getColumn(0, "AM_PAYMENT"));
		this.dsSave.setColumn(nrow, "AM_BALANCE", this.dsList.getColumn(0, "AM_BALANCE"));
		this.dsSave.setColumn(nrow, "AM_AMOUNT_PAY", this.dsList.getColumn(0, "AM_AMOUNT_PAY"));
		this.dsSave.setColumn(nrow, "AM_LOCAL_PAY", this.dsList.getColumn(0, "AM_LOCAL_PAY"));
		this.dsSave.setColumn(nrow, "AM_ADD_PAY", this.dsList.getColumn(0, "AM_ADD_PAY"));
		this.dsSave.setColumn(nrow, "AM_REFUND_BALANCE", this.dsList.getColumn(0, "AM_REFUND_BALANCE"));
		this.dsSave.setColumn(nrow, "AM_REFUND_BEF", this.dsList.getColumn(0, "AM_REFUND_BEF"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_MON", this.dsList.getColumn(0, "AM_PENALTY_MON"));
		this.dsSave.setColumn(nrow, "AM_PENALTY_ADD", this.dsList.getColumn(0, "AM_PENALTY_ADD"));
		this.dsSave.setColumn(nrow, "ID_USER", this.AuthClient.ID_USER);
		
	}	
	
	for(var i = 0 ; i < this.dsListDetail.rowcount ; i ++) {	

		if(this.gfnGetFlag(this.dsListDetail, i) == "U") {

			nrow = this.dsSaveDetail.addRow();
		
			this.dsSaveDetail.setColumn(nrow, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP"));
			this.dsSaveDetail.setColumn(nrow, "NO_ID", this.dsSearch.getColumn(0, "NO_ID"));
			this.dsSaveDetail.setColumn(nrow, "CD_INCOME", this.dsListDetail.getColumn(i, "CD_CODE"));
			this.dsSaveDetail.setColumn(nrow, "NO_TAX", this.dsListDetail.getColumn(i, "NO_TAX"));
			this.dsSaveDetail.setColumn(nrow, "AM_TAXBASE", this.dsListDetail.getColumn(i, "AM_TAXBASE"));
			this.dsSaveDetail.setColumn(nrow, "AM_TAX", this.dsListDetail.getColumn(i, "AM_TAX"));
			this.dsSaveDetail.setColumn(nrow, "ID_USER", this.AuthClient.ID_USER);			
		}
	}
	
	
	for(var i = 0 ; i < this.dsListAdjust.rowcount ; i ++) {	
		if(this.gfnGetFlag(this.dsListAdjust, i) == "U" || this.gfnGetFlag(this.dsListAdjust, i) == "I") {
		
			nrow = this.dsSaveAdjust.addRow();			
			this.dsSaveAdjust.setColumn(nrow, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP"));
			this.dsSaveAdjust.setColumn(nrow, "NO_ID", this.dsSearch.getColumn(0, "NO_ID"));
			this.dsSaveAdjust.setColumn(nrow, "CD_INCOME", this.dsListAdjust.getColumn(i, "CD_CODE"));
			this.dsSaveAdjust.setColumn(nrow, "DT_PAY", this.dsListAdjust.getColumn(i, "DT_PAY"));
			this.dsSaveAdjust.setColumn(nrow, "AM_TAXBASE", this.dsListAdjust.getColumn(i, "AM_TAXBASE"));
			this.dsSaveAdjust.setColumn(nrow, "AM_TAX", this.dsListAdjust.getColumn(i, "AM_TAX"));
			this.dsSaveAdjust.setColumn(nrow, "AM_BALANCE", this.dsListAdjust.getColumn(i, "AM_BALANCE"));
			this.dsSaveAdjust.setColumn(nrow, "AM_ADJUST_PAY", this.dsListAdjust.getColumn(i, "AM_ADJUST_PAY"));
			this.dsSaveAdjust.setColumn(nrow, "DS_NOTE", this.dsListAdjust.getColumn(i, "DS_NOTE"));
			this.dsSaveAdjust.setColumn(nrow, "ID_USER", this.AuthClient.ID_USER);
		}
	}

	
	if(this.dsSave.rowcount == 0 && this.dsSaveDetail.rowcount == 0 && this.dsSaveAdjust.rowcount == 0 ) return;
	
	var strSvcId    = "save";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = "savedetail=dsSaveDetail saveadjust=dsSaveAdjust save=dsSave";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
}


/*
 *	엑셀 버튼
 */
this.fnExcel = function() {
	switch(this.tabData.tabindex) {
		case 0:
			this.gfnExcelExport(this.dxGrid);
			break;
		case 1:
			this.gfnExcelExport(this.dxGrid2);
			break;
	}
}

/*
 *	출력 버튼
 */
this.fnPrint = function() {
}

/************************************************************************
 * Validate
 ************************************************************************/
/*
 *	조회 Validate
 */
this.fnSelectValidate = function() {

	if(this.gfnIsNull(this.ccfCD_CORP.form.CDTextBox.value)) {
		this.gfnAlert("법인코드를 입력하세요!");
		return false;
	}
	
	if(this.gfnIsNull(this.edtNO_ID.value)) {
		this.gfnAlert("문서번호를 입력하세요!");
		return false;
	}
	
	return true;
};

this.fnSaveValidate = function() {
	var strMsg = "";
	var ret = true;
	
	if(this.rdoSINGO.index == -1) {
		strMsg += "구분을 선택해 주십시오.\n";
		ret = false;
	}
	
	if(this.rdoTY_WORK.index == -1) {
		strMsg += "신고구분을 선택해 주십시오.\n";
		ret = false;
	}
	
	if(this.gfnIsNull(this.ctclYM_PAYMENT.form.TextBox.value)) {
		strMsg += "지급연월을 입력하여 주십시오.\n";
		ret = false;
	}
	
	if(this.gfnIsNull(this.ctclYM_WORK.form.TextBox.value)) {
		strMsg += "귀속연월을 입력하여 주십시오.\n";
		ret = false;
	}
	
	if(this.gfnIsNull(this.ccfDT_NOTIFY.value)) {
		strMsg += "신고기한을 입력하여 주십시오.\n";
		ret = false;
	}	
		
	if(this.gfnIsNull(this.ccfDT_DELIVERY.value)) {
		strMsg += "제출일자를 입력하여 주십시오.\n";
		ret = false;
	}
	
	if(ret == false) {
		this.gfnAlert(strMsg);
		return false;
	}
	
	return true;	
}

this.dxGridValidate = function(row, colId) {

	//this.dxGrid.updateToDataset();
	
	//if(this.dsList.rowcount < row ) return true;

	this.sbAmSum(colId);
	return true;
}

this.dxGrid2Validate = function(row, colId) {

	this.dxGrid.updateToDataset();
	
	//if(this.dsListDetail.rowcount < row || this.gfnIsNull(this.dsListDetail.getColumn(row, colId))) return true;
	//if(this.dsListDetail.rowcount < row) return true;
	if(colId == "AM_TAXBASE" || colId == "AM_TAX" ) 
	{
		this.sbAmSumDetail(row, colId);
	}
	
	return true;
}

this.dxGrid3Validate = function(row, colId) {

	this.dxGrid2.updateToDataset();
	
	//if(this.dsListAdjust.rowcount < row || this.gfnIsNull(this.dsListAdjust.getColumn(row, colId))) return true;
	
	if(this.dsListAdjust.getColumn(row, colId).length >= 15) {
		this.dsListAdjust.setColumn(row, colId, "0");
		return false;
	}
	
	
	if(colId == "AM_TAX" || colId == "AM_BASETAX" || colId == "AM_BALANCE" || colId == "AM_ADJUST_PAY" )
	{
		this.sbAmSumAdjust(row, colId);	
	}
		
	return true;
}

/************************************************************************
 * 콜백 이벤트
 ************************************************************************/
this.fnCallback = function(svcID, errorCode, errorMsg) {

	if (errorCode != 0) {
		this.gfnAlert(errorMsg);
		return;
	}
	
	if(svcID == "select") {
		this.gfnGridAfterSelect(this.dxGrid);
		this.gfnGridAfterSelect(this.dxGrid2);		
		
		if (this.dsListDetail.rowcount > 0 )
		{
			this.setGirdColor();
			this.rowSum = this.dsListDetail.findRow("CD_CODE", "95");
			this.rowPenalty = this.dsListDetail.findRow("CD_CODE", "96");
			this.rowBalance = this.dsListDetail.findRow("CD_CODE", "97");
			this.rowAmountPay = this.dsListDetail.findRow("CD_CODE", "99");
		}
		this.fnReadOnly();
	}
	
	if(svcID == "save") {
		if (errorCode == 0) {
			this.FormBtns.Select.click();
		} else {
			this.gfnAlert(errorMsg);
		}
	}
		
	if(svcID == "close") {
		if (errorCode == 0) {
			this.FormBtns.Select.click();
		} else {
			this.gfnAlert(errorMsg);
		}
	}	
	
	if(svcID == "ESingo") {
		if(errorCode == 0) {
			this.fnFileDownload();
		}
		else {
			this.gfnAlert(errorMsg);
		}
	}		
	
	if (svcID == "selectrate")
	{
		if (errorCode == 0) {
			
		} else {
			this.gfnAlert(errorMsg);
		}
	}
}


/************************************************************************
 * 코드파인드 이벤트
 ************************************************************************/
this.fnBeforeUserDataSetParam = function(id, dsUserParam, nrow) {	
	if (id == "ccfCD_CORP") {
		dsUserParam.setColumn(nrow, "ID_SABUN", this.AuthClient.ID_USER);
	}
	return true;
};

this.fnAfterCDTextChanged = function(id, codeFindData) {
	
}

this.dsSearch_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo) {
	
	if(e.oldvalue != e.newvalue) {	
		this.gfnSetFormStatus(this);	// 폼상태 초기화
		this.clearDivData();
	}	
}
 
/************************************************************************
 * 기타 이벤트
 ************************************************************************/ 
 
 this.fnSetCombo = function(){	
	
	this.dsSelectRate = new Dataset();
	this.dsSelectRate.addColumn("DT_DATE", "string");
	this.dsSelectRate.addColumn("TY_GUBUN", "string");
	
	this.dsSelectRate.clearData();
	this.dsSelectRate.addRow();	
	this.dsSelectRate.setColumn(0, "DT_DATE", this.gfnGetDate());
	this.dsSelectRate.setColumn(0, "TY_GUBUN", "LOCALTAX");
	
	var strSvcId    = "selectrate";
	var strSvcType  = "select";
	var inProc		= "_dsProc";
	var inData      = "selectrate=dsSelectRate";
	var outData     = "dsRate=selectrate0";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
 
 }
 
this.clearDivData = function() {

	this.dsList.clearData();
	this.dsListDetail.clearData();
	this.dsListAdjust.clearData();

	//this.ccfDT_ENTER.set_value("");
	
}

// 납부서 금액 sum 
this.sbAmSum = function(colId) {	
	
	// 가산세 추가 대상액 입력시 
	if(colId == "AM_PENALTY_ADD_PAYMENT" ) {
		var amPenaltyAdd = this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_ADD_PAYMENT"), 0 );
		var amPenaltyDefault = Math.floor(Number(amPenaltyAdd) * this.dsRate.getColumn(0, "RT_PANELTY")/100/10) * 10; // 정액 가산세 3% 
		
		this.dsList.setColumn(0, "AM_PENALTY_ADD_DEFAULT", amPenaltyDefault); 
		
		if (!this.gfnIsNull(this.dsList.getColumn(0, "DT_PENALTY_ADD")))
		{
			
			var dayPenaltyAdd = this.gfnGetDiffDate(this.dsList.getColumn(0, "DT_PENALTY_ADD") , this.dsList.getColumn(0, "DT_NOTIFY")); // 정액 가산세 
			if (dayPenaltyAdd >0 )
			{
				var amPenaltyDataAdd = Math.floor(amPenaltyAdd * dayPenaltyAdd * this.dsRate.getColumn(0, "RT_PANELTY_DAY")/10)*10 ;  // 추가납부금 기간지연 가산세 0.00022
											
				this.dsList.setColumn(0, "AM_PENALTY_ADD_ADD", amPenaltyDataAdd); 
				this.dsList.setColumn(0, "DD_PENALTY_ADD" , dayPenaltyAdd);
				
				var amAddPenaltySum = amPenaltyDefault + amPenaltyDataAdd;
				var amAddPenaltyLimit = Math.floor(amPenaltyAdd * this.dsRate.getColumn(0, "RT_PANELTY_LIMIT")/100/10) * 10; // 추가가산세 한도액 10%
				
				this.dsList.setColumn(0, "AM_PENALTY_ADD" , amAddPenaltySum > amAddPenaltyLimit ? amAddPenaltyLimit : amAddPenaltySum); 
				
			} else {
				this.dsList.setColumn(0, "AM_PENALTY_ADD_ADD", 0); 
				this.dsList.setColumn(0, "DD_PENALTY_ADD" , 0);
				this.dsList.setColumn(0, "AM_PENALTY_ADD" , 0); 
			}

		}
	}
	
	if(colId == "DT_PENALTY_ADD" ) {

		var dayPenaltyAdd = this.gfnGetDiffDate(this.dsList.getColumn(0, "DT_PENALTY_ADD") , this.dsList.getColumn(0, "DT_NOTIFY"));
		// trace(" sbAmSum : dayPenaltyAdd =>" + dayPenaltyAdd);
		this.dsList.setColumn(0, "DD_PENALTY_ADD" , dayPenaltyAdd > 0 ? dayPenaltyAdd : 0 );

		if (this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_ADD_PAYMENT"),0) != 0 && dayPenaltyAdd > 0)
		{						
			var amPenaltyAdd = this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_ADD_PAYMENT"),0);
			
			var amAddPenaltyDefault = this.dsList.getColumn(0, "AM_PENALTY_ADD_DEFAULT");
			
			var amPenaltyDataAdd = Math.floor(amPenaltyAdd * dayPenaltyAdd * this.dsRate.getColumn(0, "RT_PANELTY_DAY")/10)*10 ;  // 추가납부금 기간지연 가산세 
			
			this.dsList.setColumn(0, "AM_PENALTY_ADD_ADD", amPenaltyDataAdd); 
			
			var amAddPenaltySum = amAddPenaltyDefault + amPenaltyDataAdd;
			var amAddPenaltyLimit = Math.floor(amPenaltyAdd * this.dsRate.getColumn(0, "RT_PANELTY_LIMIT")/100/10) * 10; // 추가가산세 한도액 
				
			this.dsList.setColumn(0, "AM_PENALTY_ADD" , amAddPenaltySum > amAddPenaltyLimit ? amAddPenaltyLimit : amAddPenaltySum); 
			
		} else {
			this.dsList.setColumn(0, "AM_PENALTY_ADD_ADD", 0); 	
			this.dsList.setColumn(0, "AM_PENALTY_ADD",0);
		}
		
	}
	
	// 당월 가산세 계산 
	trace(" sbAmSum=>" + colId);
	if(colId == "DT_DELIVERY"|| colId == "DT_NOTIFY" || colId == "AM_TAX" || colId == "AM_ETC_REFUND" || colId == "AM_YEAREND_REFUND" || 
		colId == "AM_RETIRE_REFUND" || colId == "AM_ADD_PAYMENT" || colId == "AM_YEAREND_PAYMENT" || colId == "AM_REFUND_BEF") {
		if (!this.gfnIsNull(this.dsList.getColumn(0, "DT_DELIVERY")))
		{
			trace(" fnSetPenaltyNow=>" + colId);
			this.fnSetPenaltyNow();
		}
	}
	
	//가산세 합계액
	this.dsListDetail.set_enableevent(false);
	var amTemp 	= Number(this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_MON"),0)) +
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_ADD"),0)) ;
	this.dsList.setColumn(0, "AM_PENALTY", amTemp);
	this.dsListDetail.setColumn(this.rowPenalty, "AM_TAX", amTemp);
	
	trace(" amTemp=>" + amTemp);

	//환급액 총계 
	var amRefund =  Number(this.gfnNvl(this.dsList.getColumn(0, "AM_ETC_REFUND"),0)) +
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_YEAREND_REFUND"),0)) + 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_RETIRE_REFUND"),0)) + 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_REFUND_BEF"),0));
	this.dsList.setColumn(0, "AM_REFUND", amRefund);
	
	trace(" amRefund=>" + amRefund);

	//납부액 총계 
	var	amPayment  = Number(this.gfnNvl(this.dsList.getColumn(0, "AM_ADD_PAYMENT"),0)) +
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_YEAREND_PAYMENT"),0)) + 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY_ADD_PAYMENT"),0));
	this.dsList.setColumn(0, "AM_PAYMENT", amPayment);
	
	trace(" amPayment=>" + amPayment);
	
	//가감총계 
	var amBalance = amPayment - amRefund; 
	
	this.dsList.setColumn(0,"AM_BALANCE", amBalance);
	//this.dsListDetail.setColumn(this.rowAmountPay, "AM_TAX", amAmountPay);
	
	//납부총금액 	
	this.fnGetTotal(); 
	
	this.dsListDetail.set_enableevent(true);
}
//가산세 계산 
this.fnSetPenaltyNow = function(){

	var dayPenalty = this.gfnGetDiffDate(this.dsList.getColumn(0, "DT_NOTIFY") ,this.dsList.getColumn(0, "DT_DELIVERY")); // 지연일수 
	
	var amTaxSum = this.gfnNvl(this.dsList.getColumn(0, "AM_TAX"),0) - 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_ETC_REFUND"),0)) -
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_YEAREND_REFUND"),0)) -
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_REFUND_BEF"),0)) - 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_RETIRE_REFUND"),0)) + 
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_ADD_PAYMENT"),0)) +
					Number(this.gfnNvl(this.dsList.getColumn(0, "AM_YEAREND_PAYMENT"),0));
					
	if (dayPenalty > 0 && amTaxSum > 0) {
				 
		trace(" fnSetPenaltyNow : amTaxSum =>" + amTaxSum);
		trace(" fnSetPenaltyNow : AM_TAX =>" + this.gfnNvl(this.dsList.getColumn(0, "AM_TAX"),0));
		var amPenaltyDefault = Math.floor(Number(amTaxSum) * this.dsRate.getColumn(0, "RT_PANELTY")/100/10) * 10; 	// 정액 가산세 3%
		
		var amPenaltyData = Math.floor(amTaxSum * dayPenalty * this.dsRate.getColumn(0, "RT_PANELTY_DAY")/10)*10  ;  // 추가납부금 기간지연 가산세 0.00022
		
		var amPenaltySum = amPenaltyDefault + amPenaltyData;   // 당월 가산세 합계 
		var amPenaltyLimit = Math.floor(Number(amTaxSum) * this.dsRate.getColumn(0, "RT_PANELTY_LIMIT")/100/10) * 10; // 가산세 한도액 = 지방세 * 10%
		
		this.dsList.setColumn(0, "AM_PENALTY_DEFAULT", amPenaltyDefault); 
		this.dsList.setColumn(0, "AM_PENALTY_DATE", amPenaltyData); 
		this.dsList.setColumn(0, "DD_PENALTY" , dayPenalty);
		this.dsList.setColumn(0, "AM_PENALTY_MON" , amPenaltySum > amPenaltyLimit ? amPenaltyLimit : amPenaltySum);
		
	} else {		
		this.dsList.setColumn(0, "AM_PENALTY_DEFAULT", 0); 
		this.dsList.setColumn(0, "AM_PENALTY_DATE", 0); 
		this.dsList.setColumn(0, "DD_PENALTY" , 0);
		this.dsList.setColumn(0, "AM_PENALTY_MON" , 0);
	}	
	this.sbAmSum();
}

this.fnGetTotal = function() {
	//this.dsListDetail.set_enableevent(false);
	//trace(" sumRow=>" + amSum);
	var amSum = this.gfnNvl(this.dsListDetail.getColumn(this.rowSum, "AM_TAX"),0);	
	// 가산세액 
	var amPenalty = this.gfnNvl(this.dsList.getColumn(0, "AM_PENALTY"),0);
	// 가감합계액
	var amBalance  = this.gfnNvl(this.dsList.getColumn(0, "AM_BALANCE"),0);
	// 총납부세액 
	var amAmountPay  = amSum + amPenalty + amBalance;
	// 납부할 지방소득세
	var amLocalPay = amAmountPay - amPenalty ;
	// 차갑후 환급잔액 
	var amRefundBalance = amAmountPay > 0 ? 0 : amAmountPay * -1 ;  
	
	// 합계 값 입력 
	this.dsList.setColumn(0, "AM_TAX", amSum); 
	this.dsList.setColumn(0, "AM_PENALTY", amPenalty); 
	this.dsList.setColumn(0, "AM_BALANCE", amBalance); 
	this.dsList.setColumn(0, "AM_AMOUNT_PAY", amAmountPay); 
	this.dsList.setColumn(0, "AM_LOCAL_PAY", amLocalPay); 
	this.dsList.setColumn(0, "AM_ADD_PAY", amPenalty); 
	this.dsList.setColumn(0, "AM_REFUND_BALANCE", amRefundBalance); 
		
	this.dsListDetail.setColumn(this.rowPenalty, "AM_TAX", amPenalty);
	this.dsListDetail.setColumn(this.rowBalance, "AM_TAX", amBalance);
	this.dsListDetail.setColumn(this.rowAmountPay, "AM_TAX", amAmountPay);
	
	//this.dsListDetail.set_enableevent(true);
} 

// detail 합산 처리 
this.sbAmSumDetail = function(row, colId) {
	
	if(this.gfnIsNull(this.dsListDetail.getColumn(row, "CD_CODE"))) return; 
	
	this.dsListDetail.set_enableevent(false);
	
	var amSum  = 0; 	
	for(var i = 0 ; i < this.rowSum -1 ; i++) {		
		amSum += this.gfnNvl(this.dsListDetail.getColumn(i, colId),0);
	}
	this.dsListDetail.setColumn(this.rowSum, colId , amSum); 
	this.dsList.setColumn(0, colId , amSum); 
	
	this.fnGetTotal();

	this.dsListDetail.set_enableevent(true);
}


// detail 합산 처리 
this.sbAmSumAdjust = function(row, colId) {

	if(this.gfnIsNull(this.dsListAdjust.getColumn(row, "CD_CODE"))) return; 
    
    //this.dsListAdjust.selectRow(sumRow, true);
	
	var sumAdjust = this.dsListAdjust.getSum(colId);
	this.dsListDetail.set_enableevent(false);
	//납부총금액 	
	this.fnGetTotal(); 
	
	this.dsListDetail.set_enableevent(true);
}


this.fnTaxClose = function(obj:nexacro.Button,e:nexacro.ClickEventInfo) { //마감처리 
	
	if(!this.gfnGridIsRow(this.dxGrid)) return;
	
	if(this.gfnGetFormStatus(this) == "U" ) {
		this.gfnAlert("수정중인자료가 있습니다. 저장후 작업하세요.");
		return false;
	}
	
	if( this.dsList.getColumn(0,"YN_CLOSE") != "N" ) {
		this.gfnAlert("마감상태가  '미마감' 상태인 경우만 마감 가능합니다.");
		return false;
	}		

	// 마감처리 
	this.gfnConfirm("마감 처리후에는 수정 불가능합니다. \n마감을 진행하시겠습니까?", "fnCloseCallBack", "Y");	
};

this.fnCancle = function(obj:nexacro.Button,e:nexacro.ClickEventInfo) { //마감취소 처리 
	
	if(!this.gfnGridIsRow(this.dxGrid)) return;
	
	if(this.gfnGetFormStatus(this) == "U" ) {
		this.gfnAlert("수정중인자료가 있습니다. 저장후 작업하세요.");
		return false;
	}
	
	if( this.dsList.getColumn(0,"YN_CLOSE") != "Y" ) {
		this.gfnAlert("마감상태가  '마감' 상태인 경우만 마감취소 가능합니다.");
		return false;
	}		

	// 마감처리 
	this.gfnConfirm("마감취소를 진행하시겠습니까?", "fnCloseCallBack", "N");	
};

this.fnCloseCallBack = function(strId, val) {
	
	if(val == false) return;
	
	this.dsClose.clearData();
	this.dsClose.addRow();
	
	this.dsClose.setColumn(0, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP"));
	this.dsClose.setColumn(0, "NO_ID", this.dsSearch.getColumn(0, "NO_ID"));
	this.dsClose.setColumn(0, "YN_CLOSE", strId);
	this.dsClose.setColumn(0, "ID_USER", this.AuthClient.ID_USER);
	
	var strSvcId    = "close";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = "close=dsClose";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
				
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
} 

this.fnESingo = function() {
	if(!this.gfnGridIsRow(this.dxGrid)) return;

	if(this.gfnGetFormStatus(this) == "U" ) {
		this.gfnAlert("수정중인자료가 있습니다. 저장후 작업하세요.");
		return false;
	}
	param = {};
	param.CD_CORP = this.dsSearch.getColumn(0, "CD_CORP");
	param.NO_ID = this.dsSearch.getColumn(0, "NO_ID");
	
	this.gfnFormOpen(this.FormInfo.CD_MODULE, "DHV_LOCALTAX_FILE_DLG", "fnPopupCallback", param);
	//this.gfnConfirm("전자 신고 작업을 진행하시겠습니까?", "fnESingoCallBack");
};

this.fnPopupCallback = function(strId, val) {
	if (val)
	{
		this.FormBtns.Select.click();
	}
}

this.fnESingoCallBack = function(strId, val) {
	if(!val) return;
	
	//전자신고

	this.dsESingo.clearData();		
	var nrow = this.dsESingo.addRow();
	
	this.dsESingo.setColumn(nrow, "CD_CORP", this.dsSearch.getColumn(0, "CD_CORP")); //   IN      VARCHAR2,      -- 법인코드
	this.dsESingo.setColumn(nrow, "NO_ID", this.dsSearch.getColumn(0, "NO_ID")); 									//   IN      VARCHAR2,      -- 귀속년월
	
	//trace(this.dsESingo.saveXML());		
	
	var strSvcId    = "ESingo";
	var strSvcType  = "select";
	var inProc		= "_dsProc";
	var inData      = "ESingo=dsESingo";
	var outData     = "dsText=ESingo0";
	var strArg      = "";
	var callBackFnc = "fnCallback";

	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
					strSvcType , 	// transaction을 요청할 구분
					inProc,			// Procedure 정보 Dataset 이름
					inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
					outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
					strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
					callBackFnc); // 통신방법 정의 [생략가능]	
}

this.fnFileDownload = function () {

	if (this.dsText.rowcount <= 0) {
		return false;
	}

	var data="";
	for(var i=0;i<this.dsText.rowcount;i++){
		data = data + this.dsText.getColumn(i,"ROWDATA");
		if(i == this.dsText.rowcount -1){
			;
		}else{
			data = data + "\n";
		}
	}
	trace("data==>", data);
	//파일 명명규칙  : 작성일자 + 서식코드(7) + 자료구분(1) 
	var sFilename = this.gfnGetDate()+"A103900.1"; //yyyyMMdd(오늘날짜)A103900.01
	var sFilecont = data;
	var encodeFileName = encodeURIComponent(sFilename);
		
	var surl = this.fileConfig.host+ this.fileConfig.downloadUrl; // + encodeFileName;
	this.FileDownTransfer00.set_url(surl);
	this.FileDownTransfer00.setPostData("fileCont", sFilecont);
	this.FileDownTransfer00.setPostData("fileName", encodeFileName);
	this.FileDownTransfer00.setPostData("fileEncoding", "EUC-KR");
	
	if( system.navigatorname =="nexacro"){
		this.FileDownTransfer00.set_downloadfilename(sFilename);
	}
	this.FileDownTransfer00.download();
}

this.fnReadOnly = function() {
	var ynClose = this.dsList.getColumn(0, "YN_CLOSE");
	
	if(ynClose == "Y") {
	
		this.FormBtns.Add.set_enable(false); 
		this.FormBtns.Del.set_enable(false); 
		this.FormBtns.Save.set_enable(false);		
		this.btnClose.set_enable(false);
		this.btnCancle.set_enable(true);
		this.btnESingo.set_enable(true);
	
		this.rdoTY_WORK.set_enable(false); 
		this.ctclYM_WORK.set_enable(false); 
		this.ctclYM_PAYMENT.set_enable(false); 
		this.ccfDT_NOTIFY.set_enable(false); 
		this.ccfDT_DELIVERY.set_enable(false); 
		this.mskDD_PENALTY.set_enable(false); 

		this.mskAM_PENALTY_DATE.set_enable(false);
		this.mskAM_PENALTY_ADD_PAYMENT2.set_enable(false);
		this.mskAM_PENALTY_DEFAULT.set_enable(false);
		this.mskAM_PENALTY_ADD_DEFAULT.set_enable(false);
		this.mskAM_PENALTY_ADD_ADD.set_enable(false);
		this.mskDD_PENALTY_ADD.set_enable(false);
		this.mskAM_ETC_REFUND.set_enable(false);
		this.mskAM_YEAREND_REFUND.set_enable(false);
		this.mskAM_RETIRE_REFUND.set_enable(false);
		this.mskAM_REFUND_BEF.set_enable(false);
		this.mskAM_ADD_PAYMENT.set_enable(false);
		this.mskAM_YEAREND_PAYMENT.set_enable(false);
		this.tclDT_PENALTY_ADD.set_enable(false);
		
	} else {
			
		this.FormBtns.Add.set_enable(true); 
		this.FormBtns.Del.set_enable(true); 
		this.FormBtns.Save.set_enable(true);		
		this.btnClose.set_enable(true);
		this.btnCancle.set_enable(false);
		this.btnESingo.set_enable(true);
		
		this.dsList.set_enableevent(true); 
		
		this.rdoTY_WORK.set_enable(true); 
		this.ctclYM_WORK.set_enable(true); 
		this.ctclYM_PAYMENT.set_enable(true); 
		this.ccfDT_NOTIFY.set_enable(true); 
		this.ccfDT_DELIVERY.set_enable(true); 
		this.mskDD_PENALTY.set_enable(true); 
		
		this.mskAM_PENALTY_DATE.set_enable(true);
		this.mskAM_PENALTY_ADD_PAYMENT2.set_enable(true);
		this.mskAM_PENALTY_DEFAULT.set_enable(true);
		this.mskAM_PENALTY_ADD_DEFAULT.set_enable(true);
		this.mskAM_PENALTY_ADD_ADD.set_enable(true);
		this.mskDD_PENALTY_ADD.set_enable(true);
		this.mskAM_ETC_REFUND.set_enable(true);
		this.mskAM_YEAREND_REFUND.set_enable(true);
		this.mskAM_RETIRE_REFUND.set_enable(true);
		this.mskAM_REFUND_BEF.set_enable(true);
		this.mskAM_ADD_PAYMENT.set_enable(true);
		this.mskAM_YEAREND_PAYMENT.set_enable(true);
		this.tclDT_PENALTY_ADD.set_enable(true);
				
		this.dsListDetail.set_enableevent(true);
		this.dsListAdjust.set_enableevent(true);
		
	}
}
//****************************************************************************
//   그리드 셋팅  
//********************************************************************************
this.setGirdColor = function() {
	this.dsListDetail.set_enableevent(false);
	
	var exprArray = [];
	exprArray.push('(currow >= ' + this.dsListDetail.findRow("CD_CODE", "95") + ' && currow <= ' + this.dsListDetail.findRow("CD_CODE", "99") + ' )');
	
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "NO_TAX"), "cssclass", 'expr: ' + exprArray.join(' || ') + ' ? "BACK_ReadOnly" : ""');
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "NO_TAX"), "edittype", 'expr: ' + exprArray.join(' || ') + ' ? "none" : "mask"');
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "AM_TAXBASE"), "cssclass", 'expr: ' + exprArray.join(' || ') + ' ? "BACK_ReadOnly" : ""');
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "AM_TAXBASE"), "edittype", 'expr: ' + exprArray.join(' || ') + ' ? "none" : "mask"');
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "AM_TAX"), "cssclass", 'expr: ' + exprArray.join(' || ') + ' ? "BACK_ReadOnly" : ""');
	this.dxGrid.setCellProperty("body" , this.dxGrid.getBindCellIndex("body", "AM_TAX"), "edittype", 'expr: ' + exprArray.join(' || ') + ' ? "none" : "mask"');
	
	this.dsListDetail.set_enableevent(true);	
}

this.divData_tabData_onchanged = function(obj:nexacro.Tab,e:nexacro.TabIndexChangeEventInfo) {

	this.fnReadOnly()
};

/************************************************************************
 * 그리드 이벤트
 ************************************************************************/
this.dsList_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{

	//trace("dsList_oncolumnchanged");
	
	if(this.gfnDsIsUpdated(obj)){
		this.dsList.setColumn(e.row, "FLAG" , "U");
		this.gfnSetFormStatus(this, "U");
		this.dxGridValidate(e.row, e.columnid);
	}
};

this.dsListDetail_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
	if(this.gfnDsIsUpdated(obj)){
		trace("dsListDetail_oncolumnchanged!!!!");
		this.dsListDetail.setColumn(e.row, "FLAG" , "U");
		this.gfnSetFormStatus(this, "U");
		this.dxGrid2Validate(e.row, e.columnid);	
	}
};

this.dsListAdjust_oncolumnchanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	
	if(e.oldvalue != e.newvalue) {
		this.dsListAdjust.setColumn(e.row, "FLAG" , "U");
		this.gfnSetFormStatus(this, "U");
		
		this.dxGrid3Validate(e.row, e.columnid);
	}
};

/************************************************************************
 * 기타 이벤트
 ************************************************************************/
this.fn_OnChanged = function(obj:nexacro.MaskEdit,e:nexacro.ChangeEventInfo)
{
	if(e.postvalue != e.prevalue){
		if(this.dsList.rowcount > 0){
			this.gfnSetFormStatus(this, "U");
		}
		//this.sbAmCal();	
	}
};
]]></Script>
    <Objects>
      <Dataset id="dsList" onvaluechanged="dsList_oncolumnchanged">
        <ColumnInfo>
          <Column id="CD_PLACE" type="STRING" size="256"/>
          <Column id="DS_PLACE" type="STRING" size="256"/>
          <Column id="DS_ADDRESS" type="STRING" size="256"/>
          <Column id="DS_STREET" type="STRING" size="256"/>
          <Column id="CD_PAYMENT" type="STRING" size="256"/>
          <Column id="CD_WORK" type="STRING" size="256"/>
          <Column id="YM_WORK" type="STRING" size="256"/>
          <Column id="YM_PAYMENT" type="STRING" size="256"/>
          <Column id="DT_NOTIFY" type="STRING" size="256"/>
          <Column id="DT_DELIVERY" type="STRING" size="256"/>
          <Column id="DT_PAY" type="STRING" size="256"/>
          <Column id="RT_TAX" type="BIGDECIMAL" size="256"/>
          <Column id="AM_TAXBASE" type="BIGDECIMAL" size="256"/>
          <Column id="AM_TAX" type="BIGDECIMAL" size="256"/>
          <Column id="CD_PENALTY" type="STRING" size="256"/>
          <Column id="AM_PENALTY_DATE" type="BIGDECIMAL" size="256"/>
          <Column id="DD_PENALTY" type="INT" size="256"/>
          <Column id="AM_PENALTY" type="BIGDECIMAL" size="256"/>
          <Column id="DS_NOTE" type="STRING" size="256"/>
          <Column id="AM_ETC_REFUND" type="BIGDECIMAL" size="256"/>
          <Column id="AM_ADD_PAYMENT" type="BIGDECIMAL" size="256"/>
          <Column id="AM_YEAREND_REFUND" type="BIGDECIMAL" size="256"/>
          <Column id="AM_RETIRE_REFUND" type="BIGDECIMAL" size="256"/>
          <Column id="AM_YEAREND_PAYMENT" type="BIGDECIMAL" size="256"/>
          <Column id="AM_PENALTY_ADD_PAYMENT" type="BIGDECIMAL" size="256"/>
          <Column id="AM_PENALTY_DEFAULT" type="BIGDECIMAL" size="256"/>
          <Column id="AM_PENALTY_ADD_ADD" type="BIGDECIMAL" size="256"/>
          <Column id="DD_PENALTY_ADD" type="INT" size="256"/>
          <Column id="AM_REFUND" type="BIGDECIMAL" size="256"/>
          <Column id="AM_PAYMENT" type="BIGDECIMAL" size="256"/>
          <Column id="AM_BALANCE" type="BIGDECIMAL" size="256"/>
          <Column id="AM_AMOUNT_PAY" type="BIGDECIMAL" size="256"/>
          <Column id="AM_LOCAL_PAY" type="BIGDECIMAL" size="256"/>
          <Column id="AM_ADD_PAY" type="BIGDECIMAL" size="256"/>
          <Column id="AM_REFUND_BALANCE" type="BIGDECIMAL" size="256"/>
          <Column id="YN_CLOSE" type="STRING" size="256"/>
          <Column id="AM_REFUND_BEF" type="BIGDECIMAL" size="256"/>
          <Column id="AM_REFUND_MON" type="BIGDECIMAL" size="256"/>
          <Column id="AM_REFUND_JOJUNG" type="BIGDECIMAL" size="256"/>
          <Column id="DT_PENALTY_ADD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsListDetail" onvaluechanged="dsListDetail_oncolumnchanged"/>
      <Dataset id="_dsProc">
        <ColumnInfo>
          <Column id="TARGET" type="STRING" size="256"/>
          <Column id="SP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TARGET">select</Col>
            <Col id="SP">DHVPR_LOCALTAX_PAY_SELECT</Col>
          </Row>
          <Row>
            <Col id="TARGET">save</Col>
            <Col id="SP">DHVPR_LOCALTAX_PAY_UPDATE</Col>
          </Row>
          <Row>
            <Col id="TARGET">savedetail</Col>
            <Col id="SP">DHVPR_LOCALTAX_DETAIL_UPDATE</Col>
          </Row>
          <Row>
            <Col id="TARGET">saveadjust</Col>
            <Col id="SP">DHVPR_LOCALTAX_ADJUST_UPDATE</Col>
          </Row>
          <Row>
            <Col id="TARGET">close</Col>
            <Col id="SP">DHVPR_LOCALTAX_CLOSE</Col>
          </Row>
          <Row>
            <Col id="TARGET">ESingo</Col>
            <Col id="SP">DHVPR_LOCALTAX_FILE</Col>
          </Row>
          <Row>
            <Col id="TARGET">selectrate</Col>
            <Col id="SP">DHVPR_LOCALTAX_RATE_SELECT</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsSearch" onvaluechanged="dsSearch_onvaluechanged">
        <ColumnInfo>
          <Column id="CD_CORP" type="STRING" size="256"/>
          <Column id="DS_CORP" type="STRING" size="256"/>
          <Column id="NO_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD_CORP"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsSINGO">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="VALUE">매월</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="VALUE">반기</Col>
          </Row>
        </Rows>
      </Dataset>
      <FileDownTransfer id="FileDownTransfer00"/>
      <Dataset id="dsWORK">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="VALUE">정기</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="VALUE">수시</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsListAdjust" oncolumnchanged="dsListAdjust_oncolumnchanged"/>
      <Dataset id="dsText"/>
      <Dataset id="dsRate"/>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="divSearch.form.ccfCD_CORP.form.CDTextBox" propid="value" datasetid="dsSearch" columnid="CD_CORP"/>
      <BindItem id="item1" compid="divData.form.rdoSINGO" propid="value" datasetid="dsList" columnid="CD_PAYMENT"/>
      <BindItem id="item2" compid="divData.form.rdoTY_WORK" propid="value" datasetid="dsList" columnid="CD_WORK"/>
      <BindItem id="item3" compid="divData.form.ctclYM_WORK.form.TextBox" propid="value" datasetid="dsList" columnid="YM_WORK"/>
      <BindItem id="item4" compid="divData.form.ctclYM_PAYMENT.form.TextBox" propid="value" datasetid="dsList" columnid="YM_PAYMENT"/>
      <BindItem id="item5" compid="divData.form.ccfDT_NOTIFY" propid="value" datasetid="dsList" columnid="DT_NOTIFY"/>
      <BindItem id="item6" compid="divData.form.ccfDT_DELIVERY" propid="value" datasetid="dsList" columnid="DT_DELIVERY"/>
      <BindItem id="item7" compid="divData.form.mskDD_PENALTY" propid="value" datasetid="dsList" columnid="DD_PENALTY"/>
      <BindItem id="item8" compid="divData.form.rdoYN_CLOSE" propid="value" datasetid="dsList" columnid="YN_CLOSE"/>
      <BindItem id="item9" compid="divData.form.edtDS_PLACE" propid="value" datasetid="dsList" columnid="DS_PLACE"/>
      <BindItem id="item10" compid="divData.form.edtDS_ADDRESS" propid="value" datasetid="dsList" columnid="DS_ADDRESS"/>
      <BindItem id="item11" compid="divData.form.edtDS_STREET" propid="value" datasetid="dsList" columnid="DS_STREET"/>
      <BindItem id="item12" compid="divData.form.tabData.tab1.form.mskAM_ETC_REFUND" propid="value" datasetid="dsList" columnid="AM_ETC_REFUND"/>
      <BindItem id="item13" compid="divData.form.tabData.tab1.form.mskAM_REFUND_BEF" propid="value" datasetid="dsList" columnid="AM_REFUND_BEF"/>
      <BindItem id="item15" compid="divData.form.tabData.tab1.form.mskAM_YEAREND_PAYMENT" propid="value" datasetid="dsList" columnid="AM_YEAREND_PAYMENT"/>
      <BindItem id="item19" compid="divData.form.tabData.tab1.form.mskAM_ADD_PAYMENT" propid="value" datasetid="dsList" columnid="AM_ADD_PAYMENT"/>
      <BindItem id="item20" compid="divData.form.tabData.tab1.form.mskAM_YEAREND_REFUND" propid="value" datasetid="dsList" columnid="AM_YEAREND_REFUND"/>
      <BindItem id="item21" compid="divData.form.tabData.tab1.form.mskAM_RETIRE_REFUND" propid="value" datasetid="dsList" columnid="AM_RETIRE_REFUND"/>
      <BindItem id="item22" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_ADD_PAYMENT" propid="value" datasetid="dsList" columnid="AM_PENALTY_ADD_PAYMENT"/>
      <BindItem id="item23" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_ADD_DEFAULT" propid="value" datasetid="dsList" columnid="AM_PENALTY_ADD_DEFAULT"/>
      <BindItem id="item24" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_ADD_ADD" propid="value" datasetid="dsList" columnid="AM_PENALTY_ADD_ADD"/>
      <BindItem id="item26" compid="divData.form.tabData.tab1.form.mskDD_PENALTY_ADD" propid="value" datasetid="dsList" columnid="DD_PENALTY_ADD"/>
      <BindItem id="item27" compid="divData.form.tabData.tab1.form.mskAM_REFUND" propid="value" datasetid="dsList" columnid="AM_REFUND"/>
      <BindItem id="item28" compid="divData.form.tabData.tab1.form.mskAM_PAYMENT" propid="value" datasetid="dsList" columnid="AM_PAYMENT"/>
      <BindItem id="item29" compid="divData.form.tabData.tab1.form.mskAM_BALANCE" propid="value" datasetid="dsList" columnid="AM_BALANCE"/>
      <BindItem id="item30" compid="divData.form.tabData.tab1.form.mskAM_AMOUNT_PAY" propid="value" datasetid="dsList" columnid="AM_AMOUNT_PAY"/>
      <BindItem id="item31" compid="divData.form.tabData.tab1.form.mskAM_LOCAL_PAY" propid="value" datasetid="dsList" columnid="AM_LOCAL_PAY"/>
      <BindItem id="item32" compid="divSearch.form.edtNO_ID" propid="value" datasetid="dsSearch" columnid="NO_ID"/>
      <BindItem id="item33" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_DEFAULT" propid="value" datasetid="dsList" columnid="AM_PENALTY_DEFAULT"/>
      <BindItem id="item34" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_ADD_PAYMENT2" propid="value" datasetid="dsList" columnid="AM_PENALTY_ADD_PAYMENT"/>
      <BindItem id="item35" compid="divData.form.tabData.tab1.form.mskAM_PENALTY" propid="value" datasetid="dsList" columnid="AM_PENALTY"/>
      <BindItem id="item37" compid="divSearch.form.ccfCD_CORP.form.DSTextBox" propid="value" datasetid="dsSearch" columnid="DS_CORP"/>
      <BindItem id="item25" compid="divData.form.tabData.tab1.form.tclDT_PENALTY_ADD" propid="value" datasetid="dsList" columnid="DT_PENALTY_ADD"/>
      <BindItem id="item14" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_DATE" propid="value" datasetid="dsList" columnid="AM_PENALTY_DATE"/>
      <BindItem id="item16" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_MON" propid="value" datasetid="dsList" columnid="AM_PENALTY_MON"/>
      <BindItem id="item17" compid="divData.form.tabData.tab1.form.mskAM_PENALTY_ADD" propid="value" datasetid="dsList" columnid="AM_PENALTY_ADD"/>
    </Bind>
  </Form>
</FDL>
