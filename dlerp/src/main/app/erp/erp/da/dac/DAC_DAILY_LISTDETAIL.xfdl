<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.0">
  <Form id="DAC_DAILY_LISTDETAIL" width="1280" height="720" titletext="인원현황관리" onload="DAC_DAILY_DEPT_onload">
    <Layouts>
      <Layout height="720" mobileorientation="landscape" width="1280">
        <Div id="divData" taborder="8" left="0" top="0" right="0" bottom="0" text="">
          <Layouts>
            <Layout>
              <Static id="staDT_REPORT" taborder="14" text="기준일자" left="0" top="61" width="100" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta14" taborder="15" left="99" top="61" width="207" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta06" taborder="16" text="상태" left="sta14:-1" top="61" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta07" taborder="17" text="총인원" left="0" top="90" width="100" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta08" taborder="18" left="99" top="90" height="30" cssclass="sta_WF_tablebg" text="" width="484"/>
              <Static id="sta09" taborder="19" text="근무" left="0" top="119" width="100" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta10" taborder="20" left="99" top="119" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta11" taborder="21" text="결근" left="168" top="119" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta12" taborder="22" left="237" top="119" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta13" taborder="23" text="연차" left="306" top="119" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta15" taborder="24" left="375" top="119" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta16" taborder="25" text="특별" left="444" top="119" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta17" taborder="26" left="513" top="119" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta18" taborder="27" text="휴무" left="0" top="148" width="100" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta19" taborder="28" left="99" top="148" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta20" taborder="29" text="공가" left="168" top="148" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta21" taborder="30" left="237" top="148" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta30" taborder="31" text="기타" left="306" top="148" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta31" taborder="32" left="375" top="148" height="30" cssclass="sta_WF_tablebg" text="" width="208"/>
              <Static id="sta33" taborder="33" left="sta06:-1" top="61" height="30" cssclass="sta_WF_tablebg" text="" width="209"/>
              <Static id="sta34" taborder="34" text="비고" left="582" top="32" width="100" height="60" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta35" taborder="35" left="679" top="32" height="60" cssclass="sta_WF_tablebg" text="" width="484"/>
              <Edit id="edtDT_REPORT" taborder="36" top="66" width="140" height="20" left="105" readonly="true" textAlign="center"/>
              <Edit id="edtSUM_WORK" taborder="37" top="95" width="60" height="20" left="105" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtDS_STATUS" taborder="38" top="66" width="140" height="20" left="378" readonly="true"/>
              <Edit id="edtNO_WORK" taborder="39" top="124" width="60" height="20" left="105" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_ABSENCE" taborder="40" top="124" width="60" height="20" left="243" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_HOLIDAY" taborder="41" top="124" width="60" height="20" left="381" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_SPECIAL" taborder="42" top="124" width="60" height="20" left="519" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_CLOSE" taborder="43" top="154" width="60" height="20" left="105" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_OFFICIAL" taborder="44" top="154" width="60" height="20" left="243" readonly="true" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_ETC" taborder="45" top="153" width="60" height="20" left="381" readonly="true" textAlign="right" inputtype="number"/>
              <TextArea id="txtDS_REMARK_R" taborder="46" left="685" top="40" height="45" readonly="false" width="472" oninput="divData_txtDS_REMARK_R_oninput"/>
              <Static id="staDS_DEPT" taborder="47" text="부서명" left="0" top="32" width="100" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta37" taborder="48" left="99" top="32" height="30" cssclass="sta_WF_tablebg" text="" width="484"/>
              <Edit id="edtDS_DEPT" taborder="49" top="37" width="180" height="20" left="106" readonly="true"/>
              <Button id="btnSave1" taborder="61" text="저장" top="9" height="20" enable="true" onclick="btnSave1_onclick" right="0" width="47"/>
              <Static id="sta32" taborder="0" text="인원현황" left="0" top="0" height="22" cssclass="sta_TITLE_Bg" right="10"/>
              <Static id="sta43" taborder="60" text="[골프장만 입력]" left="586" top="151" height="30" textAlign="right" color="crimson" width="90"/>
              <Static id="sta01" taborder="7" text="출역인원 : " left="663" top="122" height="30" textAlign="right" width="80"/>
              <Static id="sta02" taborder="50" text="캐디인원 : " left="sta43:-13" top="149" height="30" textAlign="right" width="80"/>
              <Static id="sta23" taborder="1" text="총원" left="748" top="91" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta26" taborder="2" left="sta23:-1" top="91" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta24" taborder="3" text="휴무" left="sta26:-1" top="91" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta27" taborder="4" left="sta24:-1" top="91" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta25" taborder="5" text="현원" left="sta27:-1" top="91" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta28" taborder="6" left="sta25:-1" top="91" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta22" taborder="8" text="총원" left="sta01:5" top="120" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta29" taborder="9" left="sta22:-1" top="120" width="346" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Edit id="edtNO_SERVICE_TOTAL" taborder="10" top="96" width="60" height="20" left="sta23:5" readonly="false" inputfilter="none" textAlign="right" inputtype="number" oninput="divData_edtNO_SERVICE_TOTAL_oninput"/>
              <Edit id="edtNO_SERVICE_HOLIDAY" taborder="11" top="96" width="60" height="20" left="sta24:5" readonly="false" inputfilter="none" textAlign="right" inputtype="number" oninput="divData_edtNO_SERVICE_HOLIDAY_oninput"/>
              <Edit id="edtNO_SERVICE_CNT" taborder="12" top="96" width="60" height="20" left="sta25:5" readonly="true" inputfilter="none" textAlign="right" inputtype="number"/>
              <Edit id="edtNO_LABOR_CNT" taborder="13" top="125" width="60" height="20" left="sta22:5" readonly="false" textAlign="right" inputtype="number" oninput="divData_edtNO_LABOR_CNT_oninput"/>
              <Static id="sta04" taborder="51" text="총원" left="sta02:5" top="149" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta38" taborder="52" left="sta04:-1" top="149" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta39" taborder="53" text="휴무" left="sta38:-1" top="149" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta40" taborder="54" left="sta39:-1" top="149" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Static id="sta41" taborder="55" text="현원" left="sta40:-1" top="149" width="70" height="30" cssclass="sta_WF_tablelabel" textDecoration="none" textAlign="center"/>
              <Static id="sta42" taborder="56" left="sta41:-1" top="149" width="70" height="30" cssclass="sta_WF_tablebg" text=""/>
              <Edit id="edtNO_CADDIE_TOTAL" taborder="57" top="154" width="60" height="20" left="sta04:5" readonly="false" inputfilter="none" textAlign="right" inputtype="number" oninput="divData_edtNO_CADDIE_TOTAL_oninput"/>
              <Edit id="edtNO_CADDIE_HOLIDAY" taborder="58" top="154" width="60" height="20" left="sta39:5" readonly="false" inputfilter="none" textAlign="right" inputtype="number" oninput="divData_edtNO_CADDIE_HOLIDAY_oninput"/>
              <Edit id="edtNO_CADDIE_CNT" taborder="59" top="154" width="60" height="20" left="sta41:5" readonly="true" inputfilter="none" textAlign="right" inputtype="number"/>
              <Static id="sta05" taborder="62" text="세부내역" left="0" top="sta18:20" height="22" cssclass="sta_TITLE_Bg" right="10"/>
              <Grid id="objGrid2" taborder="63" left="0" top="sta05:10" right="0" binddataset="dsList2" height="310" oncellclick="divData_objGrid2_oncellclick">
                <Formats>
                  <Format id="default"/>
                </Formats>
              </Grid>
              <Static id="sta36" taborder="65" text="인원현황등록(관리현장)" left="0" top="objGrid2:10" height="22" cssclass="sta_TITLE_Bg" right="10"/>
              <Button id="btnSave2" taborder="66" text="저장" top="205" height="20" enable="false" onclick="btnSave2_onclick" right="50" width="47"/>
              <Button id="btnDel2" taborder="69" text="삭제" top="205" height="20" enable="false" onclick="btnDel2_onclick" right="0" width="47"/>
              <Static id="sta03" taborder="70" text="[현장만 입력]" left="586" top="121" height="30" textAlign="right" color="crimson" width="90"/>
              <Static id="sta00" taborder="71" text="용역인원 :" left="660" top="93" height="30" textAlign="right" width="80"/>
              <Grid id="objGrid3" taborder="64" left="0" top="sta36:10" right="0" binddataset="dsList3" height="130">
                <Formats>
                  <Format id="default"/>
                </Formats>
              </Grid>
              <Button id="btnCancel3" taborder="67" text="삭제" top="objGrid2:18" height="20" enable="false" onclick="btnCancel3_onclick" right="50" width="47" visible="false"/>
              <Button id="btnSave3" taborder="68" text="저장" top="objGrid2:18" height="20" enable="false" onclick="btnSave3_onclick" width="47" right="0"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="dsList1" useclientlayout="false" onvaluechanged="dsList1_onvaluechanged">
        <ColumnInfo>
          <Column id="CD_DEPT" type="STRING" size="256"/>
          <Column id="DT_REPORT" type="STRING" size="256"/>
          <Column id="DS_DEPT" type="STRING" size="256"/>
          <Column id="NO_TOTAL" type="STRING" size="256"/>
          <Column id="NO_WORK" type="STRING" size="256"/>
          <Column id="NO_ABSENCE" type="STRING" size="256"/>
          <Column id="NO_HOLIDAY" type="STRING" size="256"/>
          <Column id="NO_SPECIAL" type="STRING" size="256"/>
          <Column id="NO_CLOSE" type="STRING" size="256"/>
          <Column id="NO_OFFICIAL" type="STRING" size="256"/>
          <Column id="NO_ETC" type="STRING" size="256"/>
          <Column id="NO_SERVICE_TOTAL" type="STRING" size="256"/>
          <Column id="NO_SERVICE_HOLIDAY" type="STRING" size="256"/>
          <Column id="NO_SERVICE_CNT" type="STRING" size="256"/>
          <Column id="NO_LABOR_CNT" type="STRING" size="256"/>
          <Column id="NO_CADDIE_TOTAL" type="STRING" size="256"/>
          <Column id="NO_CADDIE_HOLIDAY" type="STRING" size="256"/>
          <Column id="NO_CADDIE_CNT" type="STRING" size="256"/>
          <Column id="DS_REMARK_R" type="STRING" size="256"/>
          <Column id="TY_STATUS" type="STRING" size="256"/>
          <Column id="DS_STATUS" type="STRING" size="256"/>
          <Column id="SUM_WORK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="_dsProc">
        <ColumnInfo>
          <Column id="TARGET" type="STRING" size="256"/>
          <Column id="SP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TARGET">select1</Col>
            <Col id="SP">DACPR_DAILYLIST_SELECT_D01</Col>
          </Row>
          <Row>
            <Col id="TARGET">select2</Col>
            <Col id="SP">DACPR_DAILYLIST_SELECT_D02</Col>
          </Row>
          <Row>
            <Col id="TARGET">select3</Col>
            <Col id="SP">DACPR_DAILYLIST_SELECT_D03</Col>
          </Row>
          <Row>
            <Col id="TARGET">save1</Col>
            <Col id="SP">DACPR_DAILYLIST_SAVE_D01</Col>
          </Row>
          <Row>
            <Col id="TARGET">save2</Col>
            <Col id="SP">DACPR_DAILYLIST_SAVE_D02</Col>
          </Row>
          <Row>
            <Col id="TARGET">save3</Col>
            <Col id="SP">DACPR_DAILYLIST_SAVE_D03</Col>
          </Row>
          <Row>
            <Col id="TARGET">saveApproval</Col>
            <Col id="SP">DACPR_DAILYLIST_APPROVAL</Col>
          </Row>
          <Row>
            <Col id="TARGET">report2</Col>
            <Col id="SP">DACPR_DAILY_REPORT2</Col>
          </Row>
          <Row>
            <Col id="TARGET">report3</Col>
            <Col id="SP">DACPR_DAILY_REPORT3</Col>
          </Row>
          <Row>
            <Col id="TARGET">report4</Col>
            <Col id="SP">DACPR_DAILY_REPORT4</Col>
          </Row>
          <Row>
            <Col id="TARGET">report5</Col>
            <Col id="SP">DACPR_DAILY_REPORT5</Col>
          </Row>
          <Row>
            <Col id="TARGET">report6</Col>
            <Col id="SP">DACPR_DAILY_REPORT7</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsSearch" onvaluechanged="dsSearch_onvaluechanged">
        <ColumnInfo>
          <Column id="DT_REPORT" type="STRING" size="256"/>
          <Column id="CD_DEPT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="DT_REPORT"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsList2"/>
      <Dataset id="dsList3" onvaluechanged="dsList3_onvaluechanged"/>
      <Dataset id="dsSave2"/>
      <Dataset id="dsSave3"/>
      <Dataset id="dsApproval"/>
      <Dataset id="dsReportParam" >
        <ColumnInfo>
          <Column id="DT_REPORT" type="STRING" size="256"/>
          <Column id="TY_VIEW" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[this.objApp = this.gfnGetApplication();

this.DAC_DAILY_DEPT_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo){
	// -- 필수 -------------------//
	this.gfnFormOnLoad(this);	
	this.gfnFormInfo(this);		
	// ---------------------------//
	
	this.fnSetButton();
	this.fnSetExtendButton();
	this.fnSetVariable();
	this.fnSetEvent();
	this.fnSetParameter();
	
	this.fnSelect1();
};

/************************************************************************
 * 버튼 설정 : 화면(Tab) 전환시 마다 호출
 * 서브버튼 사용 및 공통버튼 강제 제어시 여기서 처리
 ************************************************************************/
this.fnSetButton = function() {
	this.FormBtns.Add.set_enable(false);
	this.FormBtns.Del.set_enable(false);
	this.FormBtns.Save.set_enable(false);
	
	if (this.dsList2.getRowCount() <= 0){
		this.divData.form.btnSave2.set_enable(false);
		this.divData.form.btnDel2.set_enable(false);
	} else {
		if(this.dsList1.getColumn(0, "TY_STATUS") == "2") {
			this.divData.form.btnSave2.set_enable(false);
			this.divData.form.btnDel2.set_enable(false);
		} else {
			this.divData.form.btnSave2.set_enable(true);
			this.divData.form.btnDel2.set_enable(true);		
		}
	}
	
	if (this.dsList3.getRowCount() <= 0){
		this.divData.form.btnSave3.set_enable(false);
	} else {
		if(this.dsList1.getColumn(0, "TY_STATUS") == "2") {
			this.divData.form.btnSave3.set_enable(false);
		} else {
			this.divData.form.btnSave3.set_enable(true);
		}
	}
};

/************************************************************************
 * 확장 버튼 : 화면별 버튼 설정 ID, function 연결 (화면버튼관리)
 ************************************************************************/
this.fnSetExtendButton = function() {
	this.btnApproval = this.gfnFormButtonAdd("Approval", "fnApprovalChk", "승인");
	this.btnApprovalCancel = this.gfnFormButtonAdd("ApprovalCancel", "fnApprovalCancelChk", "승인취소");
	
	this.btnApproval.set_enable(false);
	this.btnApprovalCancel.set_enable(false);
};

/************************************************************************
 * 변수 선언
 ************************************************************************/
this.fnSetVariable = function() {
	
	this.dxGrid2 = this.divData.form.objGrid2;
	this.dxGrid3 = this.divData.form.objGrid3;
};

/************************************************************************
 * 이벤트 설정
 ************************************************************************/
this.fnSetEvent = function() {

	this.gfnGridInit(this.dxGrid2, this.dsList2, "DA", "DAC_DAILY_LISTDETAIL");
	this.gfnGridInit(this.dxGrid3, this.dsList3, "DA", "DAC_DAILY_LISTMNG");
};

/************************************************************************
 * 파라미터 설정
 ************************************************************************/
this.fnSetParameter = function() {
	//조회
	this.dsSelect = new Dataset();
	this.dsSelect.addColumn("DT_REPORT", "string"); //일자
	this.dsSelect.addColumn("TY_DEPT", "string");  	//조직분류
	this.dsSelect.addColumn("CD_DEPT", "string");  	//부서
	this.dsSelect.addColumn("GR_SEARCH", "string"); //로그인 권한
	this.dsSelect.addColumn("GR_DEPT", "string");  	//로그인 부서
	this.dsSelect.addColumn("GR_USER", "string");  	//로그인 ID
	
	//세부내역 저장
	this.dsSave2 = new Dataset();
	this.dsSave2.addColumn("TY_SAVE", "string");
	this.dsSave2.addColumn("CD_DEPT", "string");
	this.dsSave2.addColumn("DT_REPORT", "string");
	this.dsSave2.addColumn("ID_PERSON", "bigdecimal");
	this.dsSave2.addColumn("ID_SABUN", "string");
	this.dsSave2.addColumn("YN_WORK", "string");
	this.dsSave2.addColumn("YN_ABSENCE", "string");
	this.dsSave2.addColumn("YN_HOLIDAY", "string");
	this.dsSave2.addColumn("YN_SPECIAL", "string");
	this.dsSave2.addColumn("YN_CLOSE", "string");
	this.dsSave2.addColumn("YN_OFFICIAL", "string");
	this.dsSave2.addColumn("YN_ETC", "string");
	this.dsSave2.addColumn("DS_REMARK", "string");
	this.dsSave2.addColumn("ID_INSERT", "string");
	this.dsSave2.addColumn("GR_SEARCH", "string");
	this.dsSave2.addColumn("GR_DEPT", "string");
	
	//인원현황 등록(인사)
	this.dsSave3 = new Dataset();
	this.dsSave3.addColumn("TY_SAVE", "string");
	this.dsSave3.addColumn("CD_DEPT", "string");
	this.dsSave3.addColumn("DT_REPORT", "string");
	this.dsSave3.addColumn("CD_DEPT_REGISTER", "string");
	this.dsSave3.addColumn("NO_OFFICER", "bigdecimal");
	this.dsSave3.addColumn("NO_REGULAR", "bigdecimal");
	this.dsSave3.addColumn("NO_CONTRACT", "bigdecimal");
	this.dsSave3.addColumn("NO_WORK", "bigdecimal");
	this.dsSave3.addColumn("NO_ABSENCE", "bigdecimal");
	this.dsSave3.addColumn("NO_HOLIDAY", "bigdecimal");
	this.dsSave3.addColumn("NO_SPECIAL", "bigdecimal");
	this.dsSave3.addColumn("NO_CLOSE", "bigdecimal");
	this.dsSave3.addColumn("NO_OFFICIAL", "bigdecimal");
	this.dsSave3.addColumn("NO_ETC", "bigdecimal");
	this.dsSave3.addColumn("NO_SERVICE_TOTAL", "bigdecimal");
	this.dsSave3.addColumn("NO_SERVICE_HOLIDAY", "bigdecimal");
	this.dsSave3.addColumn("NO_SERVICE_CNT", "bigdecimal"); // 20200302 컬럼추가
	this.dsSave3.addColumn("NO_LABOR_CNT", "bigdecimal"); // 20200302 컬럼추가
	this.dsSave3.addColumn("NO_CADDIE_TOTAL", "bigdecimal");
	this.dsSave3.addColumn("NO_CADDIE_HOLIDAY", "bigdecimal");
	this.dsSave3.addColumn("NO_CADDIE_CNT", "bigdecimal"); // 20200302 컬럼추가
	this.dsSave3.addColumn("DS_REMARK", "string");
	this.dsSave3.addColumn("ID_INSERT", "string");
	this.dsSave3.addColumn("GR_SEARCH", "string");
	this.dsSave3.addColumn("GR_DEPT", "string");
	
	//승인
	this.dsApproval = new Dataset();
	this.dsApproval.addColumn("TY_APPROVAL", "string");
	this.dsApproval.addColumn("CD_DEPT", "string");
	this.dsApproval.addColumn("DT_REPORT", "string");
	this.dsApproval.addColumn("TY_DEPT", "string");
	this.dsApproval.addColumn("GR_SEARCH", "string");
	this.dsApproval.addColumn("GR_DEPT", "string");
	this.dsApproval.addColumn("GR_USER", "string");
};

/************************************************************************
 * 컨트롤 이벤트
 ************************************************************************/
 /*
  *	조회 버튼
  */
 this.fnSelect = function() {
	this.fnSelect1();
	this.fnSelect2();
	this.fnSelect3();  
 };
 
//인원현황
this.fnSelect1 = function() {
	
	this.dsSelect.clearData();
	this.dsSelect.addRow();

	this.dsSelect.setColumn(0, "DT_REPORT", this.getOwnerFrame().DT_REPORT);	// 일자
	this.dsSelect.setColumn(0, "TY_DEPT", 	this.getOwnerFrame().TY_DEPT);		// 조직분류
	this.dsSelect.setColumn(0, "CD_DEPT", 	this.getOwnerFrame().CD_DEPT);  	// 부서
	this.dsSelect.setColumn(0, "GR_SEARCH",	this.getOwnerFrame().GR_SEARCH); //로그인 권한
	this.dsSelect.setColumn(0, "GR_DEPT", 	this.getOwnerFrame().GR_DEPT);  	//로그인 부서
	this.dsSelect.setColumn(0, "GR_USER", 	this.getOwnerFrame().GR_USER);  	//로그인 ID

	var strSvcId    = "select1";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select1=dsSelect";
	var outData     = "dsList1=select10";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

//세부내역
this.fnSelect2 = function() {
	
	var strSvcId    = "select2";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select2=dsSelect";
	var outData     = "dsList2=select20";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

//인원현황등록(인사)
this.fnSelect3 = function() {
	
	var strSvcId    = "select3";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select3=dsSelect";
	var outData     = "dsList3=select30";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
};

//인원현황 저장
this.fnSave1 = function() {
	
	if(this.dsList1.getColumn(0, "TY_SAVE") != "U") {
		this.gfnAlert("변경된 내역이 없습니다.");
		return;
	}
	
	trace("저장 : "+this.dsList1.saveXML());
	var strSvcId    = "save1";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "save1=dsList1";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

//세부내역 저장
this.fnSave2 = function() {

	this.dxGrid2.updateToDataset();

	this.dsSave2.clearData();
	
	for (var i = 0; i < this.dsList2.rowcount; i++) {
		if(this.dsList2.getColumn(i, "CHK") == "Y"){
			var flag = this.gfnGetFlag(this.dsList2, i);
			switch(flag) {
				case "I":
				case "U":
				case "D":
					var nrow = this.dsSave2.addRow();
					this.dsSave2.setColumn(nrow, "TY_SAVE", flag);
					this.dsSave2.setColumn(nrow, "CD_DEPT", this.dsList2.getColumn(i, "CD_DEPT"));
					this.dsSave2.setColumn(nrow, "DT_REPORT", this.dsList2.getColumn(i, "DT_REPORT"));
					this.dsSave2.setColumn(nrow, "ID_PERSON", this.dsList2.getColumn(i, "ID_PERSON"));
					this.dsSave2.setColumn(nrow, "ID_SABUN", this.dsList2.getColumn(i, "ID_SABUN"));
					this.dsSave2.setColumn(nrow, "YN_WORK", this.dsList2.getColumn(i, "YN_WORK"));
					this.dsSave2.setColumn(nrow, "YN_ABSENCE", this.dsList2.getColumn(i, "YN_ABSENCE"));
					this.dsSave2.setColumn(nrow, "YN_HOLIDAY", this.dsList2.getColumn(i, "YN_HOLIDAY"));
					this.dsSave2.setColumn(nrow, "YN_SPECIAL", this.dsList2.getColumn(i, "YN_SPECIAL"));
					this.dsSave2.setColumn(nrow, "YN_CLOSE", this.dsList2.getColumn(i, "YN_CLOSE"));
					this.dsSave2.setColumn(nrow, "YN_OFFICIAL", this.dsList2.getColumn(i, "YN_OFFICIAL"));
					this.dsSave2.setColumn(nrow, "YN_ETC", this.dsList2.getColumn(i, "YN_ETC"));
					this.dsSave2.setColumn(nrow, "DS_REMARK", this.dsList2.getColumn(i, "DS_REMARK"));
					this.dsSave2.setColumn(nrow, "ID_INSERT", this.getOwnerFrame().GR_USER);
					this.dsSave2.setColumn(nrow, "GR_SEARCH", this.getOwnerFrame().GR_SEARCH);
					this.dsSave2.setColumn(nrow, "GR_DEPT", this.getOwnerFrame().GR_DEPT);
					this.dsSave2.setColumn(nrow, "ID_USER", this.getOwnerFrame().GR_USER);

					break;
			}
		}
	}
	
	var strSvcId    = "save2";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "save2=dsSave2";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

//인원현황등록(인사) 저장
this.fnSave3 = function() {
	this.dxGrid3.updateToDataset();

	this.dsSave3.clearData();
	
	for (var i = 0; i < this.dsList3.rowcount; i++) {
		var flag = this.gfnGetFlag(this.dsList3, i);
		switch(flag) {
			case "I":
			case "U":
			case "D":
				var nrow = this.dsSave3.addRow();
				this.dsSave3.setColumn(nrow, "TY_SAVE", flag);
				this.dsSave3.setColumn(nrow, "CD_DEPT", this.dsList3.getColumn(i, "CD_DEPT"));
				this.dsSave3.setColumn(nrow, "DT_REPORT", this.dsList3.getColumn(i, "DT_REPORT"));
				this.dsSave3.setColumn(nrow, "CD_DEPT_REGISTER", this.dsList3.getColumn(i, "CD_DEPT_REGISTER"));
				this.dsSave3.setColumn(nrow, "NO_OFFICER", this.dsList3.getColumn(i, "NO_OFFICER"));
				this.dsSave3.setColumn(nrow, "NO_REGULAR", this.dsList3.getColumn(i, "NO_REGULAR"));
				this.dsSave3.setColumn(nrow, "NO_CONTRACT", this.dsList3.getColumn(i, "NO_CONTRACT"));
				this.dsSave3.setColumn(nrow, "NO_WORK", this.dsList3.getColumn(i, "NO_WORK"));
				this.dsSave3.setColumn(nrow, "NO_ABSENCE", this.dsList3.getColumn(i, "NO_ABSENCE"));
				this.dsSave3.setColumn(nrow, "NO_HOLIDAY", this.dsList3.getColumn(i, "NO_HOLIDAY"));
				this.dsSave3.setColumn(nrow, "NO_SPECIAL", this.dsList3.getColumn(i, "NO_SPECIAL"));
				this.dsSave3.setColumn(nrow, "NO_CLOSE", this.dsList3.getColumn(i, "NO_CLOSE"));
				this.dsSave3.setColumn(nrow, "NO_OFFICIAL", this.dsList3.getColumn(i, "NO_OFFICIAL"));
				this.dsSave3.setColumn(nrow, "NO_ETC", this.dsList3.getColumn(i, "NO_ETC"));
				this.dsSave3.setColumn(nrow, "NO_SERVICE_TOTAL", this.dsList3.getColumn(i, "NO_SERVICE_TOTAL"));
				this.dsSave3.setColumn(nrow, "NO_SERVICE_HOLIDAY", this.dsList3.getColumn(i, "NO_SERVICE_HOLIDAY"));
				this.dsSave3.setColumn(nrow, "NO_SERVICE_CNT", this.dsList3.getColumn(i, "NO_SERVICE_CNT"));
				this.dsSave3.setColumn(nrow, "NO_LABOR_CNT", this.dsList3.getColumn(i, "NO_LABOR_CNT"));
				this.dsSave3.setColumn(nrow, "NO_CADDIE_TOTAL", this.dsList3.getColumn(i, "NO_CADDIE_TOTAL"));
				this.dsSave3.setColumn(nrow, "NO_CADDIE_HOLIDAY", this.dsList3.getColumn(i, "NO_CADDIE_HOLIDAY"));
				this.dsSave3.setColumn(nrow, "NO_CADDIE_CNT", this.dsList3.getColumn(i, "NO_CADDIE_HOLIDAY"));
				this.dsSave3.setColumn(nrow, "DS_REMARK", this.dsList3.getColumn(i, "DS_REMARK"));
				this.dsSave3.setColumn(nrow, "ID_INSERT", this.getOwnerFrame().GR_USER);
				this.dsSave3.setColumn(nrow, "GR_SEARCH", this.getOwnerFrame().GR_SEARCH);
				this.dsSave3.setColumn(nrow, "GR_DEPT", this.getOwnerFrame().GR_DEPT);
				//this.dsSave3.setColumn(nrow, "ID_USER", this.getOwnerFrame().GR_USER);  20200302 주석

				break;
		}
	}
	var strSvcId    = "save3";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = "save3=dsSave3";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); 	// 통신방법 정의 [생략가능]
};

//승인
this.fnApproval = function(approval) {
	
	var nrow = this.dsApproval.addRow();
	
	this.dsApproval.setColumn(nrow, "TY_APPROVAL", approval);
	this.dsApproval.setColumn(nrow, "CD_DEPT", 	this.dsList1.getColumn(0, "CD_DEPT"));
	this.dsApproval.setColumn(nrow, "DT_REPORT",this.dsList1.getColumn(0, "DT_REPORT"));
	this.dsApproval.setColumn(nrow, "TY_DEPT", 	this.getOwnerFrame().TY_DEPT);
	this.dsApproval.setColumn(nrow, "GR_SEARCH",this.getOwnerFrame().GR_SEARCH);
	this.dsApproval.setColumn(nrow, "GR_DEPT", 	this.getOwnerFrame().GR_DEPT);
	this.dsApproval.setColumn(nrow, "GR_USER", 	this.getOwnerFrame().GR_USER);


	var strSvcId    = "saveApproval";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "saveApproval=dsApproval";
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// trabsaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc,
						false); 	// 통신방법 정의 [생략가능]

	if(approval == 2){
		this.gfnAlert("승인 되었습니다.");
	}else{
		this.gfnAlert("승인취소 되었습니다.");
	}
};

/*
 *	입력 버튼
 */
this.fnAdd = function() {
	this.gfnGridAdd(this.dxGrid);
};

/*
 *	삭제 버튼
 */
this.fnDel = function() {
	this.gfnGridDel(this.dxGrid);
};

/*
 *	저장 버튼
 */
this.fnSave = function() {	

};

/*
 *	엑셀 버튼
 */
this.fnExcel = function() {
	this.gfnExcelExport(this.dxGrid);
};

/*
 *	출력 버튼
 */
this.fnPrint = function() {
	this.fnSelectRpt("6");
};

/************************************************************************
 * Validate
 ************************************************************************/

/************************************************************************
 * 콜백 이벤트
 ***********************************************************************
/*
 *	콜백 처리
 */
this.fnCallback = function(svcID, errorCode, errorMsg){
	if (errorCode == 0) {		
	} else {
		this.gfnAlert(errorMsg);
		return false;
	}
	
	if (svcID == "select1") {
		if(this.dsList1.getRowCount() > 0){
			//YN_APPROVAL(승인권자) 값이 Y 일 경우 - TY_STATUS 가 2인경우에는 승인취소 활성화 / 2가 아닌경우에는 승인버튼 활성화
			//YN_APPROVAL 값이 N 일 경우 승인 / 승인취소 버튼 비활성화  
			if(this.dsList1.getColumn(0, "YN_APPROVAL") == "Y" || this.getOwnerFrame().GR_SEARCH == '1' ){
				if(this.dsList1.getColumn(0, "TY_STATUS") == "2"){
					this.fnSetReadOnly(true);	//승인상태 - 수정불가
				}else{
					this.fnSetReadOnly(false);	//수정가능
				}
			}else{
				this.fnSetReadOnly(true);	//수정불가
			}
			
			var dtReport = this.dsList1.getColumn(0, "DT_REPORT");
			this.divData.form.edtDT_REPORT.set_value(dtReport.substring(0,4)+"-"+dtReport.substring(4,6)+"-"+dtReport.substring(6,8));
		}
		
		this.dsList1.addColumn("TY_SAVE","string");
		this.dsList1.addColumn("ID_INSERT","string");
		this.dsList1.addColumn("GR_SEARCH","string");
		this.dsList1.addColumn("GR_DEPT","string");

		this.fnSelect2();
	} else if (svcID == "select2") {
		this.fnSelect3();
	} else if (svcID == "select3") {
		this.gfnSetFormStatus(this, "Q");
	} else if (svcID == "save1") {
		this.gfnAlert("저장되었습니다.");	
		this.fnSelect1();
	} else if (svcID == "save2") {
		this.gfnAlert("저장되었습니다.");		
		this.fnSelect1();
		this.fnSelect2();
		this.fnSelect3();
	} else if (svcID == "save3") {
		this.gfnAlert("저장되었습니다.");	
		this.gfnSetFormStatus(this, "Q");
		this.fnSelect3();
	} else if (svcID == "saveApproval") {
		this.fnSelect1();
	}
	this.fnSetButton();
};

/************************************************************************
 * 코드파인드 이벤트
 ************************************************************************/

/************************************************************************
 * 그리드 이벤트
 *************************************************************************/
/************************************************************************
 * 기타 이벤트
 ************************************************************************/
//저장
//승인
this.fnApprovalChk = function() {

	if(this.dsList1.getColumn(0, "TY_SAVE") == "U"){
		this.gfnAlert("인원현황을 먼저 저장하세요.");
		return false;
	}
	if(this.gfnDsIsUpdated(this.dsList2)) {
		this.gfnAlert("세부내역을 먼저 저장하세요.");
		return false;
	}
	if(this.gfnDsIsUpdated(this.dsList3)) {
		this.gfnAlert("인원현황등록(인사)를 먼저 저장하세요.");
		return false;
	}
	

};

//승인취소
this.fnApprovalCancelChk = function() {
	if(this.dsList1.getColumn(0, "TY_SAVE") == "U"){
		this.gfnAlert("인원현황을 먼저 저장하세요.");
		return false;
	}


};

//인원현황
this.btnSave1_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fnSave1();
};

//세부내역
this.btnSave2_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fnSave2();
};
// //세부내역 행추가
// this.btnAdd2_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
// {
// 	this.gfnGridAdd(this.dxGrid2);
// 	var nrow = this.dsList2.rowposition;
// 	this.dsList2.setColumn(nrow, "DT_REPORT", this.dsList1.getColumn(0, "DT_REPORT"));
// 	this.dsList2.setColumn(nrow, "CD_DEPT", this.dsList1.getColumn(0, "CD_DEPT"));
// };
//세부내역 삭제
this.btnDel2_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.dsList2.setColumn(this.dsList2.rowposition,"CHK","Y");
	this.gfnGridDel(this.dxGrid2);
};

//인원현황등록(인사) - 저장
this.btnSave3_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fnSave3();
};

//인원현황등록(인사) - 삭제
this.btnCancel3_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.gfnGridDel(this.dxGrid3);
};

//인원현황 변경시
this.dsList1_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{	
	if(e.newvalue != undefined) {
		this.dsList1.set_enableevent(false);
		
		this.dsList1.setColumn(0, "TY_SAVE", "U" );
		this.dsList1.setColumn(0, "ID_INSERT",	this.getOwnerFrame().GR_USER);
		this.dsList1.setColumn(0, "GR_SEARCH",	this.getOwnerFrame().GR_SEARCH);
		this.dsList1.setColumn(0, "GR_DEPT",	this.getOwnerFrame().GR_DEPT);
		
		this.dsList1.set_enableevent(true);
	}
	
	this.fnSetButton();	
};

this.fnSetReadOnly = function (bReadOnly){
	//승인
	this.btnApproval.set_enable(!bReadOnly);
	this.btnApprovalCancel.set_enable(bReadOnly);
		
	this.divData.form.edtNO_SERVICE_TOTAL.set_readonly(bReadOnly);
	this.divData.form.edtNO_SERVICE_HOLIDAY.set_readonly(bReadOnly);
	this.divData.form.edtNO_LABOR_CNT.set_readonly(bReadOnly);
	this.divData.form.edtNO_CADDIE_TOTAL.set_readonly(bReadOnly);
	this.divData.form.edtNO_CADDIE_HOLIDAY.set_readonly(bReadOnly);	
	this.divData.form.txtDS_REMARK_R.set_enable(!bReadOnly);
	
	//인원현황
	this.divData.form.btnSave1.set_enable(!bReadOnly);
	
	//세부내역, 인원현황등록(인사)
	//this.dxGrid2.set_enable(!bReadOnly);
	if (bReadOnly)
	{
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","CHK"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_WORK"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_ABSENCE"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_HOLIDAY"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_SPECIAL"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_CLOSE"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_OFFICIAL"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","YN_ETC"),"edittype","none");
		this.dxGrid2.setCellProperty("body",this.dxGrid2.getBindCellIndex("body","DS_REMARK"),"edittype","none");		
	}

	this.divData.form.btnDel2.set_enable(!bReadOnly);
	this.divData.form.btnSave2.set_enable(!bReadOnly);
	

	this.dxGrid3.set_enable(!bReadOnly);
	this.divData.form.btnSave3.set_enable(!bReadOnly);
	//this.divData.form.btnCancel3.set_enable(!bReadOnly);
};
this.divData_objGrid2_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)									
{
	this.fnSetButton();
	if(e.clickitem == "control" && e.col != 1) {  // 첫번째 column 제외
		for(var i = 5; i < this.dxGrid2.getCellCount("body"); i++) {
			if(this.divData.form.objGrid2.getCellProperty("body", i , "edittype") == "checkbox") {
				this.dsList2.setColumn(e.row, "CHK","Y");
				if(e.col != i) {
					this.dsList2.setColumn(e.row, this.gfnGridGetBindColumnNameByIndex( this.dxGrid2, i), "N");
				}
			}
		}
	}	
};
this.dsList3_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	this.fnSetButton();
	switch(e.columnid){
		case "NO_SERVICE_HOLIDAY"://휴무
			var serviceTotal = this.dsList3.getColumn(e.row, "NO_SERVICE_TOTAL");
			this.dsList3.setColumn(e.row, "NO_SERVICE_CNT", serviceTotal-e.newvalue);
		break;
		
		case "NO_SERVICE_CNT":	//현원
			var serviceTotal = this.dsList3.getColumn(e.row, "NO_SERVICE_TOTAL");
			this.dsList3.setColumn(e.row, "NO_SERVICE_HOLIDAY", serviceTotal-e.newvalue);
		break;
		
		case "NO_CADDIE_HOLIDAY"://휴무
			var caddieTotal = this.dsList3.getColumn(e.row, "NO_CADDIE_TOTAL");
			this.dsList3.setColumn(e.row, "NO_CADDIE_CNT", caddieTotal-e.newvalue);
		break;
		
		case "NO_CADDIE_CNT":	//현원
			var caddieTotal = this.dsList3.getColumn(e.row, "NO_CADDIE_TOTAL");
			this.dsList3.setColumn(e.row, "NO_CADDIE_HOLIDAY", caddieTotal-e.newvalue);
		break;
		
		default:
	}
};

this.divData_txtDS_REMARK_R_oninput = function(obj:nexacro.TextArea,e:nexacro.InputEventInfo)
{
	this.fnSetButton();
};

this.divData_edtNO_SERVICE_TOTAL_oninput = function(obj:nexacro.Edit,e:nexacro.InputEventInfo)
{
	this.fnSetButton();	
};

this.divData_edtNO_SERVICE_HOLIDAY_oninput = function(obj:nexacro.Edit,e:nexacro.InputEventInfo)
{
	this.fnSetButton();	
};

this.divData_edtNO_LABOR_CNT_oninput = function(obj:nexacro.Edit,e:nexacro.InputEventInfo)
{
	this.fnSetButton();	
};

this.divData_edtNO_CADDIE_TOTAL_oninput = function(obj:nexacro.Edit,e:nexacro.InputEventInfo)
{
	this.fnSetButton();	
};

this.divData_edtNO_CADDIE_HOLIDAY_oninput = function(obj:nexacro.Edit,e:nexacro.InputEventInfo)
{
	
};

// 리포트 출력 전체
this.fnSelectRpt = function(TY_REPORT) {

	this.dsSelectRpt = new Dataset();
	this.dsSelectRpt.addColumn("DT_REPORT", "string");	    // 일자
	this.dsSelectRpt.addColumn("ID_LOGIN", "string"); 	    // 출력자
	this.dsSelectRpt.addColumn("CD_DEPT", "string"); 	    // 부서
	this.dsSelectRpt.addColumn("TY_VIEW", "string"); 	    // 레포트구분
	
	var nrow = this.dsSelectRpt.addRow();
	trace(this.getOwnerFrame().DT_REPORT);
	var DT_REPORT = this.getOwnerFrame().DT_REPORT;
	if(this.gfnIsNull(DT_REPORT)){
		this.gfnAlert("기준일자는 반드시 입력 하셔야 합니다");
		return false;
	}
	
	var CD_DEPT = this.getOwnerFrame().CD_DEPT;
	if(this.gfnIsNull(DT_REPORT)){
		this.gfnAlert("부서는 반드시 입력 하셔야 합니다");
		return false;
	}	

	this.dsSelectRpt.setColumn(nrow, "DT_REPORT", DT_REPORT);
	this.dsSelectRpt.setColumn(nrow, "ID_LOGIN", this.AuthClient.ID_USER);
	this.dsSelectRpt.setColumn(nrow, "CD_DEPT", CD_DEPT);
	
	this.dsReportParam.setColumn(0, "DT_REPORT", DT_REPORT);
	this.dsReportParam.setColumn(0, "TY_VIEW", this.gfnNvl(TY_REPORT, "1"));
	this.dsReportParam.setColumn(0, "CD_DEPT", CD_DEPT);

	var inProc		= "_dsProc";
	var inParam 	= "params=dsReportParam";
	var inData      = "report2=dsSelectRpt report3=dsSelectRpt report4=dsSelectRpt report5=dsSelectRpt report6=dsSelectRpt";
	//var inData      = "report6=dsSelectRpt";
	var reportpath  = "/da/dac/DAC_DAILY_REPORT.ozr";

	gfnOpenReport(this, reportpath, inProc, inParam, inData);
}
]]></Script>
    <Bind>
      <BindItem id="item0" compid="divData.form.edtNO_SERVICE_TOTAL" propid="value" datasetid="dsList1" columnid="NO_SERVICE_TOTAL"/>
      <BindItem id="item1" compid="divData.form.edtNO_SERVICE_HOLIDAY" propid="value" datasetid="dsList1" columnid="NO_SERVICE_HOLIDAY"/>
      <BindItem id="item2" compid="divData.form.edtNO_SERVICE_CNT" propid="value" datasetid="dsList1" columnid="NO_SERVICE_CNT"/>
      <BindItem id="item3" compid="divData.form.edtNO_LABOR_CNT" propid="value" datasetid="dsList1" columnid="NO_LABOR_CNT"/>
      <BindItem id="item4" compid="divData.form.edtSUM_WORK" propid="value" datasetid="dsList1" columnid="NO_TOTAL"/>
      <BindItem id="item5" compid="divData.form.edtDS_STATUS" propid="value" datasetid="dsList1" columnid="DS_STATUS"/>
      <BindItem id="item6" compid="divData.form.edtNO_WORK" propid="value" datasetid="dsList1" columnid="NO_WORK"/>
      <BindItem id="item7" compid="divData.form.edtNO_ABSENCE" propid="value" datasetid="dsList1" columnid="NO_ABSENCE"/>
      <BindItem id="item8" compid="divData.form.edtNO_HOLIDAY" propid="value" datasetid="dsList1" columnid="NO_HOLIDAY"/>
      <BindItem id="item9" compid="divData.form.edtNO_SPECIAL" propid="value" datasetid="dsList1" columnid="NO_SPECIAL"/>
      <BindItem id="item10" compid="divData.form.edtNO_CLOSE" propid="value" datasetid="dsList1" columnid="NO_CLOSE"/>
      <BindItem id="item11" compid="divData.form.edtNO_OFFICIAL" propid="value" datasetid="dsList1" columnid="NO_OFFICIAL"/>
      <BindItem id="item12" compid="divData.form.edtNO_ETC" propid="value" datasetid="dsList1" columnid="NO_ETC"/>
      <BindItem id="item13" compid="divData.form.txtDS_REMARK_R" propid="value" datasetid="dsList1" columnid="DS_REMARK_R"/>
      <BindItem id="item14" compid="divData.form.edtDS_DEPT" propid="value" datasetid="dsList1" columnid="DS_DEPT"/>
      <BindItem id="item15" compid="divData.form.edtNO_CADDIE_TOTAL" propid="value" datasetid="dsList1" columnid="NO_CADDIE_TOTAL"/>
      <BindItem id="item16" compid="divData.form.edtNO_CADDIE_HOLIDAY" propid="value" datasetid="dsList1" columnid="NO_CADDIE_HOLIDAY"/>
      <BindItem id="item17" compid="divData.form.edtNO_CADDIE_CNT" propid="value" datasetid="dsList1" columnid="NO_CADDIE_CNT"/>
    </Bind>
  </Form>
</FDL>
