<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.0">
  <Form id="form" width="1400" height="990" titletext="현설참석여부" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="divSearch" taborder="1" left="0.0" top="10.0" height="46.0" right="0" cssclass="div_SEARCH_Bg" formscrolltype="none">
          <Layouts>
            <Layout>
              <Static id="staNO_BID" taborder="1" text="입찰번호" left="0.0" top="10.0" width="118.0" height="24.0" cssclass="sta_WF_SchLabelE"/>
              <Edit id="ctxtNO_BID" taborder="2" left="staNO_BID:0.0" top="10.0" width="100" height="24.0" value="" readonly="true"/>
              <Static id="staNO_PR" taborder="3" text="구매요청번호" left="ctxtNO_BID:0.0" top="10.0" width="118.0" height="24.0" textDecoration="none" cssclass="sta_WF_SchLabel"/>
              <Div id="ccfNO_PR" CodeFindName="DCX_CFBID_NOPR" CDTextWidth="80" taborder="4" left="staNO_PR:0.0" top="10.0" width="200" height="24.0" url="cmm::cmmCodeFind.xfdl"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="divData" taborder="0" left="0" top="divSearch:10" bottom="0" right="0" cssclass="div_DATA_Bg" text="">
          <Layouts>
            <Layout>
              <Div id="divData01" taborder="1" left="0" top="0" right="5" height="245" text="">
                <Layouts>
                  <Layout>
                    <Static id="staTitle" taborder="0" text="입찰정보" left="0" top="0" right="5" height="22" cssclass="sta_TITLE_Bg"/>
                    <Static id="staNO_BID" taborder="0" text="입찰번호" left="0" top="staTitle:5" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgNO_BID" taborder="1" left="staNO_BID:-1" top="staTitle:5" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staNO_PR" taborder="2" text="구매요청번호" left="staBgNO_BID:-1" top="staTitle:5" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgNO_PR" taborder="3" left="staNO_PR:-1" top="staTitle:5" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staCD_SITE" taborder="5" text="현장코드" left="staBgNO_PR:-1" top="staTitle:5" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgCD_SITE" taborder="6" left="staCD_SITE:-1" top="staTitle:5" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staCD_LICCOST" taborder="7" text="공종코드" left="staBgCD_SITE:-1" top="staTitle:5" width="115" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgCD_LICCOST" taborder="8" left="staCD_LICCOST:-1" top="staTitle:5" width="250" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staONOFF" taborder="9" text="입찰방식" left="0" top="staNO_BID:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgONOFF" taborder="10" left="staONOFF:-1" top="staNO_BID:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staDT_BIDMAGAM" taborder="11" text="입찰마감일시" left="staBgONOFF:-1" top="staNO_BID:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgDT_BIDMAGAM" taborder="12" left="staDT_BIDMAGAM:-1" top="staNO_BID:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staID_BIDDAM1" taborder="13" text="입찰담당자" left="staBgDT_BIDMAGAM:-1" top="staNO_BID:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgID_BIDDAM1" taborder="14" left="staID_BIDDAM1:-1" top="staNO_BID:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staNO_BIDDAM1TEL" taborder="15" text="입찰담당자 연락처" left="staBgID_BIDDAM1:-1" top="staNO_BID:-1" width="115" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgNO_BIDDAM1TEL" taborder="16" left="staNO_BIDDAM1TEL:-1" top="staNO_BID:-1" width="250" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staDT_FROM" taborder="17" text="공사기간" left="0" top="staONOFF:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgDT_FROM" taborder="18" left="staDT_FROM:-1" top="staONOFF:-1" width="548" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staONOFF_EXPLAIN" taborder="19" text="현장설명유형" left="staBgDT_FROM:-1" top="staONOFF:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgONOFF_EXPLAIN" taborder="20" left="staONOFF_EXPLAIN:-1" top="staONOFF:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staDT_EXPLAIN" taborder="22" text="현장설명일시" left="staBgONOFF_EXPLAIN:-1" top="staONOFF:-1" width="115" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgDT_EXPLAIN" taborder="24" left="staDT_EXPLAIN:-1" top="staONOFF:-1" width="250" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staID_SITESABUN" taborder="21" text="현장담당자" left="0" top="staDT_FROM:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgID_SITESABUN" taborder="23" left="staID_SITESABUN:-1" top="staDT_FROM:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staNO_SITETEL" taborder="25" text="현장담당자전화" left="staBgID_SITESABUN:-1" top="staDT_FROM:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgNO_SITETEL" taborder="26" left="staNO_SITETEL:-1" top="staDT_FROM:-1" width="220" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staAT_SITEEXPLAIN" taborder="27" text="현장설명주소" left="staBgNO_SITETEL:-1" top="staDT_FROM:-1" width="110" height="30" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgAT_SITEEXPLAIN" taborder="28" left="staAT_SITEEXPLAIN:-1" top="staDT_FROM:-1" width="583" height="30" cssclass="sta_WF_tablebg"/>
                    <Static id="staRM_BIGO" taborder="29" text="비고" left="0" top="staID_SITESABUN:-1" width="110" height="90" cssclass="sta_WF_tablelabel"/>
                    <Static id="staBgRM_BIGO" taborder="30" left="staRM_BIGO:-1" top="staID_SITESABUN:-1" width="1239" height="90" cssclass="sta_WF_tablebg"/>
                    <Edit id="ctxtNO_BID" taborder="31" left="staNO_BID:5" top="staTitle:10" width="90" height="20" value="" readonly="true"/>
                    <Edit id="ctxtDS_SUBCON" taborder="32" left="ctxtNO_BID:3" top="staTitle:10" height="20" value="" width="117" readonly="true"/>
                    <Edit id="ctxtNO_PR" taborder="33" left="staNO_PR:5" top="staTitle:10" width="210" height="20" value="" readonly="true"/>
                    <Edit id="ctxtCD_SITE" taborder="34" left="staCD_SITE:5" top="staTitle:10" width="90" height="20" value="" readonly="true"/>
                    <Edit id="ctxtDS_SITE" taborder="37" left="ctxtCD_SITE:3" width="117" top="staTitle:10" height="20" value="" readonly="true"/>
                    <Edit id="ctxtCD_LICCOST" taborder="35" left="staCD_LICCOST:5" top="staTitle:10" width="90" height="20" value="" readonly="true"/>
                    <Edit id="ctxtDS_LICCOST" taborder="36" left="ctxtCD_LICCOST:3" width="147" top="staTitle:10" height="20" value="" readonly="true"/>
                    <Edit id="ctxtONOFF" taborder="38" left="staONOFF:5" top="ctxtNO_BID:9" width="210" height="20" value="" readonly="true"/>
                    <Edit id="ctxtDT_BIDMAGAM" taborder="39" left="staDT_BIDMAGAM:5" top="ctxtNO_BID:9" width="210" height="20" value="" readonly="true"/>
                    <Edit id="ctxtID_BIDDAM1" taborder="40" left="staID_BIDDAM1:5" top="ctxtNO_BID:9" width="90" height="20" value="" readonly="true"/>
                    <Edit id="ctxtDS_BIDDAM1" taborder="41" left="ctxtID_BIDDAM1:3" top="ctxtNO_BID:9" height="20" value="" width="117" readonly="true"/>
                    <Edit id="ctxtNO_BIDDAM1TEL" taborder="42" left="staNO_BIDDAM1TEL:5" top="ctxtNO_BID:9" width="90" height="20" value="" readonly="true"/>
                    <Edit id="ctxtEM_BIDDAM1" taborder="43" left="ctxtNO_BIDDAM1TEL:3" top="ctxtNO_BID:9" height="20" value="" width="147" readonly="true"/>
                    <Calendar id="ctclDT_FROM" taborder="44" left="staDT_FROM:5" top="ctxtONOFF:9" width="105" height="20" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" value=""/>
                    <Static id="sta_range" taborder="45" text="~" left="ctclDT_FROM:10" top="ctxtONOFF:9" width="10" height="20"/>
                    <Calendar id="ctclDT_TO" taborder="46" left="sta_range:10" top="ctxtONOFF:9" width="105" height="20" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" value=""/>
                    <Combo id="cboONOFF_EXPLAIN" taborder="47" left="staONOFF_EXPLAIN:5" top="ctxtONOFF:9" width="210" height="20" innerdataset="dsONOFF_EXPLAIN" codecolumn="CD_CODE" datacolumn="DS_CODE"/>
                    <Calendar id="ctclDT_EXPLAIN" taborder="48" left="staDT_EXPLAIN:5" top="ctxtONOFF:9" width="105" height="20" dateformat="yyyy-MM-dd" editformat="yyyyMMdd" autoselect="true" value=""/>
                    <Combo id="ccboDT_EXPLAIN_HOUR" taborder="49" left="ctclDT_EXPLAIN:3" top="ctxtONOFF:9" width="45" height="20" innerdataset="dsHOUR" codecolumn="CD_CODE" datacolumn="DS_CODE" index="0" text="00" value="00" readonly="false"/>
                    <Static id="staDT_EXPLAIN_HOUR" taborder="50" text="시" left="ccboDT_EXPLAIN_HOUR:3" top="ctxtONOFF:9" width="20" height="20" readonly="true"/>
                    <Combo id="ccboDT_EXPLAIN_MINUTE" taborder="51" left="staDT_EXPLAIN_HOUR:3" top="ctxtONOFF:9" width="45" height="20" innerdataset="dsMINUTE" codecolumn="CD_CODE" datacolumn="DS_CODE" index="0" text="00" value="00" readonly="false"/>
                    <Static id="staDT_EXPLAIN_MINUTE" taborder="52" text="분" left="ccboDT_EXPLAIN_MINUTE:3" top="ctxtONOFF:9" width="20" height="20" readonly="true"/>
                    <Div id="ccfID_SITESABUN" CodeFindName="DZX_CFUSER" CDTextWidth="70" taborder="53" left="staID_SITESABUN:5" top="ctclDT_FROM:9" width="210" height="20" url="cmm::cmmCodeFind.xfdl"/>
                    <Edit id="ctxtNO_SITETEL" taborder="54" left="staNO_SITETEL:5" top="ctclDT_FROM:9" width="210" height="20" value="" readonly="false"/>
                    <Edit id="ctxtAT_SITEEXPLAIN" taborder="55" left="staAT_SITEEXPLAIN:5" top="ctclDT_FROM:9" width="573" height="20" value="" readonly="false"/>
                    <TextArea id="ctxtRM_BIGO" taborder="56" left="staRM_BIGO:5" top="ccfID_SITESABUN:9" width="1229" height="80" value=""/>
                  </Layout>
                </Layouts>
              </Div>
              <Div id="divData02" taborder="1" left="0" top="divData01:10" right="5" height="300" text="">
                <Layouts>
                  <Layout>
                    <Static id="staTitle" taborder="3" text="현설참석여부 확인" left="0" top="0" right="5" height="22" cssclass="sta_TITLE_Bg"/>
                    <Grid id="objGrid" taborder="0" left="0" top="staTitle:5" bottom="0" width="1338"/>
                  </Layout>
                </Layouts>
              </Div>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
      <Layout name="default0">
        <Div id="divSearch" taborder="1" left="0" top="0" height="45" right="0" cssclass="div_SEARCH_Bg" formscrolltype="none"/>
        <Div id="divData" taborder="0" left="0" top="divSearch:10" bottom="0" right="0" cssclass="div_DATA_Bg" text=""/>
      </Layout>
    </Layouts>
    <Script type="xscript5.1"><![CDATA[this.objApp = this.gfnGetApplication();
this.singFormStat = "Q";	// 싱글폼 데이터 수정시 변경됨(싱글폼데이터와 그리드데이터를 같이 저장할지 각각 따로 저장할지 구분하기 위한변수)

this.form_onload = function(obj:nexacro.Form,e:nexacro.LoadEventInfo)
{
	// -- 필수 -------------------//
	this.gfnFormOnLoad(this);	
	this.gfnFormInfo(this);		
	// ---------------------------//
	
	this.fnSetButton();
	this.fnSetExtendButton();
	this.fnSetVariable();
	this.fnSetEvent();
	this.fnSetParameter();
	
	this.fnSetCombo();

	// 타화면에서 오픈시 넘어오는 파라미터 처리
	if(!this.gfnIsNull(this.getOwnerFrame().NO_BID)) {
		this.dsSearch.setColumn(0, "NO_BID", this.getOwnerFrame().NO_BID);
		
		if(!this.gfnIsNull(this.getOwnerFrame().NO_PR))
		this.dsSearch.setColumn(0, "NO_PR", this.getOwnerFrame().NO_PR);
		
		this.FormBtns.Select.click();
	}
};

/************************************************************************
 * 버튼 설정 : 화면(Tab) 전환시 마다 호출
 * 서브버튼 사용 및 공통버튼 강제 제어시 여기서 처리
 ************************************************************************/
this.fnSetButton = function() {
	
}

/************************************************************************
 * 확장 버튼 : 화면별 버튼 설정 ID, function 연결 (화면버튼관리)
 ************************************************************************/
this.fnSetExtendButton = function() {
	
};

/************************************************************************
 * 변수 선언
 ************************************************************************/
this.fnSetVariable = function() {	
	this.ccfNO_PR = this.divSearch.form.ccfNO_PR;
	this.divData.form.divData01.form.ccfID_SITESABUN.AfterCDTextChanged = "fnAfterCDTextChanged";

	this.dxGrid = this.divData.form.divData02.form.objGrid;
};

/************************************************************************
 * 이벤트 설정
 ************************************************************************/
this.fnSetEvent = function() {
	this.ccfNO_PR.BeforeUserDataSetParam = "fnBeforeUserDataSetParam";

	this.gfnGridInit(this.dxGrid, this.dsList2, "DC", "DCB_EXPLAIN_JOINBID_SITE");	
};

/************************************************************************
 * 파라미터 설정
 ************************************************************************/
this.fnSetParameter = function() {
	this.dsSelect = new Dataset();
	this.dsSelect.addColumn("NO_BID", "string");
	this.dsSelect.addColumn("NO_PR", "string");
	
	this.dsUpdate = new Dataset();
	this.dsUpdate.addColumn("NO_BID", "string");
	this.dsUpdate.addColumn("NO_PR", "string");
	this.dsUpdate.addColumn("DT_FROM", "string");
	this.dsUpdate.addColumn("DT_TO", "string");
	this.dsUpdate.addColumn("ONOFF_EXPLAIN", "string");
	this.dsUpdate.addColumn("DT_EXPLAIN", "string");
	this.dsUpdate.addColumn("ID_SITESABUN", "string");
	this.dsUpdate.addColumn("NO_SITETEL", "string");
	this.dsUpdate.addColumn("AT_SITEEXPLAIN", "string");
	this.dsUpdate.addColumn("DS_BIGO", "string");
	
	this.dsUpdate2 = new Dataset();
	this.dsUpdate2.addColumn("NO_BID", "string");
	this.dsUpdate2.addColumn("NO_PR", "string");
	this.dsUpdate2.addColumn("CD_VENDOR", "string");
	this.dsUpdate2.addColumn("YN_JOIN", "string");
	this.dsUpdate2.addColumn("DS_CONTACTNAME", "string");
	this.dsUpdate2.addColumn("DS_CONTACTTEL", "string");
	this.dsUpdate2.addColumn("DS_CONTACTEMAIL", "string");
	this.dsUpdate2.addColumn("DS_BIGO", "string");
}

/************************************************************************
 * 컨트롤 이벤트
 ************************************************************************/
 /*
  *	조회 버튼
  */
this.fnSelect = function() {
	if (!this.fnSelectValidate()) return false;
	
	this.dsSelect.clearData();
	this.dsSelect.addRow();

	this.dsSelect.setColumn(0, "NO_BID", this.dsSearch.getColumn(0, "NO_BID"));
	this.dsSelect.setColumn(0, "NO_PR", this.dsSearch.getColumn(0, "NO_PR"));
	
	var strSvcId    = "select";
	var strSvcType  = "grid";
	var inProc		= "_dsProc";
	var inData      = "select=dsSelect select2=dsSelect";
	var outData     = "dsList=select0 dsList2=select20";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
}


/*
 *	입력 버튼
 */
this.fnAdd = function() {
}

/*
 *	삭제 버튼
 */
this.fnDel = function() {
	this.gfnConfirm("삭제하시겠습니까?", "fnDel_callback");
}

this.fnDel_callback = function(strId, val) {
	if(val == true) {
		
		this.dsDelete.clearData();
		var nrow = this.dsDelete.addRow();
		this.dsDelete.setColumn(nrow, "CD_SITE", this.dsList.getColumn(0, "CD_SITE"));
		this.dsDelete.setColumn(nrow, "NO_BID", this.dsList.getColumn(0, "NO_BID"));

		if (this.dsDelete.rowcount == 0) return;		
			
		var strSvcId    = "save";
		var strSvcType  = "save";
		var inProc		= "_dsProc";
		var inData      = "delete=dsDelete";
		var outData     = "";
		var strArg      = "";
		var callBackFnc = "fnCallback";
		
		this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
							strSvcType , 	// transaction을 요청할 구분
							inProc,			// Procedure 정보 Dataset 이름
							inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
							outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
							strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
							callBackFnc); // 통신방법 정의 [생략가능]
	}
}

/*
 *	저장 버튼
 */
this.fnSave = function() {
	// 싱글폼(Dataset) 필수입력 체크
	
	var arr_in = [];
	
	var update = false;
	if (this.dsList.rowcount > 0) {
		// 싱글폼쪽 update 유무 체크
		/*
		if(this.dsList.getRowType(0) == Dataset.ROWTYPE_UPDATE) {
			update = true;
		}
		*/
		
		if(this.singFormStat == "Q") {
			update = true;			
		}
		this.singFormStat = "Q";	// 초기화
	}
	
	//alert(update);return;
	if (update) {
		// 싱글폼 변경 내역이 있으면 필수값 체크
		if (!this.gfnDataValidate(this.dsList, this.dsRequired)) return;
		arr_in.push("update=dsUpdate");
		
		this.dsUpdate.clearData();
		var nrow = this.dsUpdate.addRow();
		this.dsUpdate.setColumn(nrow, "NO_BID", this.dsList.getColumn(0, "NO_BID"));
		this.dsUpdate.setColumn(nrow, "NO_PR", this.dsList.getColumn(0, "NO_PR"));
		this.dsUpdate.setColumn(nrow, "DT_FROM", this.dsList.getColumn(0, "DT_FROM"));
		this.dsUpdate.setColumn(nrow, "DT_TO", this.dsList.getColumn(0, "DT_TO"));
		this.dsUpdate.setColumn(nrow, "ONOFF_EXPLAIN", this.dsList.getColumn(0, "ONOFF_EXPLAIN"));
		this.dsUpdate.setColumn(nrow, "DT_EXPLAIN", this.dsList.getColumn(0, "DT_EXPLAIN")+ this.dsTempTime.getColumn(0, "EXPLAIN_HOUR") + this.dsTempTime.getColumn(0, "EXPLAIN_MINUTE"));
		this.dsUpdate.setColumn(nrow, "ID_SITESABUN", this.dsList.getColumn(0, "ID_SITESABUN"));
		this.dsUpdate.setColumn(nrow, "NO_SITETEL", this.dsList.getColumn(0, "NO_SITETEL"));
		this.dsUpdate.setColumn(nrow, "AT_SITEEXPLAIN", this.dsList.getColumn(0, "AT_SITEEXPLAIN"));
		this.dsUpdate.setColumn(nrow, "DS_BIGO", this.dsList.getColumn(0, "DS_BIGO"));
	}
	
	// 현설참석목록 
	this.dsUpdate2.clearData();
	for (var i = 0; i < this.dsList2.rowcount; i++) {
		var flag = this.gfnGetFlag(this.dsList2, i);
		if(flag == "U") {
			var nrow = this.dsUpdate2.addRow();
			this.dsUpdate2.setColumn(nrow, "NO_BID", this.dsList.getColumn(0, "NO_BID"));
			this.dsUpdate2.setColumn(nrow, "NO_PR", this.dsList.getColumn(0, "NO_PR"));
			this.dsUpdate2.setColumn(nrow, "CD_VENDOR", this.dsList2.getColumn(i, "CD_VENDOR"));
			this.dsUpdate2.setColumn(nrow, "YN_JOIN", this.dsList2.getColumn(i, "YN_JOIN"));
			this.dsUpdate2.setColumn(nrow, "DS_CONTACTNAME", this.dsList2.getColumn(i, "DS_CONTACTNAME"));
			this.dsUpdate2.setColumn(nrow, "DS_CONTACTTEL", this.dsList2.getColumn(i, "DS_CONTACTTEL"));
			this.dsUpdate2.setColumn(nrow, "DS_CONTACTEMAIL", this.dsList2.getColumn(i, "DS_CONTACTEMAIL"));
			this.dsUpdate2.setColumn(nrow, "DS_BIGO", this.dsList2.getColumn(i, "DS_BIGO"));
		}
	}
	
	if(this.dsUpdate2.rowcount > 0) {
		arr_in.push("update2=dsUpdate2");
	}
	
	if (this.dsUpdate.rowcount == 0 && this.dsUpdate2.rowcount == 0) return;		
		
	var strSvcId    = "save";
	var strSvcType  = "save";
	var inProc		= "_dsProc";
	var inData      = arr_in.join(' ');
	var outData     = "";
	var strArg      = "";
	var callBackFnc = "fnCallback";
	
	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 			// 입력갑스로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
}

/*
 *	엑셀 버튼
 */
this.fnExcel = function() {
	var nrow = this.gfnExcelExport(this.dxGrid);
}

/*
 *	출력 버튼
 */
this.fnPrint = function() {
}

/************************************************************************
 * Validate
 ************************************************************************/
/*
 *	조회 Validate
 */
this.fnSelectValidate = function() {
	var validate = true;
	if (this.gfnIsNull(this.dsSearch.getColumn(0,"NO_BID"))) {
		validate = false;
		// Alert후 실행할 처리
		this.fnVaidateCallback = function() {
			this.divSearch.form.ctxtNO_BID.setFocus();
		}
		this.gfnAlert("입찰번호를 입력하세요.", "fnVaidateCallback");
	}
// 	else if (this.gfnIsNull(this.dsSearch.getColumn(0,"NO_BID"))) {
// 		validate = false;
// 		// Alert후 실행할 처리
// 		this.fnVaidateCallback = function() {
// 			this.divSearch.form.ccfNO_BID.form.CDTextBox.setFocus();
// 		}
// 		this.gfnAlert("구매요청번호를 입력하세요.", "fnVaidateCallback");
// 	}
	return validate;
};

/************************************************************************
 * 콜백 이벤트
 ************************************************************************/
/*
 *	콜백 처리
 */
this.fnCallback = function(svcID, errorCode, errorMsg, strArg)
{
	if (svcID == "select") {
		if(!this.gfnIsNull(this.dsList.getColumn(0, "DT_EXPLAIN")))
		{			
			if(this.dsList.getColumn(0, "DT_EXPLAIN").length > 8)
			{
				this.dsTempTime.clearData();
				this.dsTempTime.addRow();
				this.dsTempTime.setColumn(0, "EXPLAIN_HOUR", this.dsList.getColumn(0, "DT_EXPLAIN").substr(8,2));
				this.dsTempTime.setColumn(0, "EXPLAIN_MINUTE", this.dsList.getColumn(0, "DT_EXPLAIN").substr(10,2));			
				this.dsList.setColumn(0, "DT_EXPLAIN", this.dsList.getColumn(0, "DT_EXPLAIN").substr(0,8));
				
				// 폼상태 초기화
				this.gfnSetFormStatus(this);	
			}
			else
			{
				this.dsTempTime.clearData();
				this.dsTempTime.addRow();
			}
		}
		else
		{
			if(this.dsList.rowcount > 0)
			{
				this.dsTempTime.clearData();
				this.dsTempTime.addRow();
			}
		}
	
		this.fnBtnCheckAll();
	}
	else if(svcID == "save") {
		if (errorCode == 0) {
			this.FormBtns.Select.click();
		} else {
			this.gfnAlert(errorMsg);
		}
	}
	else if(svcID == "execute") {
		if (errorCode == 0) {
			this.fnExecute_callback = function()
			{
				this.FormBtns.Select.click();
			}
		
			var msg = "";
			var json = this.gfnArgsToJson(strArg);
			
			if(json.gubun == "A") msg = "발주의뢰";
			else if(json.gubun == "R") msg = "발주의뢰취소";
			
			msg += "를 정상적으로 완료하였습니다.";
			
			this.gfnAlert(msg, "","","fnExecute_callback");
		} else {
			this.gfnAlert(errorMsg);
		}
	}
}

/************************************************************************
 * 코드파인드 이벤트
 ************************************************************************/ 
this.fnBeforeUserDataSetParam = function(id, dsUserParam, nrow) {
	if (id == "ccfNO_PR"){
 		if (this.gfnIsNull(this.dsSearch.getColumn(0, "NO_BID"))) {
 			this.gfnAlert("입찰번호를 먼저 입력하세요.");
 			return false;
 		}
		dsUserParam.setColumn(nrow, "NO_BID", this.dsSearch.getColumn(0, "NO_BID"));
	}
	
	return true;
}

this.fnAfterCDTextChanged = function(id, codeFindData){
	var arr = codeFindData;
	if(id == "ccfID_SITESABUN"){
		if(arr.length > 0){	
			this.dsList.setColumn(0, "NO_SITETEL", arr[0].PHONE);
		}
	}
}
/************************************************************************
 * 그리드 이벤트
 ************************************************************************/
 
/************************************************************************
 * 기타 이벤트
 ************************************************************************/
this.dsSearch_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if(e.oldvalue != e.newvalue) {
		this.gfnSetFormStatus(this);	// 폼상태 초기화
		this.dsList.clearData();	// 싱글폼데이터 초기화
		this.dsList2.clearData();
	}
};

this.dsList_onvaluechanged = function(obj:nexacro.NormalDataset,e:nexacro.DSColChangeEventInfo)
{
	if(e.oldvalue != e.newvalue) {
		this.gfnSetFormStatus(this, "U");	// 폼상태 초기화	
		
	}
};


this.fnSetCombo = function()
{
	this.dsCombo = new Dataset();
	this.dsCombo.addColumn("CD_SYSTEM", "string");
	this.dsCombo.addColumn("CD_TYPE", "string");
	
	this.dsCombo.addRow();	
	this.dsCombo.setColumn(0, "CD_SYSTEM", "DC");
 	this.dsCombo.setColumn(0, "CD_TYPE", "C15");
	
// 	this.dsCombo.addRow();	
// 	this.dsCombo.setColumn(0, "CD_SYSTEM", "DM");
// 	this.dsCombo.setColumn(0, "CD_TYPE", "H08");
// 	
// 	this.dsCombo.addRow();	
// 	this.dsCombo.setColumn(1, "CD_SYSTEM", "DC");
// 	this.dsCombo.setColumn(1, "CD_TYPE", "50");
// 	
// 	this.dsCombo.addRow();	
// 	this.dsCombo.setColumn(2, "CD_SYSTEM", "DC");
// 	this.dsCombo.setColumn(2, "CD_TYPE", "C07");


	var strSvcId    = "combo";
	var strSvcType  = "select";
	var inProc		= "_dsProc";
	var inData      = "combo=dsCombo";
	var outData     = "dsONOFF_EXPLAIN=combo0";
	var strArg      = "";
	var callBackFnc = "fnCallbackCombo";

	this.gfnTransaction( strSvcId , 	// transaction을 구분하기 위한 svc id값
						strSvcType , 	// transaction을 요청할 구분
						inProc,			// Procedure 정보 Dataset 이름
						inData , 		// 입력값으로 보낼 dataset id , a=b형태로 실제이름과 입력이름을 매칭
						outData , 		// 처리결과값으로 받을 dataset id, a=b형태로 실제이름과 입력이름을 매칭
						strArg, 		// 입력값으로 보낼 arguments, strFormData="20120607"
						callBackFnc); // 통신방법 정의 [생략가능]
}

this.fnBtnCheckAll = function()
{
	//this.gfnBtnCheck(this.btnNonAttendMail, this.dsList);
}]]></Script>
    <Objects>
      <Dataset id="dsList" onvaluechanged="dsList_onvaluechanged">
        <ColumnInfo>
          <Column id="NO_BID" type="STRING" size="256"/>
          <Column id="DS_SUBCON" type="STRING" size="256"/>
          <Column id="CD_SITE" type="STRING" size="256"/>
          <Column id="DS_SITE" type="STRING" size="256"/>
          <Column id="NO_PR" type="STRING" size="256"/>
          <Column id="CD_LICCOST" type="STRING" size="256"/>
          <Column id="DS_LICCOST" type="STRING" size="256"/>
          <Column id="DT_FROM" type="STRING" size="256"/>
          <Column id="DT_TO" type="STRING" size="256"/>
          <Column id="ONOFF_EXPLAIN" type="STRING" size="256"/>
          <Column id="DT_EXPLAIN" type="STRING" size="256"/>
          <Column id="ID_SITESABUN" type="STRING" size="256"/>
          <Column id="DS_SITESABUN" type="STRING" size="256"/>
          <Column id="NO_SITETEL" type="STRING" size="256"/>
          <Column id="AT_SITEEXPLAIN" type="STRING" size="256"/>
          <Column id="DS_BIGO" type="STRING" size="256"/>
          <Column id="ONOFF" type="STRING" size="256"/>
          <Column id="DT_BIDMAGAM" type="STRING" size="256"/>
          <Column id="ID_BIDDAM1" type="STRING" size="256"/>
          <Column id="DS_BIDDAM1" type="STRING" size="256"/>
          <Column id="NO_BIDDAM1TEL" type="STRING" size="256"/>
          <Column id="EM_BIDDAM1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="_dsProc">
        <ColumnInfo>
          <Column id="TARGET" type="STRING" size="256"/>
          <Column id="SP" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TARGET">select</Col>
            <Col id="SP">DCBPR_EXPLAIN_SITE_SELECT</Col>
          </Row>
          <Row>
            <Col id="TARGET">select2</Col>
            <Col id="SP">DCBPR_EXPLAIN_JOINBID_SITE_SELECT</Col>
          </Row>
          <Row>
            <Col id="TARGET">update</Col>
            <Col id="SP">DCBPR_EXPLAIN_SITE_UPDATE</Col>
          </Row>
          <Row>
            <Col id="TARGET">update2</Col>
            <Col id="SP">DCBPR_EXPLAIN_JOINBID_SITE_UPDATE</Col>
          </Row>
          <Row>
            <Col id="TARGET">combo</Col>
            <Col id="SP">DZXPR_COMBO_SELECT</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsSearch" onvaluechanged="dsSearch_onvaluechanged">
        <ColumnInfo>
          <Column id="NO_PR" type="STRING" size="256"/>
          <Column id="NO_BID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="dsRequired">
        <ColumnInfo>
          <Column id="CD_FIELD" type="STRING" size="256"/>
          <Column id="DS_FIELD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsList2" onvaluechanged="dsList_onvaluechanged">
        <ColumnInfo/>
      </Dataset>
      <Dataset id="dsONOFF_EXPLAIN">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="dsHOUR">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD_CODE">00</Col>
            <Col id="DS_CODE">00</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">01</Col>
            <Col id="DS_CODE">01</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">02</Col>
            <Col id="DS_CODE">02</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">03</Col>
            <Col id="DS_CODE">03</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">04</Col>
            <Col id="DS_CODE">04</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">05</Col>
            <Col id="DS_CODE">05</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">06</Col>
            <Col id="DS_CODE">06</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">07</Col>
            <Col id="DS_CODE">07</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">08</Col>
            <Col id="DS_CODE">08</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">09</Col>
            <Col id="DS_CODE">09</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">10</Col>
            <Col id="DS_CODE">10</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">11</Col>
            <Col id="DS_CODE">11</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">12</Col>
            <Col id="DS_CODE">12</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">13</Col>
            <Col id="DS_CODE">13</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">14</Col>
            <Col id="DS_CODE">14</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">15</Col>
            <Col id="DS_CODE">15</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">16</Col>
            <Col id="DS_CODE">16</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">17</Col>
            <Col id="DS_CODE">17</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">18</Col>
            <Col id="DS_CODE">18</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">19</Col>
            <Col id="DS_CODE">19</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">20</Col>
            <Col id="DS_CODE">20</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">21</Col>
            <Col id="DS_CODE">21</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">22</Col>
            <Col id="DS_CODE">22</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">23</Col>
            <Col id="DS_CODE">23</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsMINUTE">
        <ColumnInfo>
          <Column id="CD_CODE" type="STRING" size="256"/>
          <Column id="DS_CODE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD_CODE">00</Col>
            <Col id="DS_CODE">00</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">05</Col>
            <Col id="DS_CODE">05</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">10</Col>
            <Col id="DS_CODE">10</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">15</Col>
            <Col id="DS_CODE">15</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">20</Col>
            <Col id="DS_CODE">20</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">25</Col>
            <Col id="DS_CODE">25</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">30</Col>
            <Col id="DS_CODE">30</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">35</Col>
            <Col id="DS_CODE">35</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">40</Col>
            <Col id="DS_CODE">40</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">45</Col>
            <Col id="DS_CODE">45</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">50</Col>
            <Col id="DS_CODE">50</Col>
          </Row>
          <Row>
            <Col id="CD_CODE">55</Col>
            <Col id="DS_CODE">55</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="dsTempTime" onvaluechanged="dsTempTime_onvaluechanged">
        <ColumnInfo>
          <Column id="EXPLAIN_HOUR" type="STRING" size="256"/>
          <Column id="EXPLAIN_MINUTE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="divSearch.form.ctxtNO_BID" propid="value" datasetid="dsSearch" columnid="NO_BID"/>
      <BindItem id="item1" compid="divSearch.form.ccfNO_PR.form.CDTextBox" propid="value" datasetid="dsSearch" columnid="NO_PR"/>
      <BindItem id="item2" compid="divData.form.divData01.form.ctxtNO_BID" propid="value" datasetid="dsList" columnid="NO_BID"/>
      <BindItem id="item3" compid="divData.form.divData01.form.ctxtDS_SUBCON" propid="value" datasetid="dsList" columnid="DS_SUBCON"/>
      <BindItem id="item4" compid="divData.form.divData01.form.ctxtCD_SITE" propid="value" datasetid="dsList" columnid="CD_SITE"/>
      <BindItem id="item5" compid="divData.form.divData01.form.ctxtDS_SITE" propid="value" datasetid="dsList" columnid="DS_SITE"/>
      <BindItem id="item6" compid="divData.form.divData01.form.ctxtNO_PR" propid="value" datasetid="dsList" columnid="NO_PR"/>
      <BindItem id="item7" compid="divData.form.divData01.form.ctxtCD_LICCOST" propid="value" datasetid="dsList" columnid="CD_LICCOST"/>
      <BindItem id="item8" compid="divData.form.divData01.form.ctxtDS_LICCOST" propid="value" datasetid="dsList" columnid="DS_LICCOST"/>
      <BindItem id="item9" compid="divData.form.divData01.form.ctxtONOFF" propid="value" datasetid="dsList" columnid="ONOFF"/>
      <BindItem id="item10" compid="divData.form.divData01.form.ctxtDT_BIDMAGAM" propid="value" datasetid="dsList" columnid="DT_BIDMAGAM"/>
      <BindItem id="item11" compid="divData.form.divData01.form.ctxtID_BIDDAM1" propid="value" datasetid="dsList" columnid="ID_BIDDAM1"/>
      <BindItem id="item12" compid="divData.form.divData01.form.ctxtDS_BIDDAM1" propid="value" datasetid="dsList" columnid="DS_BIDDAM1"/>
      <BindItem id="item13" compid="divData.form.divData01.form.ctxtNO_BIDDAM1TEL" propid="value" datasetid="dsList" columnid="NO_BIDDAM1TEL"/>
      <BindItem id="item14" compid="divData.form.divData01.form.ctxtEM_BIDDAM1" propid="value" datasetid="dsList" columnid="EM_BIDDAM1"/>
      <BindItem id="item15" compid="divData.form.divData01.form.ctclDT_FROM" propid="value" datasetid="dsList" columnid="DT_FROM"/>
      <BindItem id="item16" compid="divData.form.divData01.form.ctclDT_TO" propid="value" datasetid="dsList" columnid="DT_TO"/>
      <BindItem id="item17" compid="divData.form.divData01.form.cboONOFF_EXPLAIN" propid="value" datasetid="dsList" columnid="ONOFF_EXPLAIN"/>
      <BindItem id="item18" compid="divData.form.divData01.form.ctclDT_EXPLAIN" propid="value" datasetid="dsList" columnid="DT_EXPLAIN"/>
      <BindItem id="item19" compid="divData.form.divData01.form.ccfID_SITESABUN.form.CDTextBox" propid="value" datasetid="dsList" columnid="ID_SITESABUN"/>
      <BindItem id="item20" compid="divData.form.divData01.form.ccfID_SITESABUN.form.DSTextBox" propid="value" datasetid="dsList" columnid="DS_SITESABUN"/>
      <BindItem id="item21" compid="divData.form.divData01.form.ctxtNO_SITETEL" propid="value" datasetid="dsList" columnid="NO_SITETEL"/>
      <BindItem id="item22" compid="divData.form.divData01.form.ctxtAT_SITEEXPLAIN" propid="value" datasetid="dsList" columnid="AT_SITEEXPLAIN"/>
      <BindItem id="item23" compid="divData.form.divData01.form.ctxtRM_BIGO" propid="value" datasetid="dsList" columnid="DS_BIGO"/>
      <BindItem id="item24" compid="divData.form.divData01.form.ccboDT_EXPLAIN_HOUR" propid="value" datasetid="dsTempTime" columnid="EXPLAIN_HOUR"/>
      <BindItem id="item25" compid="divData.form.divData01.form.ccboDT_EXPLAIN_MINUTE" propid="value" datasetid="dsTempTime" columnid="EXPLAIN_MINUTE"/>
    </Bind>
  </Form>
</FDL>
